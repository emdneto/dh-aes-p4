# 1 "dh_aes.p4"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "dh_aes.p4"
/*
    AES-128 encryption in P4
    Copyright (C) 2019 Xiaoqi Chen, Princeton University
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.
    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

// Standard headers
# 1 "/usr/local/share/p4c/p4include/core.p4" 1
/*
Copyright 2013-present Barefoot Networks, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/* This is the P4-16 core library, which declares some built-in P4 constructs using P4 */




/// Standard error codes.  New error codes can be declared by users.
error {
    NoError, /// No error.
    PacketTooShort, /// Not enough bits in packet for 'extract'.
    NoMatch, /// 'select' expression has no matches.
    StackOutOfBounds, /// Reference to invalid element of a header stack.
    HeaderTooShort, /// Extracting too many bits into a varbit field.
    ParserTimeout, /// Parser execution time limit exceeded.
    ParserInvalidArgument /// Parser operation was called with a value
                           /// not supported by the implementation.
}

extern packet_in {
    /// Read a header from the packet into a fixed-sized header @hdr and advance the cursor.
    /// May trigger error PacketTooShort or StackOutOfBounds.
    /// @T must be a fixed-size header type
    void extract<T>(out T hdr);
    /// Read bits from the packet into a variable-sized header @variableSizeHeader
    /// and advance the cursor.
    /// @T must be a header containing exactly 1 varbit field.
    /// May trigger errors PacketTooShort, StackOutOfBounds, or HeaderTooShort.
    void extract<T>(out T variableSizeHeader,
                    in bit<32> variableFieldSizeInBits);
    /// Read bits from the packet without advancing the cursor.
    /// @returns: the bits read from the packet.
    /// T may be an arbitrary fixed-size type.
    T lookahead<T>();
    /// Advance the packet cursor by the specified number of bits.
    void advance(in bit<32> sizeInBits);
    /// @return packet length in bytes.  This method may be unavailable on
    /// some target architectures.
    bit<32> length();
}

extern packet_out {
    /// Write @hdr into the output packet, advancing cursor.
    /// @T can be a header type, a header stack, a header_union, or a struct
    /// containing fields with such types.
    void emit<T>(in T hdr);
}

// TODO: remove from this file, convert to built-in
/// Check a predicate @check in the parser; if the predicate is true do nothing,
/// otherwise set the parser error to @toSignal, and transition to the `reject` state.
extern void verify(in bool check, in error toSignal);

/// Built-in action that does nothing.
@noWarn("unused")
action NoAction() {}

/// Standard match kinds for table key fields.
/// Some architectures may not support all these match kinds.
/// Architectures can declare additional match kinds.
match_kind {
    /// Match bits exactly.
    exact,
    /// Ternary match, using a mask.
    ternary,
    /// Longest-prefix match.
    lpm
}
# 18 "dh_aes.p4" 2
# 1 "/usr/local/share/p4c/p4include/v1model.p4" 1
/*
Copyright 2013-present Barefoot Networks, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/* P4-16 declaration of the P4 v1.0 switch model */

/* Note 1: More details about the definition of v1model architecture
 * can be found at the location below.
 *
 * https://github.com/p4lang/behavioral-model/blob/main/docs/simple_switch.md
 *
 * Note 2: There were several discussions among P4 working group
 * members in early 2019 regarding exactly how resubmit, recirculate,
 * and clone3 operations can be called anywhere in their respective
 * controls, but the values of the fields to be preserved is the value
 * they have when that control is finished executing.  That is how
 * these operations are defined in P4_14.  See
 * https://github.com/p4lang/behavioral-model/blob/main/docs/simple_switch.md#restrictions-on-recirculate-resubmit-and-clone-operations
 * for more details on the current state of affairs.
 *
 * Note 3: There are at least some P4_14 implementations where
 * invoking a generate_digest operation on a field_list will create a
 * message to the control plane that contains the values of those
 * fields when the ingress control is finished executing, which can be
 * different than the values those fields have at the time the
 * generate_digest operation is invoked in the program, if those field
 * values are changed later in the execution of the P4_14 ingress
 * control.
 *
 * The P4_16 plus v1model implementation should always create digest
 * messages that contain the values of the specified fields at the
 * time that the digest extern function is called.  Thus if a P4_14
 * program expecting the behavior described above is compiled using
 * p4c, it may behave differently.
 */




# 1 "/usr/local/share/p4c/p4include/core.p4" 1
/*
Copyright 2013-present Barefoot Networks, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/* This is the P4-16 core library, which declares some built-in P4 constructs using P4 */
# 53 "/usr/local/share/p4c/p4include/v1model.p4" 2





match_kind {
    range,
    // Either an exact match, or a wildcard (matching any value).
    optional,
    // Used for implementing dynamic_action_selection
    selector
}

const bit<32> __v1model_version = 20180101;





@metadata @name("standard_metadata")
struct standard_metadata_t {





    bit<9> ingress_port;
    bit<9> egress_spec;
    bit<9> egress_port;

    bit<32> instance_type;
    bit<32> packet_length;
    //
    // @alias is used to generate the field_alias section of the BMV2 JSON.
    // Field alias creates a mapping from the metadata name in P4 program to
    // the behavioral model's internal metadata name. Here we use it to
    // expose all metadata supported by simple switch to the user through
    // standard_metadata_t.
    //
    // flattening fields that exist in bmv2-ss
    // queueing metadata
    @alias("queueing_metadata.enq_timestamp")
    bit<32> enq_timestamp;
    @alias("queueing_metadata.enq_qdepth")
    bit<19> enq_qdepth;
    @alias("queueing_metadata.deq_timedelta")
    bit<32> deq_timedelta;
    /// queue depth at the packet dequeue time.
    @alias("queueing_metadata.deq_qdepth")
    bit<19> deq_qdepth;

    // intrinsic metadata
    @alias("intrinsic_metadata.ingress_global_timestamp")
    bit<48> ingress_global_timestamp;
    @alias("intrinsic_metadata.egress_global_timestamp")
    bit<48> egress_global_timestamp;
    /// multicast group id (key for the mcast replication table)
    @alias("intrinsic_metadata.mcast_grp")
    bit<16> mcast_grp;
    /// Replication ID for multicast
    @alias("intrinsic_metadata.egress_rid")
    bit<16> egress_rid;
    /// Indicates that a verify_checksum() method has failed.
    /// 1 if a checksum error was found, otherwise 0.
    bit<1> checksum_error;
    /// Error produced by parsing
    error parser_error;
    /// set packet priority
    @alias("intrinsic_metadata.priority")
    bit<3> priority;
}

enum CounterType {
    packets,
    bytes,
    packets_and_bytes
}

enum MeterType {
    packets,
    bytes
}

extern counter



{
    /***
     * A counter object is created by calling its constructor.  This
     * creates an array of counter states, with the number of counter
     * states specified by the size parameter.  The array indices are
     * in the range [0, size-1].
     *
     * You must provide a choice of whether to maintain only a packet
     * count (CounterType.packets), only a byte count
     * (CounterType.bytes), or both (CounterType.packets_and_bytes).
     *
     * Counters can be updated from your P4 program, but can only be
     * read from the control plane.  If you need something that can be
     * both read and written from the P4 program, consider using a
     * register.
     */
    counter(bit<32> size, CounterType type);
    // FIXME -- size arg should be `int` but that breaks typechecking

    /***
     * count() causes the counter state with the specified index to be
     * read, modified, and written back, atomically relative to the
     * processing of other packets, updating the packet count, byte
     * count, or both, depending upon the CounterType of the counter
     * instance used when it was constructed.
     *
     * @param index The index of the counter state in the array to be
     *              updated, normally a value in the range [0,
     *              size-1].  If index >= size, no counter state will be
     *              updated.
     */



    void count(in bit<32> index);

}

extern direct_counter {
    /***
     * A direct_counter object is created by calling its constructor.
     * You must provide a choice of whether to maintain only a packet
     * count (CounterType.packets), only a byte count
     * (CounterType.bytes), or both (CounterType.packets_and_bytes).
     * After constructing the object, you can associate it with at
     * most one table, by adding the following table property to the
     * definition of that table:
     *
     *     counters = <object_name>;
     *
     * Counters can be updated from your P4 program, but can only be
     * read from the control plane.  If you need something that can be
     * both read and written from the P4 program, consider using a
     * register.
     */
    direct_counter(CounterType type);
    /***
     * The count() method is actually unnecessary in the v1model
     * architecture.  This is because after a direct_counter object
     * has been associated with a table as described in the
     * documentation for the direct_counter constructor, every time
     * the table is applied and a table entry is matched, the counter
     * state associated with the matching entry is read, modified, and
     * written back, atomically relative to the processing of other
     * packets, regardless of whether the count() method is called in
     * the body of that action.
     */
    void count();
}





extern meter



{
    /***
     * A meter object is created by calling its constructor.  This
     * creates an array of meter states, with the number of meter
     * states specified by the size parameter.  The array indices are
     * in the range [0, size-1].  For example, if in your system you
     * have 128 different "flows" numbered from 0 up to 127, and you
     * want to meter each of those flows independently of each other,
     * you could do so by creating a meter object with size=128.
     *
     * You must provide a choice of whether to meter based on the
     * number of packets, regardless of their size
     * (MeterType.packets), or based upon the number of bytes the
     * packets contain (MeterType.bytes).
     */
    meter(bit<32> size, MeterType type);
    // FIXME -- size arg should be `int` but that breaks typechecking

    /***
     * execute_meter() causes the meter state with the specified index
     * to be read, modified, and written back, atomically relative to
     * the processing of other packets, and an integer encoding of one
     * of the colors green, yellow, or red to be written to the result
     * out parameter.
     *
     * @param index The index of the meter state in the array to be
     *              updated, normally a value in the range [0,
     *              size-1].  If index >= size, no meter state will be
     *              updated.
     * @param result Type T must be bit<W> with W >= 2.  When index is
     *              in range, the value of result will be assigned 0
     *              for color GREEN, 1 for color YELLOW, and 2 for
     *              color RED (see RFC 2697 and RFC 2698 for the
     *              meaning of these colors).  When index is out of
     *              range, the final value of result is not specified,
     *              and should be ignored by the caller.
     */



    void execute_meter<T>(in bit<32> index, out T result);

}

extern direct_meter<T> {
    /***
     * A direct_meter object is created by calling its constructor.
     * You must provide a choice of whether to meter based on the
     * number of packets, regardless of their size
     * (MeterType.packets), or based upon the number of bytes the
     * packets contain (MeterType.bytes).  After constructing the
     * object, you can associate it with at most one table, by adding
     * the following table property to the definition of that table:
     *
     *     meters = <object_name>;
     */
    direct_meter(MeterType type);
    /***
     * After a direct_meter object has been associated with a table as
     * described in the documentation for the direct_meter
     * constructor, every time the table is applied and a table entry
     * is matched, the meter state associated with the matching entry
     * is read, modified, and written back, atomically relative to the
     * processing of other packets, regardless of whether the read()
     * method is called in the body of that action.
     *
     * read() may only be called within an action executed as a result
     * of matching a table entry, of a table that has a direct_meter
     * associated with it.  Calling read() causes an integer encoding
     * of one of the colors green, yellow, or red to be written to the
     * result out parameter.
     *
     * @param result Type T must be bit<W> with W >= 2.  The value of
     *              result will be assigned 0 for color GREEN, 1 for
     *              color YELLOW, and 2 for color RED (see RFC 2697
     *              and RFC 2698 for the meaning of these colors).
     */
    void read(out T result);
}




extern register<T>

{
    /***
     * A register object is created by calling its constructor.  This
     * creates an array of 'size' identical elements, each with type
     * T.  The array indices are in the range [0, size-1].  For
     * example, this constructor call:
     *
     *     register<bit<32>>(512) my_reg;
     *
     * allocates storage for 512 values, each with type bit<32>.
     */
    register(bit<32> size); // FIXME -- arg should be `int` but that breaks typechecking
    /***
     * read() reads the state of the register array stored at the
     * specified index, and returns it as the value written to the
     * result parameter.
     *
     * @param index The index of the register array element to be
     *              read, normally a value in the range [0, size-1].
     * @param result Only types T that are bit<W> are currently
     *              supported.  When index is in range, the value of
     *              result becomes the value read from the register
     *              array element.  When index >= size, the final
     *              value of result is not specified, and should be
     *              ignored by the caller.
     */
    @noSideEffects



    void read(out T result, in bit<32> index);

    /***
     * write() writes the state of the register array at the specified
     * index, with the value provided by the value parameter.
     *
     * If you wish to perform a read() followed later by a write() to
     * the same register array element, and you wish the
     * read-modify-write sequence to be atomic relative to other
     * processed packets, then there may be parallel implementations
     * of the v1model architecture for which you must execute them in
     * a P4_16 block annotated with an @atomic annotation.  See the
     * P4_16 language specification description of the @atomic
     * annotation for more details.
     *
     * @param index The index of the register array element to be
     *              written, normally a value in the range [0,
     *              size-1].  If index >= size, no register state will
     *              be updated.
     * @param value Only types T that are bit<W> are currently
     *              supported.  When index is in range, this
     *              parameter's value is written into the register
     *              array element specified by index.
     */



    void write(in bit<32> index, in T value);

}

// used as table implementation attribute
extern action_profile {
    action_profile(bit<32> size);
}

/***
 * Generate a random number in the range lo..hi, inclusive, and write
 * it to the result parameter.  The value written to result is not
 * specified if lo > hi.
 *
 * @param T          Must be a type bit<W>
 */
extern void random<T>(out T result, in T lo, in T hi);

/***
 * Calling digest causes a message containing the values specified in
 * the data parameter to be sent to the control plane software.  It is
 * similar to sending a clone of the packet to the control plane
 * software, except that it can be more efficient because the messages
 * are typically smaller than packets, and many such small digest
 * messages are typically coalesced together into a larger "batch"
 * which the control plane software processes all at once.
 *
 * The value of the fields that are sent in the message to the control
 * plane is the value they have at the time the digest call occurs,
 * even if those field values are changed by later ingress control
 * code.  See Note 3.
 *
 * Calling digest is only supported in the ingress control.  There is
 * no way to undo its effects once it has been called.
 *
 * If the type T is a named struct, the name is used to generate the
 * control plane API.
 *
 * The BMv2 implementation of the v1model architecture ignores the
 * value of the receiver parameter.
 */
extern void digest<T>(in bit<32> receiver, in T data);

enum HashAlgorithm {
    crc32,
    crc32_custom,
    crc16,
    crc16_custom,
    random,
    identity,
    csum16,
    xor16
}

@deprecated("Please use mark_to_drop(standard_metadata) instead.")
extern void mark_to_drop();

/***
 * mark_to_drop(standard_metadata) is a primitive action that modifies
 * standard_metadata.egress_spec to an implementation-specific special
 * value that in some cases causes the packet to be dropped at the end
 * of ingress or egress processing.  It also assigns 0 to
 * standard_metadata.mcast_grp.  Either of those metadata fields may
 * be changed by executing later P4 code, after calling
 * mark_to_drop(), and this can change the resulting behavior of the
 * packet to do something other than drop.
 *
 * See
 * https://github.com/p4lang/behavioral-model/blob/main/docs/simple_switch.md
 * -- in particular the section "Pseudocode for what happens at the
 * end of ingress and egress processing" -- for the relative priority
 * of the different possible things that can happen to a packet when
 * ingress and egress processing are complete.
 */
@pure
extern void mark_to_drop(inout standard_metadata_t standard_metadata);

/***
 * Calculate a hash function of the value specified by the data
 * parameter.  The value written to the out parameter named result
 * will always be in the range [base, base+max-1] inclusive, if max >=
 * 1.  If max=0, the value written to result will always be base.
 *
 * Note that the types of all of the parameters may be the same as, or
 * different from, each other, and thus their bit widths are allowed
 * to be different.
 *
 * @param O          Must be a type bit<W>
 * @param D          Must be a tuple type where all the fields are bit-fields (type bit<W> or int<W>) or varbits.
 * @param T          Must be a type bit<W>
 * @param M          Must be a type bit<W>
 */
@pure
extern void hash<O, T, D, M>(out O result, in HashAlgorithm algo, in T base, in D data, in M max);

extern action_selector {
    action_selector(HashAlgorithm algorithm, bit<32> size, bit<32> outputWidth);
}

enum CloneType {
    I2E,
    E2E
}

@deprecated("Please use verify_checksum/update_checksum instead.")
extern Checksum16 {
    Checksum16();
    bit<16> get<D>(in D data);
}

/***
 * Verifies the checksum of the supplied data.  If this method detects
 * that a checksum of the data is not correct, then the value of the
 * standard_metadata checksum_error field will be equal to 1 when the
 * packet begins ingress processing.
 *
 * Calling verify_checksum is only supported in the VerifyChecksum
 * control.
 *
 * @param T          Must be a tuple type where all the tuple elements
 *                   are of type bit<W>, int<W>, or varbit<W>.  The
 *                   total length of the fields must be a multiple of
 *                   the output size.
 * @param O          Checksum type; must be bit<X> type.
 * @param condition  If 'false' the verification always succeeds.
 * @param data       Data whose checksum is verified.
 * @param checksum   Expected checksum of the data; note that it must
 *                   be a left-value.
 * @param algo       Algorithm to use for checksum (not all algorithms
 *                   may be supported).  Must be a compile-time
 *                   constant.
 */
extern void verify_checksum<T, O>(in bool condition, in T data, in O checksum, HashAlgorithm algo);

/***
 * Computes the checksum of the supplied data and writes it to the
 * checksum parameter.
 *
 * Calling update_checksum is only supported in the ComputeChecksum
 * control.
 *
 * @param T          Must be a tuple type where all the tuple elements
 *                   are of type bit<W>, int<W>, or varbit<W>.  The
 *                   total length of the fields must be a multiple of
 *                   the output size.
 * @param O          Output type; must be bit<X> type.
 * @param condition  If 'false' the checksum parameter is not changed
 * @param data       Data whose checksum is computed.
 * @param checksum   Checksum of the data.
 * @param algo       Algorithm to use for checksum (not all algorithms
 *                   may be supported).  Must be a compile-time
 *                   constant.
 */
@pure
extern void update_checksum<T, O>(in bool condition, in T data, inout O checksum, HashAlgorithm algo);

/***
 * verify_checksum_with_payload is identical in all ways to
 * verify_checksum, except that it includes the payload of the packet
 * in the checksum calculation.  The payload is defined as "all bytes
 * of the packet which were not parsed by the parser".
 *
 * Calling verify_checksum_with_payload is only supported in the
 * VerifyChecksum control.
 */
extern void verify_checksum_with_payload<T, O>(in bool condition, in T data, in O checksum, HashAlgorithm algo);

/**
 * update_checksum_with_payload is identical in all ways to
 * update_checksum, except that it includes the payload of the packet
 * in the checksum calculation.  The payload is defined as "all bytes
 * of the packet which were not parsed by the parser".
 *
 * Calling update_checksum_with_payload is only supported in the
 * ComputeChecksum control.
 */
@noSideEffects
extern void update_checksum_with_payload<T, O>(in bool condition, in T data, inout O checksum, HashAlgorithm algo);

/***
 * Calling resubmit during execution of the ingress control will,
 * under certain documented conditions, cause the packet to be
 * resubmitted, i.e. it will begin processing again with the parser,
 * with the contents of the packet exactly as they were when it last
 * began parsing.  The only difference is in the value of the
 * standard_metadata instance_type field, and any user-defined
 * metadata fields that the resubmit operation causes to be
 * preserved.
 *
 * The value of the user-defined metadata fields that are preserved in
 * resubmitted packets is the value they have at the end of ingress
 * processing, not their values at the time the resubmit call is made.
 * See Note 2 for issues with this.
 *
 * Calling resubmit is only supported in the ingress control.  There
 * is no way to undo its effects once it has been called.  If resubmit
 * is called multiple times during a single execution of the ingress
 * control, only one packet is resubmitted, and only the data from the
 * last such call is preserved.  See the v1model architecture
 * documentation (Note 1) for more details.
 */
extern void resubmit<T>(in T data);

/***
 * Calling recirculate during execution of the egress control will,
 * under certain documented conditions, cause the packet to be
 * recirculated, i.e. it will begin processing again with the parser,
 * with the contents of the packet as they are created by the
 * deparser.  Recirculated packets can be distinguished from new
 * packets in ingress processing by the value of the standard_metadata
 * instance_type field.  The caller may request that some user-defined
 * metadata fields be preserved with the recirculated packet.
 *
 * The value of the user-defined metadata fields that are preserved in
 * recirculated packets is the value they have at the end of egress
 * processing, not their values at the time the recirculate call is
 * made.  See Note 2 for issues with this.
 *
 * Calling recirculate is only supported in the egress control.  There
 * is no way to undo its effects once it has been called.  If
 * recirculate is called multiple times during a single execution of
 * the egress control, only one packet is recirculated, and only the
 * data from the last such call is preserved.  See the v1model
 * architecture documentation (Note 1) for more details.
 */
extern void recirculate<T>(in T data);

/***
 * clone is in most ways identical to the clone3 operation, with the
 * only difference being that it never preserves any user-defined
 * metadata fields with the cloned packet.  It is equivalent to
 * calling clone3 with the same type and session parameter values,
 * with empty data.
 */
extern void clone(in CloneType type, in bit<32> session);

/***
 * Calling clone3 during execution of the ingress or egress control
 * will cause the packet to be cloned, sometimes also called
 * mirroring, i.e. zero or more copies of the packet are made, and
 * each will later begin egress processing as an independent packet
 * from the original packet.  The original packet continues with its
 * normal next steps independent of the clone(s).
 *
 * The session parameter is an integer identifying a clone session id
 * (sometimes called a mirror session id).  The control plane software
 * must configure each session you wish to use, or else no clones will
 * be made using that session.  Typically this will involve the
 * control plane software specifying one output port to which the
 * cloned packet should be sent, or a list of (port, egress_rid) pairs
 * to which a separate clone should be created for each, similar to
 * multicast packets.
 *
 * Cloned packets can be distinguished from others by the value of the
 * standard_metadata instance_type field.
 *
 * The caller may request that some user-defined metadata field values
 * from the original packet should be preserved with the cloned
 * packet(s).  The value of the user-defined metadata fields that are
 * preserved with cloned packets is the value they have at the end of
 * ingress or egress processing, not their values at the time the
 * clone3 call is made.  See Note 2 for issues with this.
 *
 * If clone3 is called during ingress processing, the first parameter
 * must be CloneType.I2E.  If clone3 is called during egress
 * processing, the first parameter must be CloneType.E2E.
 *
 * There is no way to undo its effects once it has been called.  If
 * there are multiple calls to clone3 and/or clone during a single
 * execution of the same ingress (or egress) control, only the last
 * clone session and data are used.  See the v1model architecture
 * documentation (Note 1) for more details.
 */
extern void clone3<T>(in CloneType type, in bit<32> session, in T data);

extern void truncate(in bit<32> length);

/***
 * Calling assert when the argument is true has no effect, except any
 * effect that might occur due to evaluation of the argument (but see
 * below).  If the argument is false, the precise behavior is
 * target-specific, but the intent is to record or log which assert
 * statement failed, and optionally other information about the
 * failure.
 *
 * For example, on the simple_switch target, executing an assert
 * statement with a false argument causes a log message with the file
 * name and line number of the assert statement to be printed, and
 * then the simple_switch process exits.
 *
 * If you provide the --ndebug command line option to p4c when
 * compiling, the compiled program behaves as if all assert statements
 * were not present in the source code.
 *
 * We strongly recommend that you avoid using expressions as an
 * argument to an assert call that can have side effects, e.g. an
 * extern method or function call that has side effects.  p4c will
 * allow you to do this with no warning given.  We recommend this
 * because, if you follow this advice, your program will behave the
 * same way when assert statements are removed.
 */
extern void assert(in bool check);

/***
 * For the purposes of compiling and executing P4 programs on a target
 * device, assert and assume are identical, including the use of the
 * --ndebug p4c option to elide them.  See documentation for assert.
 *
 * The reason that assume exists as a separate function from assert is
 * because they are expected to be used differently by formal
 * verification tools.  For some formal tools, the goal is to try to
 * find example packets and sets of installed table entries that cause
 * an assert statement condition to be false.
 *
 * Suppose you run such a tool on your program, and the example packet
 * given is an MPLS packet, i.e. hdr.ethernet.etherType == 0x8847.
 * You look at the example, and indeed it does cause an assert
 * condition to be false.  However, your plan is to deploy your P4
 * program in a network in places where no MPLS packets can occur.
 * You could add extra conditions to your P4 program to handle the
 * processing of such a packet cleanly, without assertions failing,
 * but you would prefer to tell the tool "such example packets are not
 * applicable in my scenario -- never show them to me".  By adding a
 * statement:
 *
 *     assume(hdr.ethernet.etherType != 0x8847);
 *
 * at an appropriate place in your program, the formal tool should
 * never show you such examples -- only ones that make all such assume
 * conditions true.
 *
 * The reason that assume statements behave the same as assert
 * statements when compiled to a target device is that if the
 * condition ever evaluates to false when operating in a network, it
 * is likely that your assumption was wrong, and should be reexamined.
 */
extern void assume(in bool check);

/*
 * Log user defined messages
 * Example: log_msg("User defined message");
 * or log_msg("Value1 = {}, Value2 = {}",{value1, value2});
 */
extern void log_msg(string msg);
extern void log_msg<T>(string msg, in T data);

// The name 'standard_metadata' is reserved

/*
 * Architecture.
 *
 * M must be a struct.
 *
 * H must be a struct where every one if its members is of type
 * header, header stack, or header_union.
 */

parser Parser<H, M>(packet_in b,
                    out H parsedHdr,
                    inout M meta,
                    inout standard_metadata_t standard_metadata);

/*
 * The only legal statements in the body of the VerifyChecksum control
 * are: block statements, calls to the verify_checksum and
 * verify_checksum_with_payload methods, and return statements.
 */
control VerifyChecksum<H, M>(inout H hdr,
                             inout M meta);
@pipeline
control Ingress<H, M>(inout H hdr,
                      inout M meta,
                      inout standard_metadata_t standard_metadata);
@pipeline
control Egress<H, M>(inout H hdr,
                     inout M meta,
                     inout standard_metadata_t standard_metadata);

/*
 * The only legal statements in the body of the ComputeChecksum
 * control are: block statements, calls to the update_checksum and
 * update_checksum_with_payload methods, and return statements.
 */
control ComputeChecksum<H, M>(inout H hdr,
                              inout M meta);

/*
 * The only legal statements in the body of the Deparser control are:
 * calls to the packet_out.emit() method.
 */
@deparser
control Deparser<H>(packet_out b, in H hdr);

package V1Switch<H, M>(Parser<H, M> p,
                       VerifyChecksum<H, M> vr,
                       Ingress<H, M> ig,
                       Egress<H, M> eg,
                       ComputeChecksum<H, M> ck,
                       Deparser<H> dep
                       );
# 19 "dh_aes.p4" 2

// Max entries into the register


// useful for DH
typedef bit<256> keys_t;
typedef bit<48> macAddr_t;

register<keys_t>(8) register_pub_keys;
register<keys_t>(8) register_priv_keys;
register<keys_t>(8) register_secret_keys;

header ethernet_t {
    macAddr_t dstAddr;
    macAddr_t srcAddr;
    bit<16> etherType;
}

header ipv4_t {
    bit<4> version;
    bit<4> ihl;
    bit<8> diffserv;
    bit<16> totalLen;
    bit<16> identification;
    bit<3> flags;
    bit<13> fragOffset;
    bit<8> ttl;
    bit<8> protocol;
    bit<16> hdrChecksum;
    macAddr_t srcAddr;
    macAddr_t dstAddr;
}

header tcp_t{
    bit<16> srcPort;
    bit<16> dstPort;
    bit<32> seqNo;
    bit<32> ackNo;
    bit<4> dataOffset;
    bit<4> res;
    bit<1> cwr;
    bit<1> ece;
    bit<1> urg;
    bit<1> ack;
    bit<1> psh;
    bit<1> rst;
    bit<1> syn;
    bit<1> fin;
    bit<16> window;
    bit<16> checksum;
    bit<16> urgentPtr;
}







// The data added to the probe by each switch at each hop.
header dh_probe_t {
    bit<256> public_key;
    // Trere is no need for 8 bytes but header requires multiple of 8 bits.
    bit<8> flag; // 0x00 = msg1 / 0x01 = msg2 / 0x02 = msg3 / 0x03 = msg4
}

// We perform one block of AES.
// To perform multiple block using modes like CBC/CTR, etc., simply XOR a counter/IV with value before starting AES.
header aes_inout_t {
    bit<128> value;
}

struct my_headers_t {
    ethernet_t ethernet;
    aes_inout_t aes_inout;
    dh_probe_t[8] dh_probe;
}

header aes_meta_t {
    // internal state, 4 rows
    bit<32> r0;
    bit<32> r1;
    bit<32> r2;
    bit<32> r3;
    // temporary accumulator, for XOR-ing the result of many LUTs
    bit<32> t0;
    bit<32> t1;
    bit<32> t2;
    bit<32> t3;

    keys_t reg_pub_key;
    keys_t reg_priv_key;
    keys_t reg_secret_key;

    // expanded keys
    bit<128> expandkey_r0;
    bit<128> expandkey_r1;
    bit<128> expandkey_r2;
    bit<128> expandkey_r3;
    bit<128> expandkey_r4;
    bit<128> expandkey_r5;
    bit<128> expandkey_r6;
    bit<128> expandkey_r7;
    bit<128> expandkey_r8;
    bit<128> expandkey_r9;
    bit<128> expandkey_r10;
    bit<128> expandkey_r11;
    bit<128> expandkey_r12;
    bit<128> expandkey_r13;
    bit<128> expandkey_r14;

    // decrypt expanded keys
    bit<128> inv_expandkey_r0;
    bit<128> inv_expandkey_r1;
    bit<128> inv_expandkey_r2;
    bit<128> inv_expandkey_r3;
    bit<128> inv_expandkey_r4;
    bit<128> inv_expandkey_r5;
    bit<128> inv_expandkey_r6;
    bit<128> inv_expandkey_r7;
    bit<128> inv_expandkey_r8;
    bit<128> inv_expandkey_r9;
    bit<128> inv_expandkey_r10;
    bit<128> inv_expandkey_r11;
    bit<128> inv_expandkey_r12;
    bit<128> inv_expandkey_r13;
    bit<128> inv_expandkey_r14;
}

header dh_meta_t {
    bit<256> secrect;
    bit<256> pu;
}
struct my_metadata_t {
    aes_meta_t aes;
    dh_meta_t[8] dh;
}

parser MyParser(
    packet_in packet,
    out my_headers_t hdr,
    inout my_metadata_t meta,
    inout standard_metadata_t standard_metadata)
{
    state start {
        packet.extract(hdr.ethernet);
        transition select(hdr.ethernet.etherType) {
           0x9999 : parse_aes;
           0x812 : parse_dh_probe;
           default : accept;
        }
    }

    state parse_aes {
        packet.extract(hdr.aes_inout);
        transition accept;
    }

    state parse_dh_probe {
        packet.extract(hdr.dh_probe.next);
        transition accept;
    }
}

control MyVerifyChecksum(inout my_headers_t hdr, inout my_metadata_t meta) {
    apply { }
}

control MyIngress(
    inout my_headers_t hdr,
    inout my_metadata_t meta,
    inout standard_metadata_t standard_metadata)
{
    bit<256> encryptKey256;
    bit<256> decryptKey256;
    bit<256> secretKey256;
    bit<128> secretKey128;
    bit<256> privateKey;

    bit<2> flag; // 0x3 = encrypt / 0x0 = decrypt / 0x1-0x2 = bypass
    bit<2> keysize; // 0x0 = 128 / 0x1 = 192 / 0x2 = 256

    //  t  ->  previous 4 bytes
    bit<32> t;
    bit<32> t_par0;
    bit<32> t_par1;
    bit<32> t_par2;
    bit<32> t_par3;

    bit<8> word0;
    bit<8> word1;
    bit<8> word2;
    bit<8> word3;

    bit<32> t0_inv;
    bit<32> t1_inv;
    bit<32> t2_inv;
    bit<32> t3_inv;

    bit<32> ti0;
    bit<32> ti1;
    bit<32> ti2;
    bit<32> ti3;

// expand key decrypt






action get_exp_key_r1(){ t0_inv = meta.aes.expandkey_r1[127:96]; t1_inv = meta.aes.expandkey_r1[95:64]; t2_inv = meta.aes.expandkey_r1[63:32]; t3_inv = meta.aes.expandkey_r1[31:0]; }
action get_exp_key_r2(){ t0_inv = meta.aes.expandkey_r2[127:96]; t1_inv = meta.aes.expandkey_r2[95:64]; t2_inv = meta.aes.expandkey_r2[63:32]; t3_inv = meta.aes.expandkey_r2[31:0]; }
action get_exp_key_r3(){ t0_inv = meta.aes.expandkey_r3[127:96]; t1_inv = meta.aes.expandkey_r3[95:64]; t2_inv = meta.aes.expandkey_r3[63:32]; t3_inv = meta.aes.expandkey_r3[31:0]; }
action get_exp_key_r4(){ t0_inv = meta.aes.expandkey_r4[127:96]; t1_inv = meta.aes.expandkey_r4[95:64]; t2_inv = meta.aes.expandkey_r4[63:32]; t3_inv = meta.aes.expandkey_r4[31:0]; }
action get_exp_key_r5(){ t0_inv = meta.aes.expandkey_r5[127:96]; t1_inv = meta.aes.expandkey_r5[95:64]; t2_inv = meta.aes.expandkey_r5[63:32]; t3_inv = meta.aes.expandkey_r5[31:0]; }
action get_exp_key_r6(){ t0_inv = meta.aes.expandkey_r6[127:96]; t1_inv = meta.aes.expandkey_r6[95:64]; t2_inv = meta.aes.expandkey_r6[63:32]; t3_inv = meta.aes.expandkey_r6[31:0]; }
action get_exp_key_r7(){ t0_inv = meta.aes.expandkey_r7[127:96]; t1_inv = meta.aes.expandkey_r7[95:64]; t2_inv = meta.aes.expandkey_r7[63:32]; t3_inv = meta.aes.expandkey_r7[31:0]; }
action get_exp_key_r8(){ t0_inv = meta.aes.expandkey_r8[127:96]; t1_inv = meta.aes.expandkey_r8[95:64]; t2_inv = meta.aes.expandkey_r8[63:32]; t3_inv = meta.aes.expandkey_r8[31:0]; }
action get_exp_key_r9(){ t0_inv = meta.aes.expandkey_r9[127:96]; t1_inv = meta.aes.expandkey_r9[95:64]; t2_inv = meta.aes.expandkey_r9[63:32]; t3_inv = meta.aes.expandkey_r9[31:0]; }
action get_exp_key_r10(){ t0_inv = meta.aes.expandkey_r10[127:96]; t1_inv = meta.aes.expandkey_r10[95:64]; t2_inv = meta.aes.expandkey_r10[63:32]; t3_inv = meta.aes.expandkey_r10[31:0]; }
action get_exp_key_r11(){ t0_inv = meta.aes.expandkey_r11[127:96]; t1_inv = meta.aes.expandkey_r11[95:64]; t2_inv = meta.aes.expandkey_r11[63:32]; t3_inv = meta.aes.expandkey_r11[31:0]; }
action get_exp_key_r12(){ t0_inv = meta.aes.expandkey_r12[127:96]; t1_inv = meta.aes.expandkey_r12[95:64]; t2_inv = meta.aes.expandkey_r12[63:32]; t3_inv = meta.aes.expandkey_r12[31:0]; }
action get_exp_key_r13(){ t0_inv = meta.aes.expandkey_r13[127:96]; t1_inv = meta.aes.expandkey_r13[95:64]; t2_inv = meta.aes.expandkey_r13[63:32]; t3_inv = meta.aes.expandkey_r13[31:0]; }







action get_exp_word_00_r0(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r0(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r0(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r0(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r1(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r1(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r1(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r1(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r2(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r2(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r2(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r2(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r3(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r3(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r3(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r3(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r4(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r4(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r4(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r4(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r5(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r5(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r5(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r5(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r6(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r6(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r6(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r6(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r7(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r7(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r7(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r7(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r8(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r8(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r8(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r8(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r9(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r9(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r9(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r9(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r10(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r10(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r10(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r10(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r11(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r11(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r11(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r11(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }
action get_exp_word_00_r12(){ word0 = t0_inv[31:24]; word1 = t0_inv[23:16]; word2 = t0_inv[15:8]; word3 = t0_inv[7:0]; }
action get_exp_word_01_r12(){ word0 = t1_inv[31:24]; word1 = t1_inv[23:16]; word2 = t1_inv[15:8]; word3 = t1_inv[7:0]; }
action get_exp_word_02_r12(){ word0 = t2_inv[31:24]; word1 = t2_inv[23:16]; word2 = t2_inv[15:8]; word3 = t2_inv[7:0]; }
action get_exp_word_03_r12(){ word0 = t3_inv[31:24]; word1 = t3_inv[23:16]; word2 = t3_inv[15:8]; word3 = t3_inv[7:0]; }




action merge_inv_to_ti0(bit<32> val){ ti0=val; }
action merge_inv_to_ti1(bit<32> val){ ti1=val; }
action merge_inv_to_ti2(bit<32> val){ ti2=val; }
action merge_inv_to_ti3(bit<32> val){ ti3=val; }




action expand_inv_00_r0(){ meta.aes.inv_expandkey_r1[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r0(){ meta.aes.inv_expandkey_r1[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r0(){ meta.aes.inv_expandkey_r1[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r0(){ meta.aes.inv_expandkey_r1[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r1(){ meta.aes.inv_expandkey_r2[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r1(){ meta.aes.inv_expandkey_r2[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r1(){ meta.aes.inv_expandkey_r2[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r1(){ meta.aes.inv_expandkey_r2[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r2(){ meta.aes.inv_expandkey_r3[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r2(){ meta.aes.inv_expandkey_r3[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r2(){ meta.aes.inv_expandkey_r3[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r2(){ meta.aes.inv_expandkey_r3[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r3(){ meta.aes.inv_expandkey_r4[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r3(){ meta.aes.inv_expandkey_r4[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r3(){ meta.aes.inv_expandkey_r4[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r3(){ meta.aes.inv_expandkey_r4[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r4(){ meta.aes.inv_expandkey_r5[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r4(){ meta.aes.inv_expandkey_r5[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r4(){ meta.aes.inv_expandkey_r5[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r4(){ meta.aes.inv_expandkey_r5[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r5(){ meta.aes.inv_expandkey_r6[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r5(){ meta.aes.inv_expandkey_r6[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r5(){ meta.aes.inv_expandkey_r6[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r5(){ meta.aes.inv_expandkey_r6[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r6(){ meta.aes.inv_expandkey_r7[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r6(){ meta.aes.inv_expandkey_r7[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r6(){ meta.aes.inv_expandkey_r7[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r6(){ meta.aes.inv_expandkey_r7[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r7(){ meta.aes.inv_expandkey_r8[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r7(){ meta.aes.inv_expandkey_r8[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r7(){ meta.aes.inv_expandkey_r8[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r7(){ meta.aes.inv_expandkey_r8[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r8(){ meta.aes.inv_expandkey_r9[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r8(){ meta.aes.inv_expandkey_r9[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r8(){ meta.aes.inv_expandkey_r9[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r8(){ meta.aes.inv_expandkey_r9[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r9(){ meta.aes.inv_expandkey_r10[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r9(){ meta.aes.inv_expandkey_r10[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r9(){ meta.aes.inv_expandkey_r10[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r9(){ meta.aes.inv_expandkey_r10[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r10(){ meta.aes.inv_expandkey_r11[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r10(){ meta.aes.inv_expandkey_r11[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r10(){ meta.aes.inv_expandkey_r11[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r10(){ meta.aes.inv_expandkey_r11[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r11(){ meta.aes.inv_expandkey_r12[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r11(){ meta.aes.inv_expandkey_r12[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r11(){ meta.aes.inv_expandkey_r12[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r11(){ meta.aes.inv_expandkey_r12[31:0] = ti0^ti1^ti2^ti3; }
action expand_inv_00_r12(){ meta.aes.inv_expandkey_r13[127:96] = ti0^ti1^ti2^ti3; }
action expand_inv_01_r12(){ meta.aes.inv_expandkey_r13[95:64] = ti0^ti1^ti2^ti3; }
action expand_inv_02_r12(){ meta.aes.inv_expandkey_r13[63:32] = ti0^ti1^ti2^ti3; }
action expand_inv_03_r12(){ meta.aes.inv_expandkey_r13[31:0] = ti0^ti1^ti2^ti3; }

// RC current round
// RO old round
// XOR t with the four-byte block bytes before the new expanded key
// This becomes the next four bytes in the expanded key







action expand_02_r0(){ t = meta.aes.expandkey_r1[127:96]; meta.aes.expandkey_r1[95:88] = meta.aes.expandkey_r0[95:88]^t[31:24]; meta.aes.expandkey_r1[87:80] = meta.aes.expandkey_r0[87:80]^t[23:16]; meta.aes.expandkey_r1[79:72] = meta.aes.expandkey_r0[79:72]^t[15:8]; meta.aes.expandkey_r1[71:64] = meta.aes.expandkey_r0[71:64]^t[7:0]; }
action expand_02_r1(){ t = meta.aes.expandkey_r2[127:96]; meta.aes.expandkey_r2[95:88] = meta.aes.expandkey_r1[95:88]^t[31:24]; meta.aes.expandkey_r2[87:80] = meta.aes.expandkey_r1[87:80]^t[23:16]; meta.aes.expandkey_r2[79:72] = meta.aes.expandkey_r1[79:72]^t[15:8]; meta.aes.expandkey_r2[71:64] = meta.aes.expandkey_r1[71:64]^t[7:0]; }
action expand_02_r2(){ t = meta.aes.expandkey_r3[127:96]; meta.aes.expandkey_r3[95:88] = meta.aes.expandkey_r2[95:88]^t[31:24]; meta.aes.expandkey_r3[87:80] = meta.aes.expandkey_r2[87:80]^t[23:16]; meta.aes.expandkey_r3[79:72] = meta.aes.expandkey_r2[79:72]^t[15:8]; meta.aes.expandkey_r3[71:64] = meta.aes.expandkey_r2[71:64]^t[7:0]; }
action expand_02_r3(){ t = meta.aes.expandkey_r4[127:96]; meta.aes.expandkey_r4[95:88] = meta.aes.expandkey_r3[95:88]^t[31:24]; meta.aes.expandkey_r4[87:80] = meta.aes.expandkey_r3[87:80]^t[23:16]; meta.aes.expandkey_r4[79:72] = meta.aes.expandkey_r3[79:72]^t[15:8]; meta.aes.expandkey_r4[71:64] = meta.aes.expandkey_r3[71:64]^t[7:0]; }
action expand_02_r4(){ t = meta.aes.expandkey_r5[127:96]; meta.aes.expandkey_r5[95:88] = meta.aes.expandkey_r4[95:88]^t[31:24]; meta.aes.expandkey_r5[87:80] = meta.aes.expandkey_r4[87:80]^t[23:16]; meta.aes.expandkey_r5[79:72] = meta.aes.expandkey_r4[79:72]^t[15:8]; meta.aes.expandkey_r5[71:64] = meta.aes.expandkey_r4[71:64]^t[7:0]; }
action expand_02_r5(){ t = meta.aes.expandkey_r6[127:96]; meta.aes.expandkey_r6[95:88] = meta.aes.expandkey_r5[95:88]^t[31:24]; meta.aes.expandkey_r6[87:80] = meta.aes.expandkey_r5[87:80]^t[23:16]; meta.aes.expandkey_r6[79:72] = meta.aes.expandkey_r5[79:72]^t[15:8]; meta.aes.expandkey_r6[71:64] = meta.aes.expandkey_r5[71:64]^t[7:0]; }
action expand_02_r6(){ t = meta.aes.expandkey_r7[127:96]; meta.aes.expandkey_r7[95:88] = meta.aes.expandkey_r6[95:88]^t[31:24]; meta.aes.expandkey_r7[87:80] = meta.aes.expandkey_r6[87:80]^t[23:16]; meta.aes.expandkey_r7[79:72] = meta.aes.expandkey_r6[79:72]^t[15:8]; meta.aes.expandkey_r7[71:64] = meta.aes.expandkey_r6[71:64]^t[7:0]; }
action expand_02_r7(){ t = meta.aes.expandkey_r8[127:96]; meta.aes.expandkey_r8[95:88] = meta.aes.expandkey_r7[95:88]^t[31:24]; meta.aes.expandkey_r8[87:80] = meta.aes.expandkey_r7[87:80]^t[23:16]; meta.aes.expandkey_r8[79:72] = meta.aes.expandkey_r7[79:72]^t[15:8]; meta.aes.expandkey_r8[71:64] = meta.aes.expandkey_r7[71:64]^t[7:0]; }
action expand_02_r8(){ t = meta.aes.expandkey_r9[127:96]; meta.aes.expandkey_r9[95:88] = meta.aes.expandkey_r8[95:88]^t[31:24]; meta.aes.expandkey_r9[87:80] = meta.aes.expandkey_r8[87:80]^t[23:16]; meta.aes.expandkey_r9[79:72] = meta.aes.expandkey_r8[79:72]^t[15:8]; meta.aes.expandkey_r9[71:64] = meta.aes.expandkey_r8[71:64]^t[7:0]; }
action expand_02_r9(){ t = meta.aes.expandkey_r10[127:96]; meta.aes.expandkey_r10[95:88] = meta.aes.expandkey_r9[95:88]^t[31:24]; meta.aes.expandkey_r10[87:80] = meta.aes.expandkey_r9[87:80]^t[23:16]; meta.aes.expandkey_r10[79:72] = meta.aes.expandkey_r9[79:72]^t[15:8]; meta.aes.expandkey_r10[71:64] = meta.aes.expandkey_r9[71:64]^t[7:0]; }
action expand_02_r10(){ t = meta.aes.expandkey_r11[127:96]; meta.aes.expandkey_r11[95:88] = meta.aes.expandkey_r10[95:88]^t[31:24]; meta.aes.expandkey_r11[87:80] = meta.aes.expandkey_r10[87:80]^t[23:16]; meta.aes.expandkey_r11[79:72] = meta.aes.expandkey_r10[79:72]^t[15:8]; meta.aes.expandkey_r11[71:64] = meta.aes.expandkey_r10[71:64]^t[7:0]; }
action expand_02_r11(){ t = meta.aes.expandkey_r12[127:96]; meta.aes.expandkey_r12[95:88] = meta.aes.expandkey_r11[95:88]^t[31:24]; meta.aes.expandkey_r12[87:80] = meta.aes.expandkey_r11[87:80]^t[23:16]; meta.aes.expandkey_r12[79:72] = meta.aes.expandkey_r11[79:72]^t[15:8]; meta.aes.expandkey_r12[71:64] = meta.aes.expandkey_r11[71:64]^t[7:0]; }
action expand_02_r12(){ t = meta.aes.expandkey_r13[127:96]; meta.aes.expandkey_r13[95:88] = meta.aes.expandkey_r12[95:88]^t[31:24]; meta.aes.expandkey_r13[87:80] = meta.aes.expandkey_r12[87:80]^t[23:16]; meta.aes.expandkey_r13[79:72] = meta.aes.expandkey_r12[79:72]^t[15:8]; meta.aes.expandkey_r13[71:64] = meta.aes.expandkey_r12[71:64]^t[7:0]; }
action expand_02_r13(){ t = meta.aes.expandkey_r14[127:96]; meta.aes.expandkey_r14[95:88] = meta.aes.expandkey_r13[95:88]^t[31:24]; meta.aes.expandkey_r14[87:80] = meta.aes.expandkey_r13[87:80]^t[23:16]; meta.aes.expandkey_r14[79:72] = meta.aes.expandkey_r13[79:72]^t[15:8]; meta.aes.expandkey_r14[71:64] = meta.aes.expandkey_r13[71:64]^t[7:0]; }
# 400 "dh_aes.p4"
action expand_02_192_r0(){ t = meta.aes.expandkey_r1[127:96]; meta.aes.expandkey_r1[95:88] = meta.aes.expandkey_r0[31:24]^t[31:24]; meta.aes.expandkey_r1[87:80] = meta.aes.expandkey_r0[23:16]^t[23:16]; meta.aes.expandkey_r1[79:72] = meta.aes.expandkey_r0[15:8]^t[15:8]; meta.aes.expandkey_r1[71:64] = meta.aes.expandkey_r0[7:0]^t[7:0]; }
action expand_02_192_r1(){ t = meta.aes.expandkey_r2[127:96]; meta.aes.expandkey_r2[95:88] = meta.aes.expandkey_r0[31:24]^t[31:24]; meta.aes.expandkey_r2[87:80] = meta.aes.expandkey_r0[23:16]^t[23:16]; meta.aes.expandkey_r2[79:72] = meta.aes.expandkey_r0[15:8]^t[15:8]; meta.aes.expandkey_r2[71:64] = meta.aes.expandkey_r0[7:0]^t[7:0]; }
action expand_02_192_r2(){ t = meta.aes.expandkey_r3[127:96]; meta.aes.expandkey_r3[95:88] = meta.aes.expandkey_r1[31:24]^t[31:24]; meta.aes.expandkey_r3[87:80] = meta.aes.expandkey_r1[23:16]^t[23:16]; meta.aes.expandkey_r3[79:72] = meta.aes.expandkey_r1[15:8]^t[15:8]; meta.aes.expandkey_r3[71:64] = meta.aes.expandkey_r1[7:0]^t[7:0]; }
action expand_02_192_r3(){ t = meta.aes.expandkey_r4[127:96]; meta.aes.expandkey_r4[95:88] = meta.aes.expandkey_r2[31:24]^t[31:24]; meta.aes.expandkey_r4[87:80] = meta.aes.expandkey_r2[23:16]^t[23:16]; meta.aes.expandkey_r4[79:72] = meta.aes.expandkey_r2[15:8]^t[15:8]; meta.aes.expandkey_r4[71:64] = meta.aes.expandkey_r2[7:0]^t[7:0]; }
action expand_02_192_r4(){ t = meta.aes.expandkey_r5[127:96]; meta.aes.expandkey_r5[95:88] = meta.aes.expandkey_r3[31:24]^t[31:24]; meta.aes.expandkey_r5[87:80] = meta.aes.expandkey_r3[23:16]^t[23:16]; meta.aes.expandkey_r5[79:72] = meta.aes.expandkey_r3[15:8]^t[15:8]; meta.aes.expandkey_r5[71:64] = meta.aes.expandkey_r3[7:0]^t[7:0]; }
action expand_02_192_r5(){ t = meta.aes.expandkey_r6[127:96]; meta.aes.expandkey_r6[95:88] = meta.aes.expandkey_r4[31:24]^t[31:24]; meta.aes.expandkey_r6[87:80] = meta.aes.expandkey_r4[23:16]^t[23:16]; meta.aes.expandkey_r6[79:72] = meta.aes.expandkey_r4[15:8]^t[15:8]; meta.aes.expandkey_r6[71:64] = meta.aes.expandkey_r4[7:0]^t[7:0]; }
action expand_02_192_r6(){ t = meta.aes.expandkey_r7[127:96]; meta.aes.expandkey_r7[95:88] = meta.aes.expandkey_r5[31:24]^t[31:24]; meta.aes.expandkey_r7[87:80] = meta.aes.expandkey_r5[23:16]^t[23:16]; meta.aes.expandkey_r7[79:72] = meta.aes.expandkey_r5[15:8]^t[15:8]; meta.aes.expandkey_r7[71:64] = meta.aes.expandkey_r5[7:0]^t[7:0]; }
action expand_02_192_r7(){ t = meta.aes.expandkey_r8[127:96]; meta.aes.expandkey_r8[95:88] = meta.aes.expandkey_r6[31:24]^t[31:24]; meta.aes.expandkey_r8[87:80] = meta.aes.expandkey_r6[23:16]^t[23:16]; meta.aes.expandkey_r8[79:72] = meta.aes.expandkey_r6[15:8]^t[15:8]; meta.aes.expandkey_r8[71:64] = meta.aes.expandkey_r6[7:0]^t[7:0]; }
action expand_02_192_r8(){ t = meta.aes.expandkey_r9[127:96]; meta.aes.expandkey_r9[95:88] = meta.aes.expandkey_r7[31:24]^t[31:24]; meta.aes.expandkey_r9[87:80] = meta.aes.expandkey_r7[23:16]^t[23:16]; meta.aes.expandkey_r9[79:72] = meta.aes.expandkey_r7[15:8]^t[15:8]; meta.aes.expandkey_r9[71:64] = meta.aes.expandkey_r7[7:0]^t[7:0]; }
action expand_02_192_r9(){ t = meta.aes.expandkey_r10[127:96]; meta.aes.expandkey_r10[95:88] = meta.aes.expandkey_r8[31:24]^t[31:24]; meta.aes.expandkey_r10[87:80] = meta.aes.expandkey_r8[23:16]^t[23:16]; meta.aes.expandkey_r10[79:72] = meta.aes.expandkey_r8[15:8]^t[15:8]; meta.aes.expandkey_r10[71:64] = meta.aes.expandkey_r8[7:0]^t[7:0]; }
action expand_02_192_r10(){ t = meta.aes.expandkey_r11[127:96]; meta.aes.expandkey_r11[95:88] = meta.aes.expandkey_r9[31:24]^t[31:24]; meta.aes.expandkey_r11[87:80] = meta.aes.expandkey_r9[23:16]^t[23:16]; meta.aes.expandkey_r11[79:72] = meta.aes.expandkey_r9[15:8]^t[15:8]; meta.aes.expandkey_r11[71:64] = meta.aes.expandkey_r9[7:0]^t[7:0]; }
action expand_02_192_r11(){ t = meta.aes.expandkey_r12[127:96]; meta.aes.expandkey_r12[95:88] = meta.aes.expandkey_r10[31:24]^t[31:24]; meta.aes.expandkey_r12[87:80] = meta.aes.expandkey_r10[23:16]^t[23:16]; meta.aes.expandkey_r12[79:72] = meta.aes.expandkey_r10[15:8]^t[15:8]; meta.aes.expandkey_r12[71:64] = meta.aes.expandkey_r10[7:0]^t[7:0]; }
action expand_02_192_r12(){ t = meta.aes.expandkey_r13[127:96]; meta.aes.expandkey_r13[95:88] = meta.aes.expandkey_r11[31:24]^t[31:24]; meta.aes.expandkey_r13[87:80] = meta.aes.expandkey_r11[23:16]^t[23:16]; meta.aes.expandkey_r13[79:72] = meta.aes.expandkey_r11[15:8]^t[15:8]; meta.aes.expandkey_r13[71:64] = meta.aes.expandkey_r11[7:0]^t[7:0]; }
action expand_02_192_r13(){ t = meta.aes.expandkey_r14[127:96]; meta.aes.expandkey_r14[95:88] = meta.aes.expandkey_r12[31:24]^t[31:24]; meta.aes.expandkey_r14[87:80] = meta.aes.expandkey_r12[23:16]^t[23:16]; meta.aes.expandkey_r14[79:72] = meta.aes.expandkey_r12[15:8]^t[15:8]; meta.aes.expandkey_r14[71:64] = meta.aes.expandkey_r12[7:0]^t[7:0]; }
# 422 "dh_aes.p4"
action expand_02_256_r1(){ t = meta.aes.expandkey_r2[127:96]; meta.aes.expandkey_r2[95:88] = meta.aes.expandkey_r0[95:88]^t[31:24]; meta.aes.expandkey_r2[87:80] = meta.aes.expandkey_r0[87:80]^t[23:16]; meta.aes.expandkey_r2[79:72] = meta.aes.expandkey_r0[79:72]^t[15:8]; meta.aes.expandkey_r2[71:64] = meta.aes.expandkey_r0[71:64]^t[7:0]; }
action expand_02_256_r2(){ t = meta.aes.expandkey_r3[127:96]; meta.aes.expandkey_r3[95:88] = meta.aes.expandkey_r1[95:88]^t[31:24]; meta.aes.expandkey_r3[87:80] = meta.aes.expandkey_r1[87:80]^t[23:16]; meta.aes.expandkey_r3[79:72] = meta.aes.expandkey_r1[79:72]^t[15:8]; meta.aes.expandkey_r3[71:64] = meta.aes.expandkey_r1[71:64]^t[7:0]; }
action expand_02_256_r3(){ t = meta.aes.expandkey_r4[127:96]; meta.aes.expandkey_r4[95:88] = meta.aes.expandkey_r2[95:88]^t[31:24]; meta.aes.expandkey_r4[87:80] = meta.aes.expandkey_r2[87:80]^t[23:16]; meta.aes.expandkey_r4[79:72] = meta.aes.expandkey_r2[79:72]^t[15:8]; meta.aes.expandkey_r4[71:64] = meta.aes.expandkey_r2[71:64]^t[7:0]; }
action expand_02_256_r4(){ t = meta.aes.expandkey_r5[127:96]; meta.aes.expandkey_r5[95:88] = meta.aes.expandkey_r3[95:88]^t[31:24]; meta.aes.expandkey_r5[87:80] = meta.aes.expandkey_r3[87:80]^t[23:16]; meta.aes.expandkey_r5[79:72] = meta.aes.expandkey_r3[79:72]^t[15:8]; meta.aes.expandkey_r5[71:64] = meta.aes.expandkey_r3[71:64]^t[7:0]; }
action expand_02_256_r5(){ t = meta.aes.expandkey_r6[127:96]; meta.aes.expandkey_r6[95:88] = meta.aes.expandkey_r4[95:88]^t[31:24]; meta.aes.expandkey_r6[87:80] = meta.aes.expandkey_r4[87:80]^t[23:16]; meta.aes.expandkey_r6[79:72] = meta.aes.expandkey_r4[79:72]^t[15:8]; meta.aes.expandkey_r6[71:64] = meta.aes.expandkey_r4[71:64]^t[7:0]; }
action expand_02_256_r6(){ t = meta.aes.expandkey_r7[127:96]; meta.aes.expandkey_r7[95:88] = meta.aes.expandkey_r5[95:88]^t[31:24]; meta.aes.expandkey_r7[87:80] = meta.aes.expandkey_r5[87:80]^t[23:16]; meta.aes.expandkey_r7[79:72] = meta.aes.expandkey_r5[79:72]^t[15:8]; meta.aes.expandkey_r7[71:64] = meta.aes.expandkey_r5[71:64]^t[7:0]; }
action expand_02_256_r7(){ t = meta.aes.expandkey_r8[127:96]; meta.aes.expandkey_r8[95:88] = meta.aes.expandkey_r6[95:88]^t[31:24]; meta.aes.expandkey_r8[87:80] = meta.aes.expandkey_r6[87:80]^t[23:16]; meta.aes.expandkey_r8[79:72] = meta.aes.expandkey_r6[79:72]^t[15:8]; meta.aes.expandkey_r8[71:64] = meta.aes.expandkey_r6[71:64]^t[7:0]; }
action expand_02_256_r8(){ t = meta.aes.expandkey_r9[127:96]; meta.aes.expandkey_r9[95:88] = meta.aes.expandkey_r7[95:88]^t[31:24]; meta.aes.expandkey_r9[87:80] = meta.aes.expandkey_r7[87:80]^t[23:16]; meta.aes.expandkey_r9[79:72] = meta.aes.expandkey_r7[79:72]^t[15:8]; meta.aes.expandkey_r9[71:64] = meta.aes.expandkey_r7[71:64]^t[7:0]; }
action expand_02_256_r9(){ t = meta.aes.expandkey_r10[127:96]; meta.aes.expandkey_r10[95:88] = meta.aes.expandkey_r8[95:88]^t[31:24]; meta.aes.expandkey_r10[87:80] = meta.aes.expandkey_r8[87:80]^t[23:16]; meta.aes.expandkey_r10[79:72] = meta.aes.expandkey_r8[79:72]^t[15:8]; meta.aes.expandkey_r10[71:64] = meta.aes.expandkey_r8[71:64]^t[7:0]; }
action expand_02_256_r10(){ t = meta.aes.expandkey_r11[127:96]; meta.aes.expandkey_r11[95:88] = meta.aes.expandkey_r9[95:88]^t[31:24]; meta.aes.expandkey_r11[87:80] = meta.aes.expandkey_r9[87:80]^t[23:16]; meta.aes.expandkey_r11[79:72] = meta.aes.expandkey_r9[79:72]^t[15:8]; meta.aes.expandkey_r11[71:64] = meta.aes.expandkey_r9[71:64]^t[7:0]; }
action expand_02_256_r11(){ t = meta.aes.expandkey_r12[127:96]; meta.aes.expandkey_r12[95:88] = meta.aes.expandkey_r10[95:88]^t[31:24]; meta.aes.expandkey_r12[87:80] = meta.aes.expandkey_r10[87:80]^t[23:16]; meta.aes.expandkey_r12[79:72] = meta.aes.expandkey_r10[79:72]^t[15:8]; meta.aes.expandkey_r12[71:64] = meta.aes.expandkey_r10[71:64]^t[7:0]; }
action expand_02_256_r12(){ t = meta.aes.expandkey_r13[127:96]; meta.aes.expandkey_r13[95:88] = meta.aes.expandkey_r11[95:88]^t[31:24]; meta.aes.expandkey_r13[87:80] = meta.aes.expandkey_r11[87:80]^t[23:16]; meta.aes.expandkey_r13[79:72] = meta.aes.expandkey_r11[79:72]^t[15:8]; meta.aes.expandkey_r13[71:64] = meta.aes.expandkey_r11[71:64]^t[7:0]; }
action expand_02_256_r13(){ t = meta.aes.expandkey_r14[127:96]; meta.aes.expandkey_r14[95:88] = meta.aes.expandkey_r12[95:88]^t[31:24]; meta.aes.expandkey_r14[87:80] = meta.aes.expandkey_r12[87:80]^t[23:16]; meta.aes.expandkey_r14[79:72] = meta.aes.expandkey_r12[79:72]^t[15:8]; meta.aes.expandkey_r14[71:64] = meta.aes.expandkey_r12[71:64]^t[7:0]; }
# 447 "dh_aes.p4"
action expand_03_r0(){ meta.aes.expandkey_r1[63:56] = meta.aes.expandkey_r0[63:56]^t[31:24]; meta.aes.expandkey_r1[55:48] = meta.aes.expandkey_r0[55:48]^t[23:16]; meta.aes.expandkey_r1[47:40] = meta.aes.expandkey_r0[47:40]^t[15:8]; meta.aes.expandkey_r1[39:32] = meta.aes.expandkey_r0[39:32]^t[7:0]; t = meta.aes.expandkey_r1[63:32]; meta.aes.expandkey_r1[31:24] = meta.aes.expandkey_r0[31:24]^t[31:24]; meta.aes.expandkey_r1[23:16] = meta.aes.expandkey_r0[23:16]^t[23:16]; meta.aes.expandkey_r1[15:8] = meta.aes.expandkey_r0[15:8]^t[15:8]; meta.aes.expandkey_r1[7:0] = meta.aes.expandkey_r0[7:0]^t[7:0]; }
action expand_03_r1(){ meta.aes.expandkey_r2[63:56] = meta.aes.expandkey_r1[63:56]^t[31:24]; meta.aes.expandkey_r2[55:48] = meta.aes.expandkey_r1[55:48]^t[23:16]; meta.aes.expandkey_r2[47:40] = meta.aes.expandkey_r1[47:40]^t[15:8]; meta.aes.expandkey_r2[39:32] = meta.aes.expandkey_r1[39:32]^t[7:0]; t = meta.aes.expandkey_r2[63:32]; meta.aes.expandkey_r2[31:24] = meta.aes.expandkey_r1[31:24]^t[31:24]; meta.aes.expandkey_r2[23:16] = meta.aes.expandkey_r1[23:16]^t[23:16]; meta.aes.expandkey_r2[15:8] = meta.aes.expandkey_r1[15:8]^t[15:8]; meta.aes.expandkey_r2[7:0] = meta.aes.expandkey_r1[7:0]^t[7:0]; }
action expand_03_r2(){ meta.aes.expandkey_r3[63:56] = meta.aes.expandkey_r2[63:56]^t[31:24]; meta.aes.expandkey_r3[55:48] = meta.aes.expandkey_r2[55:48]^t[23:16]; meta.aes.expandkey_r3[47:40] = meta.aes.expandkey_r2[47:40]^t[15:8]; meta.aes.expandkey_r3[39:32] = meta.aes.expandkey_r2[39:32]^t[7:0]; t = meta.aes.expandkey_r3[63:32]; meta.aes.expandkey_r3[31:24] = meta.aes.expandkey_r2[31:24]^t[31:24]; meta.aes.expandkey_r3[23:16] = meta.aes.expandkey_r2[23:16]^t[23:16]; meta.aes.expandkey_r3[15:8] = meta.aes.expandkey_r2[15:8]^t[15:8]; meta.aes.expandkey_r3[7:0] = meta.aes.expandkey_r2[7:0]^t[7:0]; }
action expand_03_r3(){ meta.aes.expandkey_r4[63:56] = meta.aes.expandkey_r3[63:56]^t[31:24]; meta.aes.expandkey_r4[55:48] = meta.aes.expandkey_r3[55:48]^t[23:16]; meta.aes.expandkey_r4[47:40] = meta.aes.expandkey_r3[47:40]^t[15:8]; meta.aes.expandkey_r4[39:32] = meta.aes.expandkey_r3[39:32]^t[7:0]; t = meta.aes.expandkey_r4[63:32]; meta.aes.expandkey_r4[31:24] = meta.aes.expandkey_r3[31:24]^t[31:24]; meta.aes.expandkey_r4[23:16] = meta.aes.expandkey_r3[23:16]^t[23:16]; meta.aes.expandkey_r4[15:8] = meta.aes.expandkey_r3[15:8]^t[15:8]; meta.aes.expandkey_r4[7:0] = meta.aes.expandkey_r3[7:0]^t[7:0]; }
action expand_03_r4(){ meta.aes.expandkey_r5[63:56] = meta.aes.expandkey_r4[63:56]^t[31:24]; meta.aes.expandkey_r5[55:48] = meta.aes.expandkey_r4[55:48]^t[23:16]; meta.aes.expandkey_r5[47:40] = meta.aes.expandkey_r4[47:40]^t[15:8]; meta.aes.expandkey_r5[39:32] = meta.aes.expandkey_r4[39:32]^t[7:0]; t = meta.aes.expandkey_r5[63:32]; meta.aes.expandkey_r5[31:24] = meta.aes.expandkey_r4[31:24]^t[31:24]; meta.aes.expandkey_r5[23:16] = meta.aes.expandkey_r4[23:16]^t[23:16]; meta.aes.expandkey_r5[15:8] = meta.aes.expandkey_r4[15:8]^t[15:8]; meta.aes.expandkey_r5[7:0] = meta.aes.expandkey_r4[7:0]^t[7:0]; }
action expand_03_r5(){ meta.aes.expandkey_r6[63:56] = meta.aes.expandkey_r5[63:56]^t[31:24]; meta.aes.expandkey_r6[55:48] = meta.aes.expandkey_r5[55:48]^t[23:16]; meta.aes.expandkey_r6[47:40] = meta.aes.expandkey_r5[47:40]^t[15:8]; meta.aes.expandkey_r6[39:32] = meta.aes.expandkey_r5[39:32]^t[7:0]; t = meta.aes.expandkey_r6[63:32]; meta.aes.expandkey_r6[31:24] = meta.aes.expandkey_r5[31:24]^t[31:24]; meta.aes.expandkey_r6[23:16] = meta.aes.expandkey_r5[23:16]^t[23:16]; meta.aes.expandkey_r6[15:8] = meta.aes.expandkey_r5[15:8]^t[15:8]; meta.aes.expandkey_r6[7:0] = meta.aes.expandkey_r5[7:0]^t[7:0]; }
action expand_03_r6(){ meta.aes.expandkey_r7[63:56] = meta.aes.expandkey_r6[63:56]^t[31:24]; meta.aes.expandkey_r7[55:48] = meta.aes.expandkey_r6[55:48]^t[23:16]; meta.aes.expandkey_r7[47:40] = meta.aes.expandkey_r6[47:40]^t[15:8]; meta.aes.expandkey_r7[39:32] = meta.aes.expandkey_r6[39:32]^t[7:0]; t = meta.aes.expandkey_r7[63:32]; meta.aes.expandkey_r7[31:24] = meta.aes.expandkey_r6[31:24]^t[31:24]; meta.aes.expandkey_r7[23:16] = meta.aes.expandkey_r6[23:16]^t[23:16]; meta.aes.expandkey_r7[15:8] = meta.aes.expandkey_r6[15:8]^t[15:8]; meta.aes.expandkey_r7[7:0] = meta.aes.expandkey_r6[7:0]^t[7:0]; }
action expand_03_r7(){ meta.aes.expandkey_r8[63:56] = meta.aes.expandkey_r7[63:56]^t[31:24]; meta.aes.expandkey_r8[55:48] = meta.aes.expandkey_r7[55:48]^t[23:16]; meta.aes.expandkey_r8[47:40] = meta.aes.expandkey_r7[47:40]^t[15:8]; meta.aes.expandkey_r8[39:32] = meta.aes.expandkey_r7[39:32]^t[7:0]; t = meta.aes.expandkey_r8[63:32]; meta.aes.expandkey_r8[31:24] = meta.aes.expandkey_r7[31:24]^t[31:24]; meta.aes.expandkey_r8[23:16] = meta.aes.expandkey_r7[23:16]^t[23:16]; meta.aes.expandkey_r8[15:8] = meta.aes.expandkey_r7[15:8]^t[15:8]; meta.aes.expandkey_r8[7:0] = meta.aes.expandkey_r7[7:0]^t[7:0]; }
action expand_03_r8(){ meta.aes.expandkey_r9[63:56] = meta.aes.expandkey_r8[63:56]^t[31:24]; meta.aes.expandkey_r9[55:48] = meta.aes.expandkey_r8[55:48]^t[23:16]; meta.aes.expandkey_r9[47:40] = meta.aes.expandkey_r8[47:40]^t[15:8]; meta.aes.expandkey_r9[39:32] = meta.aes.expandkey_r8[39:32]^t[7:0]; t = meta.aes.expandkey_r9[63:32]; meta.aes.expandkey_r9[31:24] = meta.aes.expandkey_r8[31:24]^t[31:24]; meta.aes.expandkey_r9[23:16] = meta.aes.expandkey_r8[23:16]^t[23:16]; meta.aes.expandkey_r9[15:8] = meta.aes.expandkey_r8[15:8]^t[15:8]; meta.aes.expandkey_r9[7:0] = meta.aes.expandkey_r8[7:0]^t[7:0]; }
action expand_03_r9(){ meta.aes.expandkey_r10[63:56] = meta.aes.expandkey_r9[63:56]^t[31:24]; meta.aes.expandkey_r10[55:48] = meta.aes.expandkey_r9[55:48]^t[23:16]; meta.aes.expandkey_r10[47:40] = meta.aes.expandkey_r9[47:40]^t[15:8]; meta.aes.expandkey_r10[39:32] = meta.aes.expandkey_r9[39:32]^t[7:0]; t = meta.aes.expandkey_r10[63:32]; meta.aes.expandkey_r10[31:24] = meta.aes.expandkey_r9[31:24]^t[31:24]; meta.aes.expandkey_r10[23:16] = meta.aes.expandkey_r9[23:16]^t[23:16]; meta.aes.expandkey_r10[15:8] = meta.aes.expandkey_r9[15:8]^t[15:8]; meta.aes.expandkey_r10[7:0] = meta.aes.expandkey_r9[7:0]^t[7:0]; }
action expand_03_r10(){ meta.aes.expandkey_r11[63:56] = meta.aes.expandkey_r10[63:56]^t[31:24]; meta.aes.expandkey_r11[55:48] = meta.aes.expandkey_r10[55:48]^t[23:16]; meta.aes.expandkey_r11[47:40] = meta.aes.expandkey_r10[47:40]^t[15:8]; meta.aes.expandkey_r11[39:32] = meta.aes.expandkey_r10[39:32]^t[7:0]; t = meta.aes.expandkey_r11[63:32]; meta.aes.expandkey_r11[31:24] = meta.aes.expandkey_r10[31:24]^t[31:24]; meta.aes.expandkey_r11[23:16] = meta.aes.expandkey_r10[23:16]^t[23:16]; meta.aes.expandkey_r11[15:8] = meta.aes.expandkey_r10[15:8]^t[15:8]; meta.aes.expandkey_r11[7:0] = meta.aes.expandkey_r10[7:0]^t[7:0]; }
action expand_03_r11(){ meta.aes.expandkey_r12[63:56] = meta.aes.expandkey_r11[63:56]^t[31:24]; meta.aes.expandkey_r12[55:48] = meta.aes.expandkey_r11[55:48]^t[23:16]; meta.aes.expandkey_r12[47:40] = meta.aes.expandkey_r11[47:40]^t[15:8]; meta.aes.expandkey_r12[39:32] = meta.aes.expandkey_r11[39:32]^t[7:0]; t = meta.aes.expandkey_r12[63:32]; meta.aes.expandkey_r12[31:24] = meta.aes.expandkey_r11[31:24]^t[31:24]; meta.aes.expandkey_r12[23:16] = meta.aes.expandkey_r11[23:16]^t[23:16]; meta.aes.expandkey_r12[15:8] = meta.aes.expandkey_r11[15:8]^t[15:8]; meta.aes.expandkey_r12[7:0] = meta.aes.expandkey_r11[7:0]^t[7:0]; }
action expand_03_r12(){ meta.aes.expandkey_r13[63:56] = meta.aes.expandkey_r12[63:56]^t[31:24]; meta.aes.expandkey_r13[55:48] = meta.aes.expandkey_r12[55:48]^t[23:16]; meta.aes.expandkey_r13[47:40] = meta.aes.expandkey_r12[47:40]^t[15:8]; meta.aes.expandkey_r13[39:32] = meta.aes.expandkey_r12[39:32]^t[7:0]; t = meta.aes.expandkey_r13[63:32]; meta.aes.expandkey_r13[31:24] = meta.aes.expandkey_r12[31:24]^t[31:24]; meta.aes.expandkey_r13[23:16] = meta.aes.expandkey_r12[23:16]^t[23:16]; meta.aes.expandkey_r13[15:8] = meta.aes.expandkey_r12[15:8]^t[15:8]; meta.aes.expandkey_r13[7:0] = meta.aes.expandkey_r12[7:0]^t[7:0]; }
action expand_03_r13(){ meta.aes.expandkey_r14[63:56] = meta.aes.expandkey_r13[63:56]^t[31:24]; meta.aes.expandkey_r14[55:48] = meta.aes.expandkey_r13[55:48]^t[23:16]; meta.aes.expandkey_r14[47:40] = meta.aes.expandkey_r13[47:40]^t[15:8]; meta.aes.expandkey_r14[39:32] = meta.aes.expandkey_r13[39:32]^t[7:0]; t = meta.aes.expandkey_r14[63:32]; meta.aes.expandkey_r14[31:24] = meta.aes.expandkey_r13[31:24]^t[31:24]; meta.aes.expandkey_r14[23:16] = meta.aes.expandkey_r13[23:16]^t[23:16]; meta.aes.expandkey_r14[15:8] = meta.aes.expandkey_r13[15:8]^t[15:8]; meta.aes.expandkey_r14[7:0] = meta.aes.expandkey_r13[7:0]^t[7:0]; }
# 473 "dh_aes.p4"
action expand_03_192_r0(){ meta.aes.expandkey_r1[63:56] = meta.aes.expandkey_r0[127:120]^t[31:24]; meta.aes.expandkey_r1[55:48] = meta.aes.expandkey_r0[119:112]^t[23:16]; meta.aes.expandkey_r1[47:40] = meta.aes.expandkey_r0[111:104]^t[15:8]; meta.aes.expandkey_r1[39:32] = meta.aes.expandkey_r0[103:96]^t[7:0]; t = meta.aes.expandkey_r1[63:32]; meta.aes.expandkey_r1[31:24] = meta.aes.expandkey_r0[95:88]^t[31:24]; meta.aes.expandkey_r1[23:16] = meta.aes.expandkey_r0[87:80]^t[23:16]; meta.aes.expandkey_r1[15:8] = meta.aes.expandkey_r0[79:72]^t[15:8]; meta.aes.expandkey_r1[7:0] = meta.aes.expandkey_r0[71:64]^t[7:0]; }
action expand_03_192_r1(){ meta.aes.expandkey_r2[63:56] = meta.aes.expandkey_r1[127:120]^t[31:24]; meta.aes.expandkey_r2[55:48] = meta.aes.expandkey_r1[119:112]^t[23:16]; meta.aes.expandkey_r2[47:40] = meta.aes.expandkey_r1[111:104]^t[15:8]; meta.aes.expandkey_r2[39:32] = meta.aes.expandkey_r1[103:96]^t[7:0]; t = meta.aes.expandkey_r2[63:32]; meta.aes.expandkey_r2[31:24] = meta.aes.expandkey_r1[95:88]^t[31:24]; meta.aes.expandkey_r2[23:16] = meta.aes.expandkey_r1[87:80]^t[23:16]; meta.aes.expandkey_r2[15:8] = meta.aes.expandkey_r1[79:72]^t[15:8]; meta.aes.expandkey_r2[7:0] = meta.aes.expandkey_r1[71:64]^t[7:0]; }
action expand_03_192_r2(){ meta.aes.expandkey_r3[63:56] = meta.aes.expandkey_r2[127:120]^t[31:24]; meta.aes.expandkey_r3[55:48] = meta.aes.expandkey_r2[119:112]^t[23:16]; meta.aes.expandkey_r3[47:40] = meta.aes.expandkey_r2[111:104]^t[15:8]; meta.aes.expandkey_r3[39:32] = meta.aes.expandkey_r2[103:96]^t[7:0]; t = meta.aes.expandkey_r3[63:32]; meta.aes.expandkey_r3[31:24] = meta.aes.expandkey_r2[95:88]^t[31:24]; meta.aes.expandkey_r3[23:16] = meta.aes.expandkey_r2[87:80]^t[23:16]; meta.aes.expandkey_r3[15:8] = meta.aes.expandkey_r2[79:72]^t[15:8]; meta.aes.expandkey_r3[7:0] = meta.aes.expandkey_r2[71:64]^t[7:0]; }
action expand_03_192_r3(){ meta.aes.expandkey_r4[63:56] = meta.aes.expandkey_r3[127:120]^t[31:24]; meta.aes.expandkey_r4[55:48] = meta.aes.expandkey_r3[119:112]^t[23:16]; meta.aes.expandkey_r4[47:40] = meta.aes.expandkey_r3[111:104]^t[15:8]; meta.aes.expandkey_r4[39:32] = meta.aes.expandkey_r3[103:96]^t[7:0]; t = meta.aes.expandkey_r4[63:32]; meta.aes.expandkey_r4[31:24] = meta.aes.expandkey_r3[95:88]^t[31:24]; meta.aes.expandkey_r4[23:16] = meta.aes.expandkey_r3[87:80]^t[23:16]; meta.aes.expandkey_r4[15:8] = meta.aes.expandkey_r3[79:72]^t[15:8]; meta.aes.expandkey_r4[7:0] = meta.aes.expandkey_r3[71:64]^t[7:0]; }
action expand_03_192_r4(){ meta.aes.expandkey_r5[63:56] = meta.aes.expandkey_r4[127:120]^t[31:24]; meta.aes.expandkey_r5[55:48] = meta.aes.expandkey_r4[119:112]^t[23:16]; meta.aes.expandkey_r5[47:40] = meta.aes.expandkey_r4[111:104]^t[15:8]; meta.aes.expandkey_r5[39:32] = meta.aes.expandkey_r4[103:96]^t[7:0]; t = meta.aes.expandkey_r5[63:32]; meta.aes.expandkey_r5[31:24] = meta.aes.expandkey_r4[95:88]^t[31:24]; meta.aes.expandkey_r5[23:16] = meta.aes.expandkey_r4[87:80]^t[23:16]; meta.aes.expandkey_r5[15:8] = meta.aes.expandkey_r4[79:72]^t[15:8]; meta.aes.expandkey_r5[7:0] = meta.aes.expandkey_r4[71:64]^t[7:0]; }
action expand_03_192_r5(){ meta.aes.expandkey_r6[63:56] = meta.aes.expandkey_r5[127:120]^t[31:24]; meta.aes.expandkey_r6[55:48] = meta.aes.expandkey_r5[119:112]^t[23:16]; meta.aes.expandkey_r6[47:40] = meta.aes.expandkey_r5[111:104]^t[15:8]; meta.aes.expandkey_r6[39:32] = meta.aes.expandkey_r5[103:96]^t[7:0]; t = meta.aes.expandkey_r6[63:32]; meta.aes.expandkey_r6[31:24] = meta.aes.expandkey_r5[95:88]^t[31:24]; meta.aes.expandkey_r6[23:16] = meta.aes.expandkey_r5[87:80]^t[23:16]; meta.aes.expandkey_r6[15:8] = meta.aes.expandkey_r5[79:72]^t[15:8]; meta.aes.expandkey_r6[7:0] = meta.aes.expandkey_r5[71:64]^t[7:0]; }
action expand_03_192_r6(){ meta.aes.expandkey_r7[63:56] = meta.aes.expandkey_r6[127:120]^t[31:24]; meta.aes.expandkey_r7[55:48] = meta.aes.expandkey_r6[119:112]^t[23:16]; meta.aes.expandkey_r7[47:40] = meta.aes.expandkey_r6[111:104]^t[15:8]; meta.aes.expandkey_r7[39:32] = meta.aes.expandkey_r6[103:96]^t[7:0]; t = meta.aes.expandkey_r7[63:32]; meta.aes.expandkey_r7[31:24] = meta.aes.expandkey_r6[95:88]^t[31:24]; meta.aes.expandkey_r7[23:16] = meta.aes.expandkey_r6[87:80]^t[23:16]; meta.aes.expandkey_r7[15:8] = meta.aes.expandkey_r6[79:72]^t[15:8]; meta.aes.expandkey_r7[7:0] = meta.aes.expandkey_r6[71:64]^t[7:0]; }
action expand_03_192_r7(){ meta.aes.expandkey_r8[63:56] = meta.aes.expandkey_r7[127:120]^t[31:24]; meta.aes.expandkey_r8[55:48] = meta.aes.expandkey_r7[119:112]^t[23:16]; meta.aes.expandkey_r8[47:40] = meta.aes.expandkey_r7[111:104]^t[15:8]; meta.aes.expandkey_r8[39:32] = meta.aes.expandkey_r7[103:96]^t[7:0]; t = meta.aes.expandkey_r8[63:32]; meta.aes.expandkey_r8[31:24] = meta.aes.expandkey_r7[95:88]^t[31:24]; meta.aes.expandkey_r8[23:16] = meta.aes.expandkey_r7[87:80]^t[23:16]; meta.aes.expandkey_r8[15:8] = meta.aes.expandkey_r7[79:72]^t[15:8]; meta.aes.expandkey_r8[7:0] = meta.aes.expandkey_r7[71:64]^t[7:0]; }
action expand_03_192_r8(){ meta.aes.expandkey_r9[63:56] = meta.aes.expandkey_r8[127:120]^t[31:24]; meta.aes.expandkey_r9[55:48] = meta.aes.expandkey_r8[119:112]^t[23:16]; meta.aes.expandkey_r9[47:40] = meta.aes.expandkey_r8[111:104]^t[15:8]; meta.aes.expandkey_r9[39:32] = meta.aes.expandkey_r8[103:96]^t[7:0]; t = meta.aes.expandkey_r9[63:32]; meta.aes.expandkey_r9[31:24] = meta.aes.expandkey_r8[95:88]^t[31:24]; meta.aes.expandkey_r9[23:16] = meta.aes.expandkey_r8[87:80]^t[23:16]; meta.aes.expandkey_r9[15:8] = meta.aes.expandkey_r8[79:72]^t[15:8]; meta.aes.expandkey_r9[7:0] = meta.aes.expandkey_r8[71:64]^t[7:0]; }
action expand_03_192_r9(){ meta.aes.expandkey_r10[63:56] = meta.aes.expandkey_r9[127:120]^t[31:24]; meta.aes.expandkey_r10[55:48] = meta.aes.expandkey_r9[119:112]^t[23:16]; meta.aes.expandkey_r10[47:40] = meta.aes.expandkey_r9[111:104]^t[15:8]; meta.aes.expandkey_r10[39:32] = meta.aes.expandkey_r9[103:96]^t[7:0]; t = meta.aes.expandkey_r10[63:32]; meta.aes.expandkey_r10[31:24] = meta.aes.expandkey_r9[95:88]^t[31:24]; meta.aes.expandkey_r10[23:16] = meta.aes.expandkey_r9[87:80]^t[23:16]; meta.aes.expandkey_r10[15:8] = meta.aes.expandkey_r9[79:72]^t[15:8]; meta.aes.expandkey_r10[7:0] = meta.aes.expandkey_r9[71:64]^t[7:0]; }
action expand_03_192_r10(){ meta.aes.expandkey_r11[63:56] = meta.aes.expandkey_r10[127:120]^t[31:24]; meta.aes.expandkey_r11[55:48] = meta.aes.expandkey_r10[119:112]^t[23:16]; meta.aes.expandkey_r11[47:40] = meta.aes.expandkey_r10[111:104]^t[15:8]; meta.aes.expandkey_r11[39:32] = meta.aes.expandkey_r10[103:96]^t[7:0]; t = meta.aes.expandkey_r11[63:32]; meta.aes.expandkey_r11[31:24] = meta.aes.expandkey_r10[95:88]^t[31:24]; meta.aes.expandkey_r11[23:16] = meta.aes.expandkey_r10[87:80]^t[23:16]; meta.aes.expandkey_r11[15:8] = meta.aes.expandkey_r10[79:72]^t[15:8]; meta.aes.expandkey_r11[7:0] = meta.aes.expandkey_r10[71:64]^t[7:0]; }
action expand_03_192_r11(){ meta.aes.expandkey_r12[63:56] = meta.aes.expandkey_r11[127:120]^t[31:24]; meta.aes.expandkey_r12[55:48] = meta.aes.expandkey_r11[119:112]^t[23:16]; meta.aes.expandkey_r12[47:40] = meta.aes.expandkey_r11[111:104]^t[15:8]; meta.aes.expandkey_r12[39:32] = meta.aes.expandkey_r11[103:96]^t[7:0]; t = meta.aes.expandkey_r12[63:32]; meta.aes.expandkey_r12[31:24] = meta.aes.expandkey_r11[95:88]^t[31:24]; meta.aes.expandkey_r12[23:16] = meta.aes.expandkey_r11[87:80]^t[23:16]; meta.aes.expandkey_r12[15:8] = meta.aes.expandkey_r11[79:72]^t[15:8]; meta.aes.expandkey_r12[7:0] = meta.aes.expandkey_r11[71:64]^t[7:0]; }
action expand_03_192_r12(){ meta.aes.expandkey_r13[63:56] = meta.aes.expandkey_r12[127:120]^t[31:24]; meta.aes.expandkey_r13[55:48] = meta.aes.expandkey_r12[119:112]^t[23:16]; meta.aes.expandkey_r13[47:40] = meta.aes.expandkey_r12[111:104]^t[15:8]; meta.aes.expandkey_r13[39:32] = meta.aes.expandkey_r12[103:96]^t[7:0]; t = meta.aes.expandkey_r13[63:32]; meta.aes.expandkey_r13[31:24] = meta.aes.expandkey_r12[95:88]^t[31:24]; meta.aes.expandkey_r13[23:16] = meta.aes.expandkey_r12[87:80]^t[23:16]; meta.aes.expandkey_r13[15:8] = meta.aes.expandkey_r12[79:72]^t[15:8]; meta.aes.expandkey_r13[7:0] = meta.aes.expandkey_r12[71:64]^t[7:0]; }
action expand_03_192_r13(){ meta.aes.expandkey_r14[63:56] = meta.aes.expandkey_r13[127:120]^t[31:24]; meta.aes.expandkey_r14[55:48] = meta.aes.expandkey_r13[119:112]^t[23:16]; meta.aes.expandkey_r14[47:40] = meta.aes.expandkey_r13[111:104]^t[15:8]; meta.aes.expandkey_r14[39:32] = meta.aes.expandkey_r13[103:96]^t[7:0]; t = meta.aes.expandkey_r14[63:32]; meta.aes.expandkey_r14[31:24] = meta.aes.expandkey_r13[95:88]^t[31:24]; meta.aes.expandkey_r14[23:16] = meta.aes.expandkey_r13[87:80]^t[23:16]; meta.aes.expandkey_r14[15:8] = meta.aes.expandkey_r13[79:72]^t[15:8]; meta.aes.expandkey_r14[7:0] = meta.aes.expandkey_r13[71:64]^t[7:0]; }
# 499 "dh_aes.p4"
action expand_03_256_r1(){ meta.aes.expandkey_r2[63:56] = meta.aes.expandkey_r0[63:56]^t[31:24]; meta.aes.expandkey_r2[55:48] = meta.aes.expandkey_r0[55:48]^t[23:16]; meta.aes.expandkey_r2[47:40] = meta.aes.expandkey_r0[47:40]^t[15:8]; meta.aes.expandkey_r2[39:32] = meta.aes.expandkey_r0[39:32]^t[7:0]; t = meta.aes.expandkey_r2[63:32]; meta.aes.expandkey_r2[31:24] = meta.aes.expandkey_r0[31:24]^t[31:24]; meta.aes.expandkey_r2[23:16] = meta.aes.expandkey_r0[23:16]^t[23:16]; meta.aes.expandkey_r2[15:8] = meta.aes.expandkey_r0[15:8]^t[15:8]; meta.aes.expandkey_r2[7:0] = meta.aes.expandkey_r0[7:0]^t[7:0]; }
action expand_03_256_r2(){ meta.aes.expandkey_r3[63:56] = meta.aes.expandkey_r1[63:56]^t[31:24]; meta.aes.expandkey_r3[55:48] = meta.aes.expandkey_r1[55:48]^t[23:16]; meta.aes.expandkey_r3[47:40] = meta.aes.expandkey_r1[47:40]^t[15:8]; meta.aes.expandkey_r3[39:32] = meta.aes.expandkey_r1[39:32]^t[7:0]; t = meta.aes.expandkey_r3[63:32]; meta.aes.expandkey_r3[31:24] = meta.aes.expandkey_r1[31:24]^t[31:24]; meta.aes.expandkey_r3[23:16] = meta.aes.expandkey_r1[23:16]^t[23:16]; meta.aes.expandkey_r3[15:8] = meta.aes.expandkey_r1[15:8]^t[15:8]; meta.aes.expandkey_r3[7:0] = meta.aes.expandkey_r1[7:0]^t[7:0]; }
action expand_03_256_r3(){ meta.aes.expandkey_r4[63:56] = meta.aes.expandkey_r2[63:56]^t[31:24]; meta.aes.expandkey_r4[55:48] = meta.aes.expandkey_r2[55:48]^t[23:16]; meta.aes.expandkey_r4[47:40] = meta.aes.expandkey_r2[47:40]^t[15:8]; meta.aes.expandkey_r4[39:32] = meta.aes.expandkey_r2[39:32]^t[7:0]; t = meta.aes.expandkey_r4[63:32]; meta.aes.expandkey_r4[31:24] = meta.aes.expandkey_r2[31:24]^t[31:24]; meta.aes.expandkey_r4[23:16] = meta.aes.expandkey_r2[23:16]^t[23:16]; meta.aes.expandkey_r4[15:8] = meta.aes.expandkey_r2[15:8]^t[15:8]; meta.aes.expandkey_r4[7:0] = meta.aes.expandkey_r2[7:0]^t[7:0]; }
action expand_03_256_r4(){ meta.aes.expandkey_r5[63:56] = meta.aes.expandkey_r3[63:56]^t[31:24]; meta.aes.expandkey_r5[55:48] = meta.aes.expandkey_r3[55:48]^t[23:16]; meta.aes.expandkey_r5[47:40] = meta.aes.expandkey_r3[47:40]^t[15:8]; meta.aes.expandkey_r5[39:32] = meta.aes.expandkey_r3[39:32]^t[7:0]; t = meta.aes.expandkey_r5[63:32]; meta.aes.expandkey_r5[31:24] = meta.aes.expandkey_r3[31:24]^t[31:24]; meta.aes.expandkey_r5[23:16] = meta.aes.expandkey_r3[23:16]^t[23:16]; meta.aes.expandkey_r5[15:8] = meta.aes.expandkey_r3[15:8]^t[15:8]; meta.aes.expandkey_r5[7:0] = meta.aes.expandkey_r3[7:0]^t[7:0]; }
action expand_03_256_r5(){ meta.aes.expandkey_r6[63:56] = meta.aes.expandkey_r4[63:56]^t[31:24]; meta.aes.expandkey_r6[55:48] = meta.aes.expandkey_r4[55:48]^t[23:16]; meta.aes.expandkey_r6[47:40] = meta.aes.expandkey_r4[47:40]^t[15:8]; meta.aes.expandkey_r6[39:32] = meta.aes.expandkey_r4[39:32]^t[7:0]; t = meta.aes.expandkey_r6[63:32]; meta.aes.expandkey_r6[31:24] = meta.aes.expandkey_r4[31:24]^t[31:24]; meta.aes.expandkey_r6[23:16] = meta.aes.expandkey_r4[23:16]^t[23:16]; meta.aes.expandkey_r6[15:8] = meta.aes.expandkey_r4[15:8]^t[15:8]; meta.aes.expandkey_r6[7:0] = meta.aes.expandkey_r4[7:0]^t[7:0]; }
action expand_03_256_r6(){ meta.aes.expandkey_r7[63:56] = meta.aes.expandkey_r5[63:56]^t[31:24]; meta.aes.expandkey_r7[55:48] = meta.aes.expandkey_r5[55:48]^t[23:16]; meta.aes.expandkey_r7[47:40] = meta.aes.expandkey_r5[47:40]^t[15:8]; meta.aes.expandkey_r7[39:32] = meta.aes.expandkey_r5[39:32]^t[7:0]; t = meta.aes.expandkey_r7[63:32]; meta.aes.expandkey_r7[31:24] = meta.aes.expandkey_r5[31:24]^t[31:24]; meta.aes.expandkey_r7[23:16] = meta.aes.expandkey_r5[23:16]^t[23:16]; meta.aes.expandkey_r7[15:8] = meta.aes.expandkey_r5[15:8]^t[15:8]; meta.aes.expandkey_r7[7:0] = meta.aes.expandkey_r5[7:0]^t[7:0]; }
action expand_03_256_r7(){ meta.aes.expandkey_r8[63:56] = meta.aes.expandkey_r6[63:56]^t[31:24]; meta.aes.expandkey_r8[55:48] = meta.aes.expandkey_r6[55:48]^t[23:16]; meta.aes.expandkey_r8[47:40] = meta.aes.expandkey_r6[47:40]^t[15:8]; meta.aes.expandkey_r8[39:32] = meta.aes.expandkey_r6[39:32]^t[7:0]; t = meta.aes.expandkey_r8[63:32]; meta.aes.expandkey_r8[31:24] = meta.aes.expandkey_r6[31:24]^t[31:24]; meta.aes.expandkey_r8[23:16] = meta.aes.expandkey_r6[23:16]^t[23:16]; meta.aes.expandkey_r8[15:8] = meta.aes.expandkey_r6[15:8]^t[15:8]; meta.aes.expandkey_r8[7:0] = meta.aes.expandkey_r6[7:0]^t[7:0]; }
action expand_03_256_r8(){ meta.aes.expandkey_r9[63:56] = meta.aes.expandkey_r7[63:56]^t[31:24]; meta.aes.expandkey_r9[55:48] = meta.aes.expandkey_r7[55:48]^t[23:16]; meta.aes.expandkey_r9[47:40] = meta.aes.expandkey_r7[47:40]^t[15:8]; meta.aes.expandkey_r9[39:32] = meta.aes.expandkey_r7[39:32]^t[7:0]; t = meta.aes.expandkey_r9[63:32]; meta.aes.expandkey_r9[31:24] = meta.aes.expandkey_r7[31:24]^t[31:24]; meta.aes.expandkey_r9[23:16] = meta.aes.expandkey_r7[23:16]^t[23:16]; meta.aes.expandkey_r9[15:8] = meta.aes.expandkey_r7[15:8]^t[15:8]; meta.aes.expandkey_r9[7:0] = meta.aes.expandkey_r7[7:0]^t[7:0]; }
action expand_03_256_r9(){ meta.aes.expandkey_r10[63:56] = meta.aes.expandkey_r8[63:56]^t[31:24]; meta.aes.expandkey_r10[55:48] = meta.aes.expandkey_r8[55:48]^t[23:16]; meta.aes.expandkey_r10[47:40] = meta.aes.expandkey_r8[47:40]^t[15:8]; meta.aes.expandkey_r10[39:32] = meta.aes.expandkey_r8[39:32]^t[7:0]; t = meta.aes.expandkey_r10[63:32]; meta.aes.expandkey_r10[31:24] = meta.aes.expandkey_r8[31:24]^t[31:24]; meta.aes.expandkey_r10[23:16] = meta.aes.expandkey_r8[23:16]^t[23:16]; meta.aes.expandkey_r10[15:8] = meta.aes.expandkey_r8[15:8]^t[15:8]; meta.aes.expandkey_r10[7:0] = meta.aes.expandkey_r8[7:0]^t[7:0]; }
action expand_03_256_r10(){ meta.aes.expandkey_r11[63:56] = meta.aes.expandkey_r9[63:56]^t[31:24]; meta.aes.expandkey_r11[55:48] = meta.aes.expandkey_r9[55:48]^t[23:16]; meta.aes.expandkey_r11[47:40] = meta.aes.expandkey_r9[47:40]^t[15:8]; meta.aes.expandkey_r11[39:32] = meta.aes.expandkey_r9[39:32]^t[7:0]; t = meta.aes.expandkey_r11[63:32]; meta.aes.expandkey_r11[31:24] = meta.aes.expandkey_r9[31:24]^t[31:24]; meta.aes.expandkey_r11[23:16] = meta.aes.expandkey_r9[23:16]^t[23:16]; meta.aes.expandkey_r11[15:8] = meta.aes.expandkey_r9[15:8]^t[15:8]; meta.aes.expandkey_r11[7:0] = meta.aes.expandkey_r9[7:0]^t[7:0]; }
action expand_03_256_r11(){ meta.aes.expandkey_r12[63:56] = meta.aes.expandkey_r10[63:56]^t[31:24]; meta.aes.expandkey_r12[55:48] = meta.aes.expandkey_r10[55:48]^t[23:16]; meta.aes.expandkey_r12[47:40] = meta.aes.expandkey_r10[47:40]^t[15:8]; meta.aes.expandkey_r12[39:32] = meta.aes.expandkey_r10[39:32]^t[7:0]; t = meta.aes.expandkey_r12[63:32]; meta.aes.expandkey_r12[31:24] = meta.aes.expandkey_r10[31:24]^t[31:24]; meta.aes.expandkey_r12[23:16] = meta.aes.expandkey_r10[23:16]^t[23:16]; meta.aes.expandkey_r12[15:8] = meta.aes.expandkey_r10[15:8]^t[15:8]; meta.aes.expandkey_r12[7:0] = meta.aes.expandkey_r10[7:0]^t[7:0]; }
action expand_03_256_r12(){ meta.aes.expandkey_r13[63:56] = meta.aes.expandkey_r11[63:56]^t[31:24]; meta.aes.expandkey_r13[55:48] = meta.aes.expandkey_r11[55:48]^t[23:16]; meta.aes.expandkey_r13[47:40] = meta.aes.expandkey_r11[47:40]^t[15:8]; meta.aes.expandkey_r13[39:32] = meta.aes.expandkey_r11[39:32]^t[7:0]; t = meta.aes.expandkey_r13[63:32]; meta.aes.expandkey_r13[31:24] = meta.aes.expandkey_r11[31:24]^t[31:24]; meta.aes.expandkey_r13[23:16] = meta.aes.expandkey_r11[23:16]^t[23:16]; meta.aes.expandkey_r13[15:8] = meta.aes.expandkey_r11[15:8]^t[15:8]; meta.aes.expandkey_r13[7:0] = meta.aes.expandkey_r11[7:0]^t[7:0]; }
action expand_03_256_r13(){ meta.aes.expandkey_r14[63:56] = meta.aes.expandkey_r12[63:56]^t[31:24]; meta.aes.expandkey_r14[55:48] = meta.aes.expandkey_r12[55:48]^t[23:16]; meta.aes.expandkey_r14[47:40] = meta.aes.expandkey_r12[47:40]^t[15:8]; meta.aes.expandkey_r14[39:32] = meta.aes.expandkey_r12[39:32]^t[7:0]; t = meta.aes.expandkey_r14[63:32]; meta.aes.expandkey_r14[31:24] = meta.aes.expandkey_r12[31:24]^t[31:24]; meta.aes.expandkey_r14[23:16] = meta.aes.expandkey_r12[23:16]^t[23:16]; meta.aes.expandkey_r14[15:8] = meta.aes.expandkey_r12[15:8]^t[15:8]; meta.aes.expandkey_r14[7:0] = meta.aes.expandkey_r12[7:0]^t[7:0]; }
# 520 "dh_aes.p4"
action expand_set_t_02_r0(){ t = meta.aes.expandkey_r1[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r1(){ t = meta.aes.expandkey_r2[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r2(){ t = meta.aes.expandkey_r3[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r3(){ t = meta.aes.expandkey_r4[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r4(){ t = meta.aes.expandkey_r5[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r5(){ t = meta.aes.expandkey_r6[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r6(){ t = meta.aes.expandkey_r7[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r7(){ t = meta.aes.expandkey_r8[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r8(){ t = meta.aes.expandkey_r9[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r9(){ t = meta.aes.expandkey_r10[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r10(){ t = meta.aes.expandkey_r11[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r11(){ t = meta.aes.expandkey_r12[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r12(){ t = meta.aes.expandkey_r13[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_02_r13(){ t = meta.aes.expandkey_r14[95:64]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }


// Assign the previous 4 bytes to the temporary value t
// Rotate the 32-bit t 8 bits to the left and save in wx
# 548 "dh_aes.p4"
action expand_set_t_01_r0(){ t[31:24] = meta.aes.expandkey_r0[31:24]; t[23:16] = meta.aes.expandkey_r0[23:16]; t[15:8] = meta.aes.expandkey_r0[15:8]; t[7:0] = meta.aes.expandkey_r0[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r1(){ t[31:24] = meta.aes.expandkey_r1[31:24]; t[23:16] = meta.aes.expandkey_r1[23:16]; t[15:8] = meta.aes.expandkey_r1[15:8]; t[7:0] = meta.aes.expandkey_r1[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r2(){ t[31:24] = meta.aes.expandkey_r2[31:24]; t[23:16] = meta.aes.expandkey_r2[23:16]; t[15:8] = meta.aes.expandkey_r2[15:8]; t[7:0] = meta.aes.expandkey_r2[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r3(){ t[31:24] = meta.aes.expandkey_r3[31:24]; t[23:16] = meta.aes.expandkey_r3[23:16]; t[15:8] = meta.aes.expandkey_r3[15:8]; t[7:0] = meta.aes.expandkey_r3[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r4(){ t[31:24] = meta.aes.expandkey_r4[31:24]; t[23:16] = meta.aes.expandkey_r4[23:16]; t[15:8] = meta.aes.expandkey_r4[15:8]; t[7:0] = meta.aes.expandkey_r4[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r5(){ t[31:24] = meta.aes.expandkey_r5[31:24]; t[23:16] = meta.aes.expandkey_r5[23:16]; t[15:8] = meta.aes.expandkey_r5[15:8]; t[7:0] = meta.aes.expandkey_r5[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r6(){ t[31:24] = meta.aes.expandkey_r6[31:24]; t[23:16] = meta.aes.expandkey_r6[23:16]; t[15:8] = meta.aes.expandkey_r6[15:8]; t[7:0] = meta.aes.expandkey_r6[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r7(){ t[31:24] = meta.aes.expandkey_r7[31:24]; t[23:16] = meta.aes.expandkey_r7[23:16]; t[15:8] = meta.aes.expandkey_r7[15:8]; t[7:0] = meta.aes.expandkey_r7[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r8(){ t[31:24] = meta.aes.expandkey_r8[31:24]; t[23:16] = meta.aes.expandkey_r8[23:16]; t[15:8] = meta.aes.expandkey_r8[15:8]; t[7:0] = meta.aes.expandkey_r8[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r9(){ t[31:24] = meta.aes.expandkey_r9[31:24]; t[23:16] = meta.aes.expandkey_r9[23:16]; t[15:8] = meta.aes.expandkey_r9[15:8]; t[7:0] = meta.aes.expandkey_r9[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r10(){ t[31:24] = meta.aes.expandkey_r10[31:24]; t[23:16] = meta.aes.expandkey_r10[23:16]; t[15:8] = meta.aes.expandkey_r10[15:8]; t[7:0] = meta.aes.expandkey_r10[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r11(){ t[31:24] = meta.aes.expandkey_r11[31:24]; t[23:16] = meta.aes.expandkey_r11[23:16]; t[15:8] = meta.aes.expandkey_r11[15:8]; t[7:0] = meta.aes.expandkey_r11[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r12(){ t[31:24] = meta.aes.expandkey_r12[31:24]; t[23:16] = meta.aes.expandkey_r12[23:16]; t[15:8] = meta.aes.expandkey_r12[15:8]; t[7:0] = meta.aes.expandkey_r12[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }
action expand_set_t_01_r13(){ t[31:24] = meta.aes.expandkey_r13[31:24]; t[23:16] = meta.aes.expandkey_r13[23:16]; t[15:8] = meta.aes.expandkey_r13[15:8]; t[7:0] = meta.aes.expandkey_r13[7:0]; word0 = t[23:16]; word1 = t[15:8]; word2 = t[7:0]; word3 = t[31:24]; }

// First XOR after sbox






action expand_01_r0(){ meta.aes.expandkey_r1[127:120] = meta.aes.expandkey_r0[127:120]^t[31:24]; meta.aes.expandkey_r1[119:112] = meta.aes.expandkey_r0[119:112]^t[23:16]; meta.aes.expandkey_r1[111:104] = meta.aes.expandkey_r0[111:104]^t[15:8]; meta.aes.expandkey_r1[103:96] = meta.aes.expandkey_r0[103:96]^t[7:0]; }
action expand_01_r1(){ meta.aes.expandkey_r2[127:120] = meta.aes.expandkey_r1[127:120]^t[31:24]; meta.aes.expandkey_r2[119:112] = meta.aes.expandkey_r1[119:112]^t[23:16]; meta.aes.expandkey_r2[111:104] = meta.aes.expandkey_r1[111:104]^t[15:8]; meta.aes.expandkey_r2[103:96] = meta.aes.expandkey_r1[103:96]^t[7:0]; }
action expand_01_r2(){ meta.aes.expandkey_r3[127:120] = meta.aes.expandkey_r2[127:120]^t[31:24]; meta.aes.expandkey_r3[119:112] = meta.aes.expandkey_r2[119:112]^t[23:16]; meta.aes.expandkey_r3[111:104] = meta.aes.expandkey_r2[111:104]^t[15:8]; meta.aes.expandkey_r3[103:96] = meta.aes.expandkey_r2[103:96]^t[7:0]; }
action expand_01_r3(){ meta.aes.expandkey_r4[127:120] = meta.aes.expandkey_r3[127:120]^t[31:24]; meta.aes.expandkey_r4[119:112] = meta.aes.expandkey_r3[119:112]^t[23:16]; meta.aes.expandkey_r4[111:104] = meta.aes.expandkey_r3[111:104]^t[15:8]; meta.aes.expandkey_r4[103:96] = meta.aes.expandkey_r3[103:96]^t[7:0]; }
action expand_01_r4(){ meta.aes.expandkey_r5[127:120] = meta.aes.expandkey_r4[127:120]^t[31:24]; meta.aes.expandkey_r5[119:112] = meta.aes.expandkey_r4[119:112]^t[23:16]; meta.aes.expandkey_r5[111:104] = meta.aes.expandkey_r4[111:104]^t[15:8]; meta.aes.expandkey_r5[103:96] = meta.aes.expandkey_r4[103:96]^t[7:0]; }
action expand_01_r5(){ meta.aes.expandkey_r6[127:120] = meta.aes.expandkey_r5[127:120]^t[31:24]; meta.aes.expandkey_r6[119:112] = meta.aes.expandkey_r5[119:112]^t[23:16]; meta.aes.expandkey_r6[111:104] = meta.aes.expandkey_r5[111:104]^t[15:8]; meta.aes.expandkey_r6[103:96] = meta.aes.expandkey_r5[103:96]^t[7:0]; }
action expand_01_r6(){ meta.aes.expandkey_r7[127:120] = meta.aes.expandkey_r6[127:120]^t[31:24]; meta.aes.expandkey_r7[119:112] = meta.aes.expandkey_r6[119:112]^t[23:16]; meta.aes.expandkey_r7[111:104] = meta.aes.expandkey_r6[111:104]^t[15:8]; meta.aes.expandkey_r7[103:96] = meta.aes.expandkey_r6[103:96]^t[7:0]; }
action expand_01_r7(){ meta.aes.expandkey_r8[127:120] = meta.aes.expandkey_r7[127:120]^t[31:24]; meta.aes.expandkey_r8[119:112] = meta.aes.expandkey_r7[119:112]^t[23:16]; meta.aes.expandkey_r8[111:104] = meta.aes.expandkey_r7[111:104]^t[15:8]; meta.aes.expandkey_r8[103:96] = meta.aes.expandkey_r7[103:96]^t[7:0]; }
action expand_01_r8(){ meta.aes.expandkey_r9[127:120] = meta.aes.expandkey_r8[127:120]^t[31:24]; meta.aes.expandkey_r9[119:112] = meta.aes.expandkey_r8[119:112]^t[23:16]; meta.aes.expandkey_r9[111:104] = meta.aes.expandkey_r8[111:104]^t[15:8]; meta.aes.expandkey_r9[103:96] = meta.aes.expandkey_r8[103:96]^t[7:0]; }
action expand_01_r9(){ meta.aes.expandkey_r10[127:120] = meta.aes.expandkey_r9[127:120]^t[31:24]; meta.aes.expandkey_r10[119:112] = meta.aes.expandkey_r9[119:112]^t[23:16]; meta.aes.expandkey_r10[111:104] = meta.aes.expandkey_r9[111:104]^t[15:8]; meta.aes.expandkey_r10[103:96] = meta.aes.expandkey_r9[103:96]^t[7:0]; }
action expand_01_r10(){ meta.aes.expandkey_r11[127:120] = meta.aes.expandkey_r10[127:120]^t[31:24]; meta.aes.expandkey_r11[119:112] = meta.aes.expandkey_r10[119:112]^t[23:16]; meta.aes.expandkey_r11[111:104] = meta.aes.expandkey_r10[111:104]^t[15:8]; meta.aes.expandkey_r11[103:96] = meta.aes.expandkey_r10[103:96]^t[7:0]; }
action expand_01_r11(){ meta.aes.expandkey_r12[127:120] = meta.aes.expandkey_r11[127:120]^t[31:24]; meta.aes.expandkey_r12[119:112] = meta.aes.expandkey_r11[119:112]^t[23:16]; meta.aes.expandkey_r12[111:104] = meta.aes.expandkey_r11[111:104]^t[15:8]; meta.aes.expandkey_r12[103:96] = meta.aes.expandkey_r11[103:96]^t[7:0]; }
action expand_01_r12(){ meta.aes.expandkey_r13[127:120] = meta.aes.expandkey_r12[127:120]^t[31:24]; meta.aes.expandkey_r13[119:112] = meta.aes.expandkey_r12[119:112]^t[23:16]; meta.aes.expandkey_r13[111:104] = meta.aes.expandkey_r12[111:104]^t[15:8]; meta.aes.expandkey_r13[103:96] = meta.aes.expandkey_r12[103:96]^t[7:0]; }
action expand_01_r13(){ meta.aes.expandkey_r14[127:120] = meta.aes.expandkey_r13[127:120]^t[31:24]; meta.aes.expandkey_r14[119:112] = meta.aes.expandkey_r13[119:112]^t[23:16]; meta.aes.expandkey_r14[111:104] = meta.aes.expandkey_r13[111:104]^t[15:8]; meta.aes.expandkey_r14[103:96] = meta.aes.expandkey_r13[103:96]^t[7:0]; }







action expand_01_192_r1(){ meta.aes.expandkey_r2[127:120] = meta.aes.expandkey_r0[63:56]^t[31:24]; meta.aes.expandkey_r2[119:112] = meta.aes.expandkey_r0[55:48]^t[23:16]; meta.aes.expandkey_r2[111:104] = meta.aes.expandkey_r0[47:40]^t[15:8]; meta.aes.expandkey_r2[103:96] = meta.aes.expandkey_r0[39:32]^t[7:0]; }
action expand_01_192_r2(){ meta.aes.expandkey_r3[127:120] = meta.aes.expandkey_r1[63:56]^t[31:24]; meta.aes.expandkey_r3[119:112] = meta.aes.expandkey_r1[55:48]^t[23:16]; meta.aes.expandkey_r3[111:104] = meta.aes.expandkey_r1[47:40]^t[15:8]; meta.aes.expandkey_r3[103:96] = meta.aes.expandkey_r1[39:32]^t[7:0]; }
action expand_01_192_r3(){ meta.aes.expandkey_r4[127:120] = meta.aes.expandkey_r2[63:56]^t[31:24]; meta.aes.expandkey_r4[119:112] = meta.aes.expandkey_r2[55:48]^t[23:16]; meta.aes.expandkey_r4[111:104] = meta.aes.expandkey_r2[47:40]^t[15:8]; meta.aes.expandkey_r4[103:96] = meta.aes.expandkey_r2[39:32]^t[7:0]; }
action expand_01_192_r4(){ meta.aes.expandkey_r5[127:120] = meta.aes.expandkey_r3[63:56]^t[31:24]; meta.aes.expandkey_r5[119:112] = meta.aes.expandkey_r3[55:48]^t[23:16]; meta.aes.expandkey_r5[111:104] = meta.aes.expandkey_r3[47:40]^t[15:8]; meta.aes.expandkey_r5[103:96] = meta.aes.expandkey_r3[39:32]^t[7:0]; }
action expand_01_192_r5(){ meta.aes.expandkey_r6[127:120] = meta.aes.expandkey_r4[63:56]^t[31:24]; meta.aes.expandkey_r6[119:112] = meta.aes.expandkey_r4[55:48]^t[23:16]; meta.aes.expandkey_r6[111:104] = meta.aes.expandkey_r4[47:40]^t[15:8]; meta.aes.expandkey_r6[103:96] = meta.aes.expandkey_r4[39:32]^t[7:0]; }
action expand_01_192_r6(){ meta.aes.expandkey_r7[127:120] = meta.aes.expandkey_r5[63:56]^t[31:24]; meta.aes.expandkey_r7[119:112] = meta.aes.expandkey_r5[55:48]^t[23:16]; meta.aes.expandkey_r7[111:104] = meta.aes.expandkey_r5[47:40]^t[15:8]; meta.aes.expandkey_r7[103:96] = meta.aes.expandkey_r5[39:32]^t[7:0]; }
action expand_01_192_r7(){ meta.aes.expandkey_r8[127:120] = meta.aes.expandkey_r6[63:56]^t[31:24]; meta.aes.expandkey_r8[119:112] = meta.aes.expandkey_r6[55:48]^t[23:16]; meta.aes.expandkey_r8[111:104] = meta.aes.expandkey_r6[47:40]^t[15:8]; meta.aes.expandkey_r8[103:96] = meta.aes.expandkey_r6[39:32]^t[7:0]; }
action expand_01_192_r8(){ meta.aes.expandkey_r9[127:120] = meta.aes.expandkey_r7[63:56]^t[31:24]; meta.aes.expandkey_r9[119:112] = meta.aes.expandkey_r7[55:48]^t[23:16]; meta.aes.expandkey_r9[111:104] = meta.aes.expandkey_r7[47:40]^t[15:8]; meta.aes.expandkey_r9[103:96] = meta.aes.expandkey_r7[39:32]^t[7:0]; }
action expand_01_192_r9(){ meta.aes.expandkey_r10[127:120] = meta.aes.expandkey_r8[63:56]^t[31:24]; meta.aes.expandkey_r10[119:112] = meta.aes.expandkey_r8[55:48]^t[23:16]; meta.aes.expandkey_r10[111:104] = meta.aes.expandkey_r8[47:40]^t[15:8]; meta.aes.expandkey_r10[103:96] = meta.aes.expandkey_r8[39:32]^t[7:0]; }
action expand_01_192_r10(){ meta.aes.expandkey_r11[127:120] = meta.aes.expandkey_r9[63:56]^t[31:24]; meta.aes.expandkey_r11[119:112] = meta.aes.expandkey_r9[55:48]^t[23:16]; meta.aes.expandkey_r11[111:104] = meta.aes.expandkey_r9[47:40]^t[15:8]; meta.aes.expandkey_r11[103:96] = meta.aes.expandkey_r9[39:32]^t[7:0]; }
action expand_01_192_r11(){ meta.aes.expandkey_r12[127:120] = meta.aes.expandkey_r10[63:56]^t[31:24]; meta.aes.expandkey_r12[119:112] = meta.aes.expandkey_r10[55:48]^t[23:16]; meta.aes.expandkey_r12[111:104] = meta.aes.expandkey_r10[47:40]^t[15:8]; meta.aes.expandkey_r12[103:96] = meta.aes.expandkey_r10[39:32]^t[7:0]; }
action expand_01_192_r12(){ meta.aes.expandkey_r13[127:120] = meta.aes.expandkey_r11[63:56]^t[31:24]; meta.aes.expandkey_r13[119:112] = meta.aes.expandkey_r11[55:48]^t[23:16]; meta.aes.expandkey_r13[111:104] = meta.aes.expandkey_r11[47:40]^t[15:8]; meta.aes.expandkey_r13[103:96] = meta.aes.expandkey_r11[39:32]^t[7:0]; }
action expand_01_192_r13(){ meta.aes.expandkey_r14[127:120] = meta.aes.expandkey_r12[63:56]^t[31:24]; meta.aes.expandkey_r14[119:112] = meta.aes.expandkey_r12[55:48]^t[23:16]; meta.aes.expandkey_r14[111:104] = meta.aes.expandkey_r12[47:40]^t[15:8]; meta.aes.expandkey_r14[103:96] = meta.aes.expandkey_r12[39:32]^t[7:0]; }







action expand_01_256_r1(){ meta.aes.expandkey_r2[127:120] = meta.aes.expandkey_r0[127:120]^t[31:24]; meta.aes.expandkey_r2[119:112] = meta.aes.expandkey_r0[119:112]^t[23:16]; meta.aes.expandkey_r2[111:104] = meta.aes.expandkey_r0[111:104]^t[15:8]; meta.aes.expandkey_r2[103:96] = meta.aes.expandkey_r0[103:96]^t[7:0]; }
action expand_01_256_r2(){ meta.aes.expandkey_r3[127:120] = meta.aes.expandkey_r1[127:120]^t[31:24]; meta.aes.expandkey_r3[119:112] = meta.aes.expandkey_r1[119:112]^t[23:16]; meta.aes.expandkey_r3[111:104] = meta.aes.expandkey_r1[111:104]^t[15:8]; meta.aes.expandkey_r3[103:96] = meta.aes.expandkey_r1[103:96]^t[7:0]; }
action expand_01_256_r3(){ meta.aes.expandkey_r4[127:120] = meta.aes.expandkey_r2[127:120]^t[31:24]; meta.aes.expandkey_r4[119:112] = meta.aes.expandkey_r2[119:112]^t[23:16]; meta.aes.expandkey_r4[111:104] = meta.aes.expandkey_r2[111:104]^t[15:8]; meta.aes.expandkey_r4[103:96] = meta.aes.expandkey_r2[103:96]^t[7:0]; }
action expand_01_256_r4(){ meta.aes.expandkey_r5[127:120] = meta.aes.expandkey_r3[127:120]^t[31:24]; meta.aes.expandkey_r5[119:112] = meta.aes.expandkey_r3[119:112]^t[23:16]; meta.aes.expandkey_r5[111:104] = meta.aes.expandkey_r3[111:104]^t[15:8]; meta.aes.expandkey_r5[103:96] = meta.aes.expandkey_r3[103:96]^t[7:0]; }
action expand_01_256_r5(){ meta.aes.expandkey_r6[127:120] = meta.aes.expandkey_r4[127:120]^t[31:24]; meta.aes.expandkey_r6[119:112] = meta.aes.expandkey_r4[119:112]^t[23:16]; meta.aes.expandkey_r6[111:104] = meta.aes.expandkey_r4[111:104]^t[15:8]; meta.aes.expandkey_r6[103:96] = meta.aes.expandkey_r4[103:96]^t[7:0]; }
action expand_01_256_r6(){ meta.aes.expandkey_r7[127:120] = meta.aes.expandkey_r5[127:120]^t[31:24]; meta.aes.expandkey_r7[119:112] = meta.aes.expandkey_r5[119:112]^t[23:16]; meta.aes.expandkey_r7[111:104] = meta.aes.expandkey_r5[111:104]^t[15:8]; meta.aes.expandkey_r7[103:96] = meta.aes.expandkey_r5[103:96]^t[7:0]; }
action expand_01_256_r7(){ meta.aes.expandkey_r8[127:120] = meta.aes.expandkey_r6[127:120]^t[31:24]; meta.aes.expandkey_r8[119:112] = meta.aes.expandkey_r6[119:112]^t[23:16]; meta.aes.expandkey_r8[111:104] = meta.aes.expandkey_r6[111:104]^t[15:8]; meta.aes.expandkey_r8[103:96] = meta.aes.expandkey_r6[103:96]^t[7:0]; }
action expand_01_256_r8(){ meta.aes.expandkey_r9[127:120] = meta.aes.expandkey_r7[127:120]^t[31:24]; meta.aes.expandkey_r9[119:112] = meta.aes.expandkey_r7[119:112]^t[23:16]; meta.aes.expandkey_r9[111:104] = meta.aes.expandkey_r7[111:104]^t[15:8]; meta.aes.expandkey_r9[103:96] = meta.aes.expandkey_r7[103:96]^t[7:0]; }
action expand_01_256_r9(){ meta.aes.expandkey_r10[127:120] = meta.aes.expandkey_r8[127:120]^t[31:24]; meta.aes.expandkey_r10[119:112] = meta.aes.expandkey_r8[119:112]^t[23:16]; meta.aes.expandkey_r10[111:104] = meta.aes.expandkey_r8[111:104]^t[15:8]; meta.aes.expandkey_r10[103:96] = meta.aes.expandkey_r8[103:96]^t[7:0]; }
action expand_01_256_r10(){ meta.aes.expandkey_r11[127:120] = meta.aes.expandkey_r9[127:120]^t[31:24]; meta.aes.expandkey_r11[119:112] = meta.aes.expandkey_r9[119:112]^t[23:16]; meta.aes.expandkey_r11[111:104] = meta.aes.expandkey_r9[111:104]^t[15:8]; meta.aes.expandkey_r11[103:96] = meta.aes.expandkey_r9[103:96]^t[7:0]; }
action expand_01_256_r11(){ meta.aes.expandkey_r12[127:120] = meta.aes.expandkey_r10[127:120]^t[31:24]; meta.aes.expandkey_r12[119:112] = meta.aes.expandkey_r10[119:112]^t[23:16]; meta.aes.expandkey_r12[111:104] = meta.aes.expandkey_r10[111:104]^t[15:8]; meta.aes.expandkey_r12[103:96] = meta.aes.expandkey_r10[103:96]^t[7:0]; }
action expand_01_256_r12(){ meta.aes.expandkey_r13[127:120] = meta.aes.expandkey_r11[127:120]^t[31:24]; meta.aes.expandkey_r13[119:112] = meta.aes.expandkey_r11[119:112]^t[23:16]; meta.aes.expandkey_r13[111:104] = meta.aes.expandkey_r11[111:104]^t[15:8]; meta.aes.expandkey_r13[103:96] = meta.aes.expandkey_r11[103:96]^t[7:0]; }
action expand_01_256_r13(){ meta.aes.expandkey_r14[127:120] = meta.aes.expandkey_r12[127:120]^t[31:24]; meta.aes.expandkey_r14[119:112] = meta.aes.expandkey_r12[119:112]^t[23:16]; meta.aes.expandkey_r14[111:104] = meta.aes.expandkey_r12[111:104]^t[15:8]; meta.aes.expandkey_r14[103:96] = meta.aes.expandkey_r12[103:96]^t[7:0]; }

// apply S-Box substitution on all 4 parts of the 32-bit 



action merge_sbox_to_w0(bit<8> val){ word0=val; }
action merge_sbox_to_w1(bit<8> val){ word1=val; }
action merge_sbox_to_w2(bit<8> val){ word2=val; }
action merge_sbox_to_w3(bit<8> val){ word3=val; }




action merge_sbox_to_t0(bit<8> val){ t[31:24]=val; }
action merge_sbox_to_t1(bit<8> val){ t[23:16]=val; }
action merge_sbox_to_t2(bit<8> val){ t[15:8]=val; }
action merge_sbox_to_t3(bit<8> val){ t[7:0]=val; }

// apply rcon substitution and XOR the output to the first part (leftmost) only







action merge_rcon_to_w0_r0(){ word0=word0^0x01; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r1(){ word0=word0^0x02; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r2(){ word0=word0^0x04; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r3(){ word0=word0^0x08; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r4(){ word0=word0^0x10; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r5(){ word0=word0^0x20; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r6(){ word0=word0^0x40; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r7(){ word0=word0^0x80; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r8(){ word0=word0^0x1b; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r9(){ word0=word0^0x36; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r10(){ word0=word0^0x6c; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r11(){ word0=word0^0xd8; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r12(){ word0=word0^0xab; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
action merge_rcon_to_w0_r13(){ word0=word0^0x4d; t[31:24] = word0; t[23:16] = word1; t[15:8] = word2; t[7:0] = word3; }
# 725 "dh_aes.p4"
table aes_sbox_00_r0 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r0 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r0 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r0 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r0 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r0 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r0 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r0 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r0 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r0 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r0 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r0 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r0 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r0 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r0 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r0 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r0 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r0 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r0 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r0 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r1 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r1 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r1 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r1 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r1 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r1 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r1 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r1 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r1 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r1 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r1 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r1 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r1 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r1 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r1 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r1 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r1 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r1 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r1 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r1 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r2 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r2 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r2 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r2 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r2 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r2 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r2 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r2 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r2 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r2 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r2 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r2 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r2 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r2 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r2 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r2 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r2 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r2 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r2 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r2 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r3 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r3 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r3 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r3 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r3 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r3 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r3 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r3 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r3 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r3 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r3 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r3 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r3 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r3 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r3 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r3 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r3 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r3 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r3 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r3 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r4 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r4 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r4 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r4 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r4 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r4 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r4 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r4 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r4 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r4 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r4 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r4 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r4 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r4 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r4 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r4 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r4 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r4 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r4 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r4 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r5 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r5 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r5 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r5 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r5 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r5 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r5 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r5 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r5 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r5 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r5 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r5 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r5 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r5 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r5 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r5 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r5 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r5 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r5 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r5 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r6 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r6 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r6 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r6 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r6 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r6 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r6 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r6 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r6 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r6 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r6 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r6 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r6 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r6 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r6 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r6 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r6 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r6 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r6 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r6 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r7 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r7 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r7 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r7 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r7 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r7 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r7 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r7 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r7 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r7 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r7 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r7 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r7 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r7 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r7 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r7 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r7 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r7 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r7 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r7 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r8 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r8 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r8 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r8 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r8 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r8 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r8 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r8 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r8 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r8 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r8 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r8 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r8 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r8 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r8 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r8 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r8 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r8 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r8 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r8 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r9 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r9 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r9 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r9 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r9 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r9 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r9 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r9 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r9 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r9 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r9 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r9 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r9 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r9 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r9 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r9 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r9 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r9 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r9 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r9 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r10 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r10 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r10 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r10 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r10 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r10 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r10 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r10 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r10 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r10 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r10 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r10 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r10 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r10 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r10 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r10 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r10 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r10 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r10 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r10 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }
table aes_sbox_00_r11 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_01_r11 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_02_r11 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_03_r11 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_10_r11 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r11 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r11 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r11 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r11 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r11 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r11 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r11 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r11 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r11 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r11 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r11 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r11 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r11 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r11 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r11 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }






table aes_sbox_10_r12 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_11_r12 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_12_r12 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_13_r12 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_20_r12 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_21_r12 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_22_r12 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_23_r12 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_30_r12 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_31_r12 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_32_r12 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_33_r12 { key = {word3:exact;} actions = {merge_sbox_to_w3;} } table aes_sbox_40_r12 { key = {word0:exact;} actions = {merge_sbox_to_w0;} } table aes_sbox_41_r12 { key = {word1:exact;} actions = {merge_sbox_to_w1;} } table aes_sbox_42_r12 { key = {word2:exact;} actions = {merge_sbox_to_w2;} } table aes_sbox_43_r12 { key = {word3:exact;} actions = {merge_sbox_to_w3;} }


table aes_sbox_50_r0 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r0 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r0 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r0 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }
table aes_sbox_50_r1 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r1 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r1 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r1 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }
table aes_sbox_50_r2 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r2 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r2 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r2 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }
table aes_sbox_50_r3 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r3 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r3 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r3 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }
table aes_sbox_50_r4 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r4 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r4 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r4 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }
table aes_sbox_50_r5 { key = {t[31:24]:exact;} actions = {merge_sbox_to_t0;} } table aes_sbox_51_r5 { key = {t[23:16]:exact;} actions = {merge_sbox_to_t1;} } table aes_sbox_52_r5 { key = {t[15:8]:exact;} actions = {merge_sbox_to_t2;} } table aes_sbox_53_r5 { key = {t[7:0]:exact;} actions = {merge_sbox_to_t3;} }





table aes_sbox_lut_exp_00_r0 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r0 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r0 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r0 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r0 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r0 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r0 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r0 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r0 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r0 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r0 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r0 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r0 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r0 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r0 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r0 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r1 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r1 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r1 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r1 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r1 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r1 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r1 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r1 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r1 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r1 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r1 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r1 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r1 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r1 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r1 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r1 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r2 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r2 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r2 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r2 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r2 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r2 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r2 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r2 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r2 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r2 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r2 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r2 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r2 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r2 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r2 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r2 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r3 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r3 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r3 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r3 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r3 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r3 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r3 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r3 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r3 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r3 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r3 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r3 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r3 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r3 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r3 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r3 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r4 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r4 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r4 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r4 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r4 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r4 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r4 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r4 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r4 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r4 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r4 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r4 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r4 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r4 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r4 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r4 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r5 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r5 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r5 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r5 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r5 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r5 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r5 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r5 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r5 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r5 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r5 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r5 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r5 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r5 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r5 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r5 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r6 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r6 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r6 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r6 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r6 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r6 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r6 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r6 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r6 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r6 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r6 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r6 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r6 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r6 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r6 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r6 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r7 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r7 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r7 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r7 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r7 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r7 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r7 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r7 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r7 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r7 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r7 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r7 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r7 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r7 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r7 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r7 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r8 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r8 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r8 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r8 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r8 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r8 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r8 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r8 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r8 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r8 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r8 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r8 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r8 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r8 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r8 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r8 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r9 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r9 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r9 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r9 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r9 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r9 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r9 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r9 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r9 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r9 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r9 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r9 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r9 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r9 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r9 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r9 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r10 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r10 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r10 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r10 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r10 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r10 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r10 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r10 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r10 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r10 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r10 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r10 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r10 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r10 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r10 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r10 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r11 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r11 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r11 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r11 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r11 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r11 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r11 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r11 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r11 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r11 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r11 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r11 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r11 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r11 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r11 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r11 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }
table aes_sbox_lut_exp_00_r12 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_01_r12 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_02_r12 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_03_r12 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_10_r12 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_11_r12 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_12_r12 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_13_r12 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_20_r12 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_21_r12 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_22_r12 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_23_r12 { key = {word3:exact;} actions = {merge_inv_to_ti3;} } table aes_sbox_lut_exp_30_r12 { key = {word0:exact;} actions = {merge_inv_to_ti0;} } table aes_sbox_lut_exp_31_r12 { key = {word1:exact;} actions = {merge_inv_to_ti1;} } table aes_sbox_lut_exp_32_r12 { key = {word2:exact;} actions = {merge_inv_to_ti2;} } table aes_sbox_lut_exp_33_r12 { key = {word3:exact;} actions = {merge_inv_to_ti3;} }

    action breakMsg() {
        standard_metadata.egress_spec = 99;
    }

    //action return_msg(){
    //     standard_metadata.egress_spec = standard_metadata.ingress_port;
    //}

    action reflect() {
        //set the src mac address as the previous dst, this is not correct right?
        hdr.ethernet.srcAddr = 0x999999999999;
        //set the destination mac address that we got from the match in the table
        hdr.ethernet.dstAddr = 0xFFFFFFFFFFFF;
        //set the output port that we also get from the table
        standard_metadata.egress_spec = standard_metadata.ingress_port;
    }

    action l2_fwd() {
        macAddr_t srcAddr;
        srcAddr = hdr.ethernet.srcAddr;
        standard_metadata.egress_spec = standard_metadata.ingress_port;
        hdr.ethernet.srcAddr = hdr.ethernet.dstAddr;
        hdr.ethernet.dstAddr = srcAddr;
        //hdr.ipv4.ttl = hdr.ipv4.ttl - 1;
    }

    action dh_l2_fwd() {
        hdr.aes_inout.setInvalid();
        hdr.dh_probe[0].setValid();
    }

    action aes_l2_fwd() {
        hdr.aes_inout.setValid();
        hdr.dh_probe[0].setInvalid();
    }

    // Compute DH
    action compute_secret_dh_ph1() {
        keys_t A;
        register_priv_keys.read(A, 0);

        register_secret_keys.write(0, (hdr.dh_probe[0].public_key & A) ^ 0x662c467db14696545ae1a8dd0a00f25d608bd3021de9cd56f79f1ca6d9b4047d);
    }

    // Compute DH
    action compute_secret_dh_ph2() {
        keys_t A;
        register_priv_keys.read(A, 0);

        keys_t Ka;
        register_pub_keys.read(Ka, 0);
        register_secret_keys.write(0, (Ka & A) ^ 0x662c467db14696545ae1a8dd0a00f25d608bd3021de9cd56f79f1ca6d9b4047d);
    }

    // Write the pub key into the header
    action write_pubKey() {
        hdr.dh_probe[0].public_key = meta.dh[0].pu;
        //hdr.dh_probe[0].setValid();
    }

    action _drop() {
        mark_to_drop(standard_metadata);
    }

    // Read clear/ciphered text into the payload
    action read_payload(){
        meta.aes.t0 = hdr.aes_inout.value[127:96];
        meta.aes.t1 = hdr.aes_inout.value[95:64];
        meta.aes.t2 = hdr.aes_inout.value[63:32];
        meta.aes.t3 = hdr.aes_inout.value[31:0];
    }

    // Write clear/ciphered text into the payload
    action write_payload(){
        hdr.aes_inout.value[127:96] = meta.aes.r0;
        hdr.aes_inout.value[95:64] = meta.aes.r1;
        hdr.aes_inout.value[63:32] = meta.aes.r2;
        hdr.aes_inout.value[31:0] = meta.aes.r3;
    }

    // Meta xored with the expanded key
    action mask_key(bit<128> key128){
        meta.aes.r0 = meta.aes.t0^key128[127:96];
        meta.aes.r1 = meta.aes.t1^key128[95:64];
        meta.aes.r2 = meta.aes.t2^key128[63:32];
        meta.aes.r3 = meta.aes.t3^key128[31:0];
    }

    action new_round() {
        // Could be skipped, if we use better renaming and read key first.
        // We do this for the sake of code tidyness. More efficient implementation
        // possible, using fewer hardware stages.
        meta.aes.t0=0; meta.aes.t1=0; meta.aes.t2=0; meta.aes.t3=0;
    }

    action set_egress_spec(bit<9> port) {
        standard_metadata.egress_spec = port;
    }

    action set_encrypt(bit<9> port, bit<256> key_256) {
        standard_metadata.egress_spec = port;
        encryptKey256 = key_256;
    }

    action set_flag(bit<9> port, bit<2> flags, bit<2> size) {
        standard_metadata.egress_spec = port;
        flag = flags;
        keysize = size;
    }

    action set_decrypt(bit<9> port, bit<256> key_256) {
        standard_metadata.egress_spec = port;
        decryptKey256 = key_256;
    }

    action set_aes_key(bit<256> key_256) {
        meta.aes.expandkey_r0 = key_256[255:128];
        meta.aes.expandkey_r1 = key_256[127:0];
        meta.aes.inv_expandkey_r0 = key_256[255:128];
    }

    table forward {
        key = {
            standard_metadata.ingress_port: exact;
            hdr.ethernet.etherType: exact;
        }
        actions = {
            set_egress_spec;
            set_encrypt;
            set_decrypt;
            set_flag;
            NoAction;
        }
        size = 1024;
        default_action = NoAction();
    }

// Macros for defining actions, XOR value from LUT to accummulator variable



action unmerge_to_t0(bit<32> val){ meta.aes.t0=meta.aes.t0^val; }
action unmerge_to_t1(bit<32> val){ meta.aes.t1=meta.aes.t1^val; }
action unmerge_to_t2(bit<32> val){ meta.aes.t2=meta.aes.t2^val; }
action unmerge_to_t3(bit<32> val){ meta.aes.t3=meta.aes.t3^val; }

// XOR value from LUT to a slice of accummulator variable



action unmerge_to_t0_slice0(bit<8> val){ meta.aes.t0[31:24]=meta.aes.t0[31:24]^val; }
action unmerge_to_t0_slice1(bit<8> val){ meta.aes.t0[23:16]=meta.aes.t0[23:16]^val; }
action unmerge_to_t0_slice2(bit<8> val){ meta.aes.t0[15: 8]=meta.aes.t0[15: 8]^val; }
action unmerge_to_t0_slice3(bit<8> val){ meta.aes.t0[ 7: 0]=meta.aes.t0[ 7: 0]^val; }
action unmerge_to_t1_slice0(bit<8> val){ meta.aes.t1[31:24]=meta.aes.t1[31:24]^val; }
action unmerge_to_t1_slice1(bit<8> val){ meta.aes.t1[23:16]=meta.aes.t1[23:16]^val; }
action unmerge_to_t1_slice2(bit<8> val){ meta.aes.t1[15: 8]=meta.aes.t1[15: 8]^val; }
action unmerge_to_t1_slice3(bit<8> val){ meta.aes.t1[ 7: 0]=meta.aes.t1[ 7: 0]^val; }
action unmerge_to_t2_slice0(bit<8> val){ meta.aes.t2[31:24]=meta.aes.t2[31:24]^val; }
action unmerge_to_t2_slice1(bit<8> val){ meta.aes.t2[23:16]=meta.aes.t2[23:16]^val; }
action unmerge_to_t2_slice2(bit<8> val){ meta.aes.t2[15: 8]=meta.aes.t2[15: 8]^val; }
action unmerge_to_t2_slice3(bit<8> val){ meta.aes.t2[ 7: 0]=meta.aes.t2[ 7: 0]^val; }
action unmerge_to_t3_slice0(bit<8> val){ meta.aes.t3[31:24]=meta.aes.t3[31:24]^val; }
action unmerge_to_t3_slice1(bit<8> val){ meta.aes.t3[23:16]=meta.aes.t3[23:16]^val; }
action unmerge_to_t3_slice2(bit<8> val){ meta.aes.t3[15: 8]=meta.aes.t3[15: 8]^val; }
action unmerge_to_t3_slice3(bit<8> val){ meta.aes.t3[ 7: 0]=meta.aes.t3[ 7: 0]^val; }

// Macros for defining actions, XOR value from LUT to accummulator variable



action merge_to_t0(bit<32> val){ meta.aes.t0=meta.aes.t0^val; }
action merge_to_t1(bit<32> val){ meta.aes.t1=meta.aes.t1^val; }
action merge_to_t2(bit<32> val){ meta.aes.t2=meta.aes.t2^val; }
action merge_to_t3(bit<32> val){ meta.aes.t3=meta.aes.t3^val; }

// XOR value from LUT to a slice of accummulator variable



action merge_to_t0_slice0(bit<8> val){ meta.aes.t0[31:24]=meta.aes.t0[31:24]^val; }
action merge_to_t0_slice1(bit<8> val){ meta.aes.t0[23:16]=meta.aes.t0[23:16]^val; }
action merge_to_t0_slice2(bit<8> val){ meta.aes.t0[15: 8]=meta.aes.t0[15: 8]^val; }
action merge_to_t0_slice3(bit<8> val){ meta.aes.t0[ 7: 0]=meta.aes.t0[ 7: 0]^val; }
action merge_to_t1_slice0(bit<8> val){ meta.aes.t1[31:24]=meta.aes.t1[31:24]^val; }
action merge_to_t1_slice1(bit<8> val){ meta.aes.t1[23:16]=meta.aes.t1[23:16]^val; }
action merge_to_t1_slice2(bit<8> val){ meta.aes.t1[15: 8]=meta.aes.t1[15: 8]^val; }
action merge_to_t1_slice3(bit<8> val){ meta.aes.t1[ 7: 0]=meta.aes.t1[ 7: 0]^val; }
action merge_to_t2_slice0(bit<8> val){ meta.aes.t2[31:24]=meta.aes.t2[31:24]^val; }
action merge_to_t2_slice1(bit<8> val){ meta.aes.t2[23:16]=meta.aes.t2[23:16]^val; }
action merge_to_t2_slice2(bit<8> val){ meta.aes.t2[15: 8]=meta.aes.t2[15: 8]^val; }
action merge_to_t2_slice3(bit<8> val){ meta.aes.t2[ 7: 0]=meta.aes.t2[ 7: 0]^val; }
action merge_to_t3_slice0(bit<8> val){ meta.aes.t3[31:24]=meta.aes.t3[31:24]^val; }
action merge_to_t3_slice1(bit<8> val){ meta.aes.t3[23:16]=meta.aes.t3[23:16]^val; }
action merge_to_t3_slice2(bit<8> val){ meta.aes.t3[15: 8]=meta.aes.t3[15: 8]^val; }
action merge_to_t3_slice3(bit<8> val){ meta.aes.t3[ 7: 0]=meta.aes.t3[ 7: 0]^val; }


// Macros for defining lookup tables, which is match-action table that XOR the value into accumulator variable
# 996 "dh_aes.p4"
// We need one copy of all tables for each round. Otherwise, there's dependency issue...




table aes_invsbox_lut_00_r13 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r13 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r13 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r13 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r13 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r13 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r13 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r13 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r13 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r13 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r13 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r13 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r13 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r13 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r13 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r13 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r12 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r12 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r12 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r12 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r12 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r12 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r12 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r12 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r12 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r12 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r12 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r12 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r12 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r12 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r12 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r12 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r11 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r11 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r11 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r11 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r11 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r11 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r11 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r11 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r11 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r11 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r11 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r11 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r11 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r11 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r11 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r11 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r10 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r10 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r10 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r10 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r10 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r10 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r10 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r10 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r10 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r10 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r10 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r10 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r10 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r10 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r10 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r10 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r9 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r9 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r9 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r9 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r9 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r9 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r9 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r9 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r9 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r9 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r9 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r9 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r9 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r9 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r9 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r9 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r8 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r8 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r8 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r8 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r8 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r8 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r8 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r8 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r8 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r8 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r8 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r8 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r8 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r8 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r8 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r8 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r7 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r7 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r7 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r7 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r7 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r7 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r7 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r7 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r7 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r7 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r7 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r7 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r7 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r7 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r7 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r7 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r6 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r6 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r6 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r6 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r6 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r6 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r6 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r6 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r6 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r6 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r6 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r6 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r6 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r6 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r6 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r6 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r5 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r5 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r5 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r5 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r5 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r5 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r5 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r5 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r5 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r5 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r5 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r5 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r5 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r5 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r5 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r5 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r4 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r4 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r4 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r4 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r4 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r4 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r4 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r4 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r4 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r4 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r4 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r4 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r4 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r4 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r4 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r4 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r3 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r3 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r3 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r3 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r3 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r3 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r3 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r3 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r3 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r3 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r3 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r3 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r3 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r3 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r3 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r3 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r2 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r2 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r2 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r2 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r2 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r2 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r2 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r2 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r2 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r2 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r2 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r2 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r2 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r2 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r2 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r2 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }
table aes_invsbox_lut_00_r1 { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_01_r1 { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_02_r1 { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_03_r1 { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0;} } table aes_invsbox_lut_10_r1 { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_11_r1 { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_12_r1 { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_13_r1 { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1;} } table aes_invsbox_lut_20_r1 { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_21_r1 { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_22_r1 { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_23_r1 { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2;} } table aes_invsbox_lut_30_r1 { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_31_r1 { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_32_r1 { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3;} } table aes_invsbox_lut_33_r1 { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3;} }

// Only round 1-9 requires mixcolumns. round 10 is different:
// LAST round is special, use SBOX directly as LUT

table aes_invsbox_lut_00_rLAST { key = {meta.aes.r0[31:24]:exact;} actions = {unmerge_to_t0_slice0;} }
table aes_invsbox_lut_01_rLAST { key = {meta.aes.r3[23:16]:exact;} actions = {unmerge_to_t0_slice1;} }
table aes_invsbox_lut_02_rLAST { key = {meta.aes.r2[15: 8]:exact;} actions = {unmerge_to_t0_slice2;} }
table aes_invsbox_lut_03_rLAST { key = {meta.aes.r1[7 : 0]:exact;} actions = {unmerge_to_t0_slice3;} }

table aes_invsbox_lut_10_rLAST { key = {meta.aes.r1[31:24]:exact;} actions = {unmerge_to_t1_slice0;} }
table aes_invsbox_lut_11_rLAST { key = {meta.aes.r0[23:16]:exact;} actions = {unmerge_to_t1_slice1;} }
table aes_invsbox_lut_12_rLAST { key = {meta.aes.r3[15: 8]:exact;} actions = {unmerge_to_t1_slice2;} }
table aes_invsbox_lut_13_rLAST { key = {meta.aes.r2[7 : 0]:exact;} actions = {unmerge_to_t1_slice3;} }

table aes_invsbox_lut_20_rLAST { key = {meta.aes.r2[31:24]:exact;} actions = {unmerge_to_t2_slice0;} }
table aes_invsbox_lut_21_rLAST { key = {meta.aes.r1[23:16]:exact;} actions = {unmerge_to_t2_slice1;} }
table aes_invsbox_lut_22_rLAST { key = {meta.aes.r0[15: 8]:exact;} actions = {unmerge_to_t2_slice2;} }
table aes_invsbox_lut_23_rLAST { key = {meta.aes.r3[7 : 0]:exact;} actions = {unmerge_to_t2_slice3;} }

table aes_invsbox_lut_30_rLAST { key = {meta.aes.r3[31:24]:exact;} actions = {unmerge_to_t3_slice0;} }
table aes_invsbox_lut_31_rLAST { key = {meta.aes.r2[23:16]:exact;} actions = {unmerge_to_t3_slice1;} }
table aes_invsbox_lut_32_rLAST { key = {meta.aes.r1[15: 8]:exact;} actions = {unmerge_to_t3_slice2;} }
table aes_invsbox_lut_33_rLAST { key = {meta.aes.r0[7 : 0]:exact;} actions = {unmerge_to_t3_slice3;} }
# 1045 "dh_aes.p4"
// Macros for defining lookup tables, which is match-action table that XOR the value into accumulator variable
# 1071 "dh_aes.p4"
// We need one copy of all tables for each round. Otherwise, there's dependency issue...




table aes_sbox_lut_00_r1 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r1 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r1 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r1 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r1 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r1 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r1 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r1 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r1 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r1 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r1 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r1 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r1 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r1 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r1 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r1 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r2 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r2 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r2 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r2 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r2 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r2 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r2 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r2 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r2 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r2 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r2 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r2 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r2 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r2 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r2 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r2 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r3 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r3 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r3 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r3 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r3 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r3 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r3 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r3 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r3 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r3 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r3 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r3 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r3 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r3 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r3 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r3 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r4 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r4 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r4 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r4 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r4 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r4 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r4 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r4 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r4 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r4 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r4 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r4 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r4 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r4 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r4 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r4 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r5 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r5 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r5 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r5 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r5 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r5 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r5 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r5 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r5 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r5 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r5 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r5 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r5 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r5 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r5 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r5 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r6 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r6 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r6 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r6 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r6 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r6 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r6 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r6 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r6 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r6 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r6 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r6 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r6 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r6 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r6 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r6 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r7 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r7 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r7 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r7 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r7 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r7 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r7 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r7 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r7 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r7 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r7 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r7 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r7 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r7 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r7 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r7 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r8 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r8 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r8 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r8 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r8 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r8 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r8 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r8 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r8 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r8 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r8 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r8 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r8 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r8 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r8 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r8 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r9 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r9 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r9 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r9 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r9 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r9 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r9 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r9 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r9 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r9 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r9 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r9 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r9 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r9 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r9 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r9 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r10 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r10 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r10 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r10 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r10 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r10 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r10 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r10 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r10 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r10 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r10 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r10 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r10 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r10 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r10 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r10 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r11 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r11 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r11 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r11 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r11 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r11 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r11 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r11 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r11 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r11 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r11 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r11 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r11 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r11 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r11 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r11 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r12 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r12 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r12 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r12 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r12 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r12 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r12 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r12 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r12 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r12 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r12 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r12 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r12 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r12 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r12 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r12 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }
table aes_sbox_lut_00_r13 { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_01_r13 { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_02_r13 { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_03_r13 { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0;} } table aes_sbox_lut_10_r13 { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_11_r13 { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_12_r13 { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_13_r13 { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1;} } table aes_sbox_lut_20_r13 { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_21_r13 { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_22_r13 { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_23_r13 { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2;} } table aes_sbox_lut_30_r13 { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_31_r13 { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_32_r13 { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3;} } table aes_sbox_lut_33_r13 { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3;} }


//Only round 1-9 requires mixcolumns. round 10 is different:
// LAST round is special, use SBOX directly as LUT
table aes_sbox_lut_00_rLAST { key= {meta.aes.r0[31:24]:exact;} actions = {merge_to_t0_slice0;} }
table aes_sbox_lut_01_rLAST { key= {meta.aes.r1[23:16]:exact;} actions = {merge_to_t0_slice1;} }
table aes_sbox_lut_02_rLAST { key= {meta.aes.r2[15: 8]:exact;} actions = {merge_to_t0_slice2;} }
table aes_sbox_lut_03_rLAST { key= {meta.aes.r3[7 : 0]:exact;} actions = {merge_to_t0_slice3;} }

table aes_sbox_lut_10_rLAST { key= {meta.aes.r1[31:24]:exact;} actions = {merge_to_t1_slice0;} }
table aes_sbox_lut_11_rLAST { key= {meta.aes.r2[23:16]:exact;} actions = {merge_to_t1_slice1;} }
table aes_sbox_lut_12_rLAST { key= {meta.aes.r3[15: 8]:exact;} actions = {merge_to_t1_slice2;} }
table aes_sbox_lut_13_rLAST { key= {meta.aes.r0[7 : 0]:exact;} actions = {merge_to_t1_slice3;} }

table aes_sbox_lut_20_rLAST { key= {meta.aes.r2[31:24]:exact;} actions = {merge_to_t2_slice0;} }
table aes_sbox_lut_21_rLAST { key= {meta.aes.r3[23:16]:exact;} actions = {merge_to_t2_slice1;} }
table aes_sbox_lut_22_rLAST { key= {meta.aes.r0[15: 8]:exact;} actions = {merge_to_t2_slice2;} }
table aes_sbox_lut_23_rLAST { key= {meta.aes.r1[7 : 0]:exact;} actions = {merge_to_t2_slice3;} }

table aes_sbox_lut_30_rLAST { key= {meta.aes.r3[31:24]:exact;} actions = {merge_to_t3_slice0;} }
table aes_sbox_lut_31_rLAST { key= {meta.aes.r0[23:16]:exact;} actions = {merge_to_t3_slice1;} }
table aes_sbox_lut_32_rLAST { key= {meta.aes.r1[15: 8]:exact;} actions = {merge_to_t3_slice2;} }
table aes_sbox_lut_33_rLAST { key= {meta.aes.r2[7 : 0]:exact;} actions = {merge_to_t3_slice3;} }
# 1122 "dh_aes.p4"
// Expanded Key





// Inv Expanded Key






    apply {
        // Init variables
        encryptKey256 = 0x00000000000000000000000000000000000000000000000000000000000000 ; // default
        decryptKey256 = 0x00000000000000000000000000000000000000000000000000000000000000 ; // default
        flag = 0x1; // default
        t = 0x00000000;
        keysize = 0x0; // default
        t_par0 = 0x00000000;
        t_par1 = 0x00000000;
        t_par2 = 0x00000000;
        t_par3 = 0x00000000;
        word0 = 0x00;
        word1 = 0x00;
        word2 = 0x00;
        word3 = 0x00;
        t0_inv = 0x00000000;
        t1_inv = 0x00000000;
        t2_inv = 0x00000000;
        t3_inv = 0x00000000;
        ti0 = 0x00000000;
        ti1 = 0x00000000;
        ti2 = 0x00000000;
        ti3 = 0x00000000;

        if (forward.apply().hit) {
            if (hdr.ethernet.etherType == 0x812) {
                keys_t last_key;
                last_key = 0x0;
                register_pub_keys.read(last_key, 0);

                if (hdr.dh_probe[0].public_key == 0x00 && hdr.dh_probe[0].flag == 0x00){
                    bit<256> A;
                    privateKey = encryptKey256;

                    // First step to compute the private and public keys
                    if (privateKey == 0x00){
                        bit<64> R1;
                        bit<64> R2;
                        bit<64> R3;
                        bit<64> R4;
                        random(R1, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                        random(R2, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                        random(R3, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                        random(R4, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                        A = R1 ++ R2 ++ R3 ++ R4;
                    }
                    else{
                        A = privateKey;
                    }

                    bit<256> Ka = ((2^0x662c467db14696545ae1a8dd0a00f25d608bd3021de9cd56f79f1ca6d9b4047d)&A);
                    meta.dh[0].pu = Ka;

                    register_pub_keys.write(0, Ka);
                    register_priv_keys.write(0, A);

                    // Assuming that 99:99:99:99:99:99 is the mac addr of a switch
                    if (hdr.ethernet.srcAddr != 0x999999999999){
                        hdr.ethernet.srcAddr = 0x999999999999;
                    }
                    else{
                        keys_t last_pub_key;
                        last_pub_key = 0x0;
                        register_pub_keys.read(last_pub_key, 0);
                        if (last_pub_key == 0x0){
                            register_pub_keys.write(0, hdr.dh_probe[0].public_key);
                        }
                    }
                    write_pubKey();
                    dh_l2_fwd();
                }
                else{
                    if (hdr.ethernet.srcAddr == 0x999999999999 && hdr.dh_probe[0].flag == 0x00){

                        bit<256> B;
                        privateKey = decryptKey256;

                        if (privateKey == 0x00){
                            bit<64> R1;
                            bit<64> R2;
                            bit<64> R3;
                            bit<64> R4;
                            random(R1, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                            random(R2, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                            random(R3, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                            random(R4, 0x0000000000000000, 0XFFFFFFFFFFFFFFFF);
                            B = R1 ++ R2 ++ R3 ++ R4;
                        }
                        else{
                            B = privateKey;
                        }

                        bit<256> Kb = ((2^0x662c467db14696545ae1a8dd0a00f25d608bd3021de9cd56f79f1ca6d9b4047d)&B);
                        meta.dh[0].pu = Kb;

                        register_pub_keys.write(0, hdr.dh_probe[0].public_key);
                        register_priv_keys.write(0, B);

                        hdr.dh_probe[0].flag = 0x01;
                        reflect();

                        write_pubKey();
                        dh_l2_fwd();
                    }
                    else if (hdr.ethernet.srcAddr == 0x999999999999 && hdr.dh_probe[0].flag == 0x01){
                        compute_secret_dh_ph1();

                        // Payload can be empty - public_key has already received
                        hdr.dh_probe[0].public_key = 0x00;
                        hdr.dh_probe[0].flag = 0x02;
                        reflect();

                        // This avoids the msg to reach the controller
                        //return_msg();
                    }

                    else if (hdr.ethernet.srcAddr == 0x999999999999 && hdr.dh_probe[0].flag == 0x02){
                        compute_secret_dh_ph2();
                        breakMsg();
                    }
                }
            }
            else if (hdr.ethernet.etherType == 0x9999) {
                bit<256> get_key;
                register_secret_keys.read(get_key, 0);

                // Store the 256 key, but can be used the 128 or 192 bits if needed
                secretKey256 = get_key;

                // To be use for the encrypt and decrypt process
                secretKey128 = get_key[255:128];

                // Set Key for wexpand process
                // This will set the key R0 and R1 depending the size
                set_aes_key(secretKey256);

                // Expand Key
                // keysize 0x0 -> Key 128bits
                // keysize 0x1 -> Key 192bits
                // keysize 0x2 -> Key 256bits
                // Key encrypt R1
                if (keysize == 0x0){expand_set_t_01_r0();}
                if (keysize == 0x1){expand_set_t_02_r0();}
                if (keysize == 0x0 || keysize == 0x1){aes_sbox_00_r0.apply(); aes_sbox_01_r0.apply(); aes_sbox_02_r0.apply(); aes_sbox_03_r0.apply();;merge_rcon_to_w0_r0();}
                if (keysize == 0x0){expand_01_r0();expand_02_r0();expand_set_t_02_r0();expand_03_r0();}
                if (keysize == 0x1){expand_03_192_r0();}

                // Key encrypt R2
                expand_set_t_01_r1();
                if (keysize == 0x0 || keysize == 0x2){aes_sbox_00_r1.apply(); aes_sbox_01_r1.apply(); aes_sbox_02_r1.apply(); aes_sbox_03_r1.apply();;}
                if (keysize == 0x0){merge_rcon_to_w0_r1();expand_01_r1();expand_02_r1();expand_set_t_02_r1();expand_03_r1();}
                if (keysize == 0x1){expand_01_192_r1();expand_02_192_r1();expand_set_t_02_r1();expand_03_192_r1();}
                if (keysize == 0x2){merge_rcon_to_w0_r0();expand_01_256_r1();expand_02_256_r1();expand_set_t_02_r1();expand_03_256_r1();}

                // Key encrypt R3
                expand_set_t_01_r2();
                if (keysize == 0x0 || keysize == 0x1){aes_sbox_00_r2.apply(); aes_sbox_01_r2.apply(); aes_sbox_02_r2.apply(); aes_sbox_03_r2.apply();;}
                if (keysize == 0x0){merge_rcon_to_w0_r2();expand_01_r2();expand_02_r2();expand_set_t_02_r2();expand_03_r2();}
                if (keysize == 0x1){merge_rcon_to_w0_r1();expand_01_192_r2();expand_02_192_r2();expand_set_t_02_r2();expand_03_192_r2();}
                if (keysize == 0x2){aes_sbox_50_r0.apply(); aes_sbox_51_r0.apply(); aes_sbox_52_r0.apply(); aes_sbox_53_r0.apply();;expand_01_256_r2();expand_02_256_r2();expand_set_t_02_r2();expand_03_256_r2();}

                // Key encrypt R4
                expand_set_t_01_r3();
                if (keysize == 0x1){expand_01_192_r3();expand_02_192_r3();expand_set_t_02_r3();}
                aes_sbox_00_r3.apply(); aes_sbox_01_r3.apply(); aes_sbox_02_r3.apply(); aes_sbox_03_r3.apply();;
                if (keysize == 0x0){merge_rcon_to_w0_r3();expand_01_r3();expand_02_r3();expand_set_t_02_r3();expand_03_r3();}
                if (keysize == 0x2){merge_rcon_to_w0_r1();expand_01_256_r3();expand_02_256_r3();expand_set_t_02_r3();expand_03_256_r3();}
                if (keysize == 0x1){merge_rcon_to_w0_r2();expand_03_192_r3();}

                // Key encrypt R5
                expand_set_t_01_r4();
                if (keysize == 0x0){aes_sbox_00_r4.apply(); aes_sbox_01_r4.apply(); aes_sbox_02_r4.apply(); aes_sbox_03_r4.apply();;merge_rcon_to_w0_r4();expand_01_r4();expand_02_r4();expand_set_t_02_r4();expand_03_r4();}
                if (keysize == 0x1){expand_01_192_r4();expand_02_192_r4();expand_set_t_02_r4();expand_03_192_r4();}
                if (keysize == 0x2){aes_sbox_50_r1.apply(); aes_sbox_51_r1.apply(); aes_sbox_52_r1.apply(); aes_sbox_53_r1.apply();;expand_01_256_r4();expand_02_256_r4();expand_set_t_02_r4();expand_03_256_r4();}

                // Key encrypt R6
                expand_set_t_01_r5();aes_sbox_00_r5.apply(); aes_sbox_01_r5.apply(); aes_sbox_02_r5.apply(); aes_sbox_03_r5.apply();;
                if (keysize == 0x0){merge_rcon_to_w0_r5();expand_01_r5();expand_02_r5();expand_set_t_02_r5();expand_03_r5();}
                if (keysize == 0x1){merge_rcon_to_w0_r3();expand_01_192_r5();expand_02_192_r5();expand_set_t_02_r5();expand_03_192_r5();}
                if (keysize == 0x2){merge_rcon_to_w0_r2();expand_01_256_r5();expand_02_256_r5();expand_set_t_02_r5();expand_03_256_r5();}

                // Key encrypt R7
                expand_set_t_01_r6();
                if (keysize == 0x1){expand_01_192_r6();expand_02_192_r6();expand_set_t_02_r6();}
                if (keysize == 0x0 || keysize == 0x1){aes_sbox_00_r6.apply(); aes_sbox_01_r6.apply(); aes_sbox_02_r6.apply(); aes_sbox_03_r6.apply();;}
                if (keysize == 0x0){merge_rcon_to_w0_r6();expand_01_r6();expand_02_r6();expand_set_t_02_r6();expand_03_r6();}
                if (keysize == 0x1){merge_rcon_to_w0_r4();expand_03_192_r6();}
                if (keysize == 0x2){aes_sbox_50_r2.apply(); aes_sbox_51_r2.apply(); aes_sbox_52_r2.apply(); aes_sbox_53_r2.apply();;expand_01_256_r6();expand_02_256_r6();expand_set_t_02_r6();expand_03_256_r6();}

                // Key encrypt R8
                expand_set_t_01_r7();
                if (keysize == 0x0 || keysize == 0x2){aes_sbox_00_r7.apply(); aes_sbox_01_r7.apply(); aes_sbox_02_r7.apply(); aes_sbox_03_r7.apply();;}
                if (keysize == 0x0){merge_rcon_to_w0_r7();expand_01_r7();expand_02_r7();expand_set_t_02_r7();expand_03_r7();}
                if (keysize == 0x1){expand_01_192_r7();expand_02_192_r7();expand_set_t_02_r7();expand_03_192_r7();}
                if (keysize == 0x2){merge_rcon_to_w0_r3();expand_01_256_r7();expand_02_256_r7();expand_set_t_02_r7();expand_03_256_r7();}

                // Key encrypt R9
                expand_set_t_01_r8();
                if (keysize == 0x0 || keysize == 0x1){aes_sbox_00_r8.apply(); aes_sbox_01_r8.apply(); aes_sbox_02_r8.apply(); aes_sbox_03_r8.apply();;}
                if (keysize == 0x0){merge_rcon_to_w0_r8();expand_01_r8();expand_02_r8();expand_set_t_02_r8();expand_03_r8();}
                if (keysize == 0x1){merge_rcon_to_w0_r5();expand_01_192_r8();expand_02_192_r8();expand_set_t_02_r8();expand_03_192_r8();}
                if (keysize == 0x2){aes_sbox_50_r3.apply(); aes_sbox_51_r3.apply(); aes_sbox_52_r3.apply(); aes_sbox_53_r3.apply();;expand_01_256_r8();expand_02_256_r8();expand_set_t_02_r8();expand_03_256_r8();}

                // Key encrypt R10
                expand_set_t_01_r9();
                if (keysize == 0x1){expand_01_192_r9();expand_02_192_r9();expand_set_t_02_r9();}
                aes_sbox_00_r9.apply(); aes_sbox_01_r9.apply(); aes_sbox_02_r9.apply(); aes_sbox_03_r9.apply();;
                if (keysize == 0x0){merge_rcon_to_w0_r9();expand_01_r9();expand_02_r9();expand_set_t_02_r9();expand_03_r9();}
                if (keysize == 0x1){merge_rcon_to_w0_r6();expand_03_192_r9();}
                if (keysize == 0x2){merge_rcon_to_w0_r4();expand_01_256_r9();expand_02_256_r9();expand_set_t_02_r9();expand_03_256_r9();}

                if (keysize == 0x1 || keysize == 0x2){
                    // Key encrypt R11
                    expand_set_t_01_r10();
                    if (keysize == 0x1){expand_01_192_r10();expand_02_192_r10();expand_set_t_02_r10();expand_03_192_r10();}
                    if (keysize == 0x2){aes_sbox_50_r4.apply(); aes_sbox_51_r4.apply(); aes_sbox_52_r4.apply(); aes_sbox_53_r4.apply();;expand_01_256_r10();expand_02_256_r10();expand_set_t_02_r10();expand_03_256_r10();}

                    // Key encrypt R12
                    expand_set_t_01_r11();aes_sbox_00_r10.apply(); aes_sbox_01_r10.apply(); aes_sbox_02_r10.apply(); aes_sbox_03_r10.apply();;
                    if (keysize == 0x1){merge_rcon_to_w0_r7();expand_01_192_r11();expand_02_192_r11();expand_set_t_02_r11();expand_03_192_r11();}
                    if (keysize == 0x2){merge_rcon_to_w0_r5();expand_01_256_r11();expand_02_256_r11();expand_set_t_02_r11();expand_03_256_r11();}
                }
                if (keysize == 0x2){
                    // Key encrypt R13
                    expand_set_t_01_r12();
                    aes_sbox_50_r5.apply(); aes_sbox_51_r5.apply(); aes_sbox_52_r5.apply(); aes_sbox_53_r5.apply();;expand_01_256_r12();expand_02_256_r12();expand_set_t_02_r12();expand_03_256_r12();

                    // Key encrypt R14
                    expand_set_t_01_r13();aes_sbox_00_r11.apply(); aes_sbox_01_r11.apply(); aes_sbox_02_r11.apply(); aes_sbox_03_r11.apply();;
                    merge_rcon_to_w0_r6();expand_01_256_r13();expand_02_256_r13();expand_set_t_02_r13();expand_03_256_r13();
                }

                // Expand Inv Key
                // Key decrypt R1
                get_exp_key_r1();
                get_exp_word_00_r0();aes_sbox_10_r0.apply(); aes_sbox_11_r0.apply(); aes_sbox_12_r0.apply(); aes_sbox_13_r0.apply();;aes_sbox_lut_exp_00_r0.apply(); aes_sbox_lut_exp_01_r0.apply(); aes_sbox_lut_exp_02_r0.apply(); aes_sbox_lut_exp_03_r0.apply();;expand_inv_00_r0();
                get_exp_word_01_r0();aes_sbox_20_r0.apply(); aes_sbox_21_r0.apply(); aes_sbox_22_r0.apply(); aes_sbox_23_r0.apply();;aes_sbox_lut_exp_10_r0.apply(); aes_sbox_lut_exp_11_r0.apply(); aes_sbox_lut_exp_12_r0.apply(); aes_sbox_lut_exp_13_r0.apply();;expand_inv_01_r0();
                get_exp_word_02_r0();aes_sbox_30_r0.apply(); aes_sbox_31_r0.apply(); aes_sbox_32_r0.apply(); aes_sbox_33_r0.apply();;aes_sbox_lut_exp_20_r0.apply(); aes_sbox_lut_exp_21_r0.apply(); aes_sbox_lut_exp_22_r0.apply(); aes_sbox_lut_exp_23_r0.apply();;expand_inv_02_r0();
                get_exp_word_03_r0();aes_sbox_40_r0.apply(); aes_sbox_41_r0.apply(); aes_sbox_42_r0.apply(); aes_sbox_43_r0.apply();;aes_sbox_lut_exp_30_r0.apply(); aes_sbox_lut_exp_31_r0.apply(); aes_sbox_lut_exp_32_r0.apply(); aes_sbox_lut_exp_33_r0.apply();;expand_inv_03_r0();
                // Key decrypt R2
                get_exp_key_r2();
                get_exp_word_00_r1();aes_sbox_10_r1.apply(); aes_sbox_11_r1.apply(); aes_sbox_12_r1.apply(); aes_sbox_13_r1.apply();;aes_sbox_lut_exp_00_r1.apply(); aes_sbox_lut_exp_01_r1.apply(); aes_sbox_lut_exp_02_r1.apply(); aes_sbox_lut_exp_03_r1.apply();;expand_inv_00_r1();
                get_exp_word_01_r1();aes_sbox_20_r1.apply(); aes_sbox_21_r1.apply(); aes_sbox_22_r1.apply(); aes_sbox_23_r1.apply();;aes_sbox_lut_exp_10_r1.apply(); aes_sbox_lut_exp_11_r1.apply(); aes_sbox_lut_exp_12_r1.apply(); aes_sbox_lut_exp_13_r1.apply();;expand_inv_01_r1();
                get_exp_word_02_r1();aes_sbox_30_r1.apply(); aes_sbox_31_r1.apply(); aes_sbox_32_r1.apply(); aes_sbox_33_r1.apply();;aes_sbox_lut_exp_20_r1.apply(); aes_sbox_lut_exp_21_r1.apply(); aes_sbox_lut_exp_22_r1.apply(); aes_sbox_lut_exp_23_r1.apply();;expand_inv_02_r1();
                get_exp_word_03_r1();aes_sbox_40_r1.apply(); aes_sbox_41_r1.apply(); aes_sbox_42_r1.apply(); aes_sbox_43_r1.apply();;aes_sbox_lut_exp_30_r1.apply(); aes_sbox_lut_exp_31_r1.apply(); aes_sbox_lut_exp_32_r1.apply(); aes_sbox_lut_exp_33_r1.apply();;expand_inv_03_r1();
                // Key decrypt R3
                get_exp_key_r3();
                get_exp_word_00_r2();aes_sbox_10_r2.apply(); aes_sbox_11_r2.apply(); aes_sbox_12_r2.apply(); aes_sbox_13_r2.apply();;aes_sbox_lut_exp_00_r2.apply(); aes_sbox_lut_exp_01_r2.apply(); aes_sbox_lut_exp_02_r2.apply(); aes_sbox_lut_exp_03_r2.apply();;expand_inv_00_r2();
                get_exp_word_01_r2();aes_sbox_20_r2.apply(); aes_sbox_21_r2.apply(); aes_sbox_22_r2.apply(); aes_sbox_23_r2.apply();;aes_sbox_lut_exp_10_r2.apply(); aes_sbox_lut_exp_11_r2.apply(); aes_sbox_lut_exp_12_r2.apply(); aes_sbox_lut_exp_13_r2.apply();;expand_inv_01_r2();
                get_exp_word_02_r2();aes_sbox_30_r2.apply(); aes_sbox_31_r2.apply(); aes_sbox_32_r2.apply(); aes_sbox_33_r2.apply();;aes_sbox_lut_exp_20_r2.apply(); aes_sbox_lut_exp_21_r2.apply(); aes_sbox_lut_exp_22_r2.apply(); aes_sbox_lut_exp_23_r2.apply();;expand_inv_02_r2();
                get_exp_word_03_r2();aes_sbox_40_r2.apply(); aes_sbox_41_r2.apply(); aes_sbox_42_r2.apply(); aes_sbox_43_r2.apply();;aes_sbox_lut_exp_30_r2.apply(); aes_sbox_lut_exp_31_r2.apply(); aes_sbox_lut_exp_32_r2.apply(); aes_sbox_lut_exp_33_r2.apply();;expand_inv_03_r2();
                // Key decrypt R4
                get_exp_key_r4();
                get_exp_word_00_r3();aes_sbox_10_r3.apply(); aes_sbox_11_r3.apply(); aes_sbox_12_r3.apply(); aes_sbox_13_r3.apply();;aes_sbox_lut_exp_00_r3.apply(); aes_sbox_lut_exp_01_r3.apply(); aes_sbox_lut_exp_02_r3.apply(); aes_sbox_lut_exp_03_r3.apply();;expand_inv_00_r3();
                get_exp_word_01_r3();aes_sbox_20_r3.apply(); aes_sbox_21_r3.apply(); aes_sbox_22_r3.apply(); aes_sbox_23_r3.apply();;aes_sbox_lut_exp_10_r3.apply(); aes_sbox_lut_exp_11_r3.apply(); aes_sbox_lut_exp_12_r3.apply(); aes_sbox_lut_exp_13_r3.apply();;expand_inv_01_r3();
                get_exp_word_02_r3();aes_sbox_30_r3.apply(); aes_sbox_31_r3.apply(); aes_sbox_32_r3.apply(); aes_sbox_33_r3.apply();;aes_sbox_lut_exp_20_r3.apply(); aes_sbox_lut_exp_21_r3.apply(); aes_sbox_lut_exp_22_r3.apply(); aes_sbox_lut_exp_23_r3.apply();;expand_inv_02_r3();
                get_exp_word_03_r3();aes_sbox_40_r3.apply(); aes_sbox_41_r3.apply(); aes_sbox_42_r3.apply(); aes_sbox_43_r3.apply();;aes_sbox_lut_exp_30_r3.apply(); aes_sbox_lut_exp_31_r3.apply(); aes_sbox_lut_exp_32_r3.apply(); aes_sbox_lut_exp_33_r3.apply();;expand_inv_03_r3();
                // Key decrypt R5
                get_exp_key_r5();
                get_exp_word_00_r4();aes_sbox_10_r4.apply(); aes_sbox_11_r4.apply(); aes_sbox_12_r4.apply(); aes_sbox_13_r4.apply();;aes_sbox_lut_exp_00_r4.apply(); aes_sbox_lut_exp_01_r4.apply(); aes_sbox_lut_exp_02_r4.apply(); aes_sbox_lut_exp_03_r4.apply();;expand_inv_00_r4();
                get_exp_word_01_r4();aes_sbox_20_r4.apply(); aes_sbox_21_r4.apply(); aes_sbox_22_r4.apply(); aes_sbox_23_r4.apply();;aes_sbox_lut_exp_10_r4.apply(); aes_sbox_lut_exp_11_r4.apply(); aes_sbox_lut_exp_12_r4.apply(); aes_sbox_lut_exp_13_r4.apply();;expand_inv_01_r4();
                get_exp_word_02_r4();aes_sbox_30_r4.apply(); aes_sbox_31_r4.apply(); aes_sbox_32_r4.apply(); aes_sbox_33_r4.apply();;aes_sbox_lut_exp_20_r4.apply(); aes_sbox_lut_exp_21_r4.apply(); aes_sbox_lut_exp_22_r4.apply(); aes_sbox_lut_exp_23_r4.apply();;expand_inv_02_r4();
                get_exp_word_03_r4();aes_sbox_40_r4.apply(); aes_sbox_41_r4.apply(); aes_sbox_42_r4.apply(); aes_sbox_43_r4.apply();;aes_sbox_lut_exp_30_r4.apply(); aes_sbox_lut_exp_31_r4.apply(); aes_sbox_lut_exp_32_r4.apply(); aes_sbox_lut_exp_33_r4.apply();;expand_inv_03_r4();
                // Key decrypt R6
                get_exp_key_r6();
                get_exp_word_00_r5();aes_sbox_10_r5.apply(); aes_sbox_11_r5.apply(); aes_sbox_12_r5.apply(); aes_sbox_13_r5.apply();;aes_sbox_lut_exp_00_r5.apply(); aes_sbox_lut_exp_01_r5.apply(); aes_sbox_lut_exp_02_r5.apply(); aes_sbox_lut_exp_03_r5.apply();;expand_inv_00_r5();
                get_exp_word_01_r5();aes_sbox_20_r5.apply(); aes_sbox_21_r5.apply(); aes_sbox_22_r5.apply(); aes_sbox_23_r5.apply();;aes_sbox_lut_exp_10_r5.apply(); aes_sbox_lut_exp_11_r5.apply(); aes_sbox_lut_exp_12_r5.apply(); aes_sbox_lut_exp_13_r5.apply();;expand_inv_01_r5();
                get_exp_word_02_r5();aes_sbox_30_r5.apply(); aes_sbox_31_r5.apply(); aes_sbox_32_r5.apply(); aes_sbox_33_r5.apply();;aes_sbox_lut_exp_20_r5.apply(); aes_sbox_lut_exp_21_r5.apply(); aes_sbox_lut_exp_22_r5.apply(); aes_sbox_lut_exp_23_r5.apply();;expand_inv_02_r5();
                get_exp_word_03_r5();aes_sbox_40_r5.apply(); aes_sbox_41_r5.apply(); aes_sbox_42_r5.apply(); aes_sbox_43_r5.apply();;aes_sbox_lut_exp_30_r5.apply(); aes_sbox_lut_exp_31_r5.apply(); aes_sbox_lut_exp_32_r5.apply(); aes_sbox_lut_exp_33_r5.apply();;expand_inv_03_r5();
                // Key decrypt R7
                get_exp_key_r7();
                get_exp_word_00_r6();aes_sbox_10_r6.apply(); aes_sbox_11_r6.apply(); aes_sbox_12_r6.apply(); aes_sbox_13_r6.apply();;aes_sbox_lut_exp_00_r6.apply(); aes_sbox_lut_exp_01_r6.apply(); aes_sbox_lut_exp_02_r6.apply(); aes_sbox_lut_exp_03_r6.apply();;expand_inv_00_r6();
                get_exp_word_01_r6();aes_sbox_20_r6.apply(); aes_sbox_21_r6.apply(); aes_sbox_22_r6.apply(); aes_sbox_23_r6.apply();;aes_sbox_lut_exp_10_r6.apply(); aes_sbox_lut_exp_11_r6.apply(); aes_sbox_lut_exp_12_r6.apply(); aes_sbox_lut_exp_13_r6.apply();;expand_inv_01_r6();
                get_exp_word_02_r6();aes_sbox_30_r6.apply(); aes_sbox_31_r6.apply(); aes_sbox_32_r6.apply(); aes_sbox_33_r6.apply();;aes_sbox_lut_exp_20_r6.apply(); aes_sbox_lut_exp_21_r6.apply(); aes_sbox_lut_exp_22_r6.apply(); aes_sbox_lut_exp_23_r6.apply();;expand_inv_02_r6();
                get_exp_word_03_r6();aes_sbox_40_r6.apply(); aes_sbox_41_r6.apply(); aes_sbox_42_r6.apply(); aes_sbox_43_r6.apply();;aes_sbox_lut_exp_30_r6.apply(); aes_sbox_lut_exp_31_r6.apply(); aes_sbox_lut_exp_32_r6.apply(); aes_sbox_lut_exp_33_r6.apply();;expand_inv_03_r6();
                // Key decrypt R8
                get_exp_key_r8();
                get_exp_word_00_r7();aes_sbox_10_r7.apply(); aes_sbox_11_r7.apply(); aes_sbox_12_r7.apply(); aes_sbox_13_r7.apply();;aes_sbox_lut_exp_00_r7.apply(); aes_sbox_lut_exp_01_r7.apply(); aes_sbox_lut_exp_02_r7.apply(); aes_sbox_lut_exp_03_r7.apply();;expand_inv_00_r7();
                get_exp_word_01_r7();aes_sbox_20_r7.apply(); aes_sbox_21_r7.apply(); aes_sbox_22_r7.apply(); aes_sbox_23_r7.apply();;aes_sbox_lut_exp_10_r7.apply(); aes_sbox_lut_exp_11_r7.apply(); aes_sbox_lut_exp_12_r7.apply(); aes_sbox_lut_exp_13_r7.apply();;expand_inv_01_r7();
                get_exp_word_02_r7();aes_sbox_30_r7.apply(); aes_sbox_31_r7.apply(); aes_sbox_32_r7.apply(); aes_sbox_33_r7.apply();;aes_sbox_lut_exp_20_r7.apply(); aes_sbox_lut_exp_21_r7.apply(); aes_sbox_lut_exp_22_r7.apply(); aes_sbox_lut_exp_23_r7.apply();;expand_inv_02_r7();
                get_exp_word_03_r7();aes_sbox_40_r7.apply(); aes_sbox_41_r7.apply(); aes_sbox_42_r7.apply(); aes_sbox_43_r7.apply();;aes_sbox_lut_exp_30_r7.apply(); aes_sbox_lut_exp_31_r7.apply(); aes_sbox_lut_exp_32_r7.apply(); aes_sbox_lut_exp_33_r7.apply();;expand_inv_03_r7();
                // Key decrypt R9
                get_exp_key_r9();
                get_exp_word_00_r8();aes_sbox_10_r8.apply(); aes_sbox_11_r8.apply(); aes_sbox_12_r8.apply(); aes_sbox_13_r8.apply();;aes_sbox_lut_exp_00_r8.apply(); aes_sbox_lut_exp_01_r8.apply(); aes_sbox_lut_exp_02_r8.apply(); aes_sbox_lut_exp_03_r8.apply();;expand_inv_00_r8();
                get_exp_word_01_r8();aes_sbox_20_r8.apply(); aes_sbox_21_r8.apply(); aes_sbox_22_r8.apply(); aes_sbox_23_r8.apply();;aes_sbox_lut_exp_10_r8.apply(); aes_sbox_lut_exp_11_r8.apply(); aes_sbox_lut_exp_12_r8.apply(); aes_sbox_lut_exp_13_r8.apply();;expand_inv_01_r8();
                get_exp_word_02_r8();aes_sbox_30_r8.apply(); aes_sbox_31_r8.apply(); aes_sbox_32_r8.apply(); aes_sbox_33_r8.apply();;aes_sbox_lut_exp_20_r8.apply(); aes_sbox_lut_exp_21_r8.apply(); aes_sbox_lut_exp_22_r8.apply(); aes_sbox_lut_exp_23_r8.apply();;expand_inv_02_r8();
                get_exp_word_03_r8();aes_sbox_40_r8.apply(); aes_sbox_41_r8.apply(); aes_sbox_42_r8.apply(); aes_sbox_43_r8.apply();;aes_sbox_lut_exp_30_r8.apply(); aes_sbox_lut_exp_31_r8.apply(); aes_sbox_lut_exp_32_r8.apply(); aes_sbox_lut_exp_33_r8.apply();;expand_inv_03_r8();
                // Key decrypt R10
                if (keysize == 0x0){meta.aes.inv_expandkey_r10 = meta.aes.expandkey_r10;}
                if (keysize == 0x1 || keysize == 0x2){
                    get_exp_key_r10();
                    get_exp_word_00_r9();aes_sbox_10_r9.apply(); aes_sbox_11_r9.apply(); aes_sbox_12_r9.apply(); aes_sbox_13_r9.apply();;aes_sbox_lut_exp_00_r9.apply(); aes_sbox_lut_exp_01_r9.apply(); aes_sbox_lut_exp_02_r9.apply(); aes_sbox_lut_exp_03_r9.apply();;expand_inv_00_r9();
                    get_exp_word_01_r9();aes_sbox_20_r9.apply(); aes_sbox_21_r9.apply(); aes_sbox_22_r9.apply(); aes_sbox_23_r9.apply();;aes_sbox_lut_exp_10_r9.apply(); aes_sbox_lut_exp_11_r9.apply(); aes_sbox_lut_exp_12_r9.apply(); aes_sbox_lut_exp_13_r9.apply();;expand_inv_01_r9();
                    get_exp_word_02_r9();aes_sbox_30_r9.apply(); aes_sbox_31_r9.apply(); aes_sbox_32_r9.apply(); aes_sbox_33_r9.apply();;aes_sbox_lut_exp_20_r9.apply(); aes_sbox_lut_exp_21_r9.apply(); aes_sbox_lut_exp_22_r9.apply(); aes_sbox_lut_exp_23_r9.apply();;expand_inv_02_r9();
                    get_exp_word_03_r9();aes_sbox_40_r9.apply(); aes_sbox_41_r9.apply(); aes_sbox_42_r9.apply(); aes_sbox_43_r9.apply();;aes_sbox_lut_exp_30_r9.apply(); aes_sbox_lut_exp_31_r9.apply(); aes_sbox_lut_exp_32_r9.apply(); aes_sbox_lut_exp_33_r9.apply();;expand_inv_03_r9();
                    // Key decrypt R11
                    get_exp_key_r11();
                    get_exp_word_00_r10();aes_sbox_10_r10.apply(); aes_sbox_11_r10.apply(); aes_sbox_12_r10.apply(); aes_sbox_13_r10.apply();;aes_sbox_lut_exp_00_r10.apply(); aes_sbox_lut_exp_01_r10.apply(); aes_sbox_lut_exp_02_r10.apply(); aes_sbox_lut_exp_03_r10.apply();;expand_inv_00_r10();
                    get_exp_word_01_r10();aes_sbox_20_r10.apply(); aes_sbox_21_r10.apply(); aes_sbox_22_r10.apply(); aes_sbox_23_r10.apply();;aes_sbox_lut_exp_10_r10.apply(); aes_sbox_lut_exp_11_r10.apply(); aes_sbox_lut_exp_12_r10.apply(); aes_sbox_lut_exp_13_r10.apply();;expand_inv_01_r10();
                    get_exp_word_02_r10();aes_sbox_30_r10.apply(); aes_sbox_31_r10.apply(); aes_sbox_32_r10.apply(); aes_sbox_33_r10.apply();;aes_sbox_lut_exp_20_r10.apply(); aes_sbox_lut_exp_21_r10.apply(); aes_sbox_lut_exp_22_r10.apply(); aes_sbox_lut_exp_23_r10.apply();;expand_inv_02_r10();
                    get_exp_word_03_r10();aes_sbox_40_r10.apply(); aes_sbox_41_r10.apply(); aes_sbox_42_r10.apply(); aes_sbox_43_r10.apply();;aes_sbox_lut_exp_30_r10.apply(); aes_sbox_lut_exp_31_r10.apply(); aes_sbox_lut_exp_32_r10.apply(); aes_sbox_lut_exp_33_r10.apply();;expand_inv_03_r10();
                }
                // Key decrypt R12
                if (keysize == 0x1){meta.aes.inv_expandkey_r12 = meta.aes.expandkey_r12;}
                if (keysize == 0x2){
                    get_exp_key_r12();
                    get_exp_word_00_r11();aes_sbox_10_r11.apply(); aes_sbox_11_r11.apply(); aes_sbox_12_r11.apply(); aes_sbox_13_r11.apply();;aes_sbox_lut_exp_00_r11.apply(); aes_sbox_lut_exp_01_r11.apply(); aes_sbox_lut_exp_02_r11.apply(); aes_sbox_lut_exp_03_r11.apply();;expand_inv_00_r11();
                    get_exp_word_01_r11();aes_sbox_20_r11.apply(); aes_sbox_21_r11.apply(); aes_sbox_22_r11.apply(); aes_sbox_23_r11.apply();;aes_sbox_lut_exp_10_r11.apply(); aes_sbox_lut_exp_11_r11.apply(); aes_sbox_lut_exp_12_r11.apply(); aes_sbox_lut_exp_13_r11.apply();;expand_inv_01_r11();
                    get_exp_word_02_r11();aes_sbox_30_r11.apply(); aes_sbox_31_r11.apply(); aes_sbox_32_r11.apply(); aes_sbox_33_r11.apply();;aes_sbox_lut_exp_20_r11.apply(); aes_sbox_lut_exp_21_r11.apply(); aes_sbox_lut_exp_22_r11.apply(); aes_sbox_lut_exp_23_r11.apply();;expand_inv_02_r11();
                    get_exp_word_03_r11();aes_sbox_40_r11.apply(); aes_sbox_41_r11.apply(); aes_sbox_42_r11.apply(); aes_sbox_43_r11.apply();;aes_sbox_lut_exp_30_r11.apply(); aes_sbox_lut_exp_31_r11.apply(); aes_sbox_lut_exp_32_r11.apply(); aes_sbox_lut_exp_33_r11.apply();;expand_inv_03_r11();
                    // Key decrypt R13
                    get_exp_key_r13();
                    get_exp_word_00_r12();aes_sbox_10_r12.apply(); aes_sbox_11_r12.apply(); aes_sbox_12_r12.apply(); aes_sbox_13_r12.apply();;aes_sbox_lut_exp_00_r12.apply(); aes_sbox_lut_exp_01_r12.apply(); aes_sbox_lut_exp_02_r12.apply(); aes_sbox_lut_exp_03_r12.apply();;expand_inv_00_r12();
                    get_exp_word_01_r12();aes_sbox_20_r12.apply(); aes_sbox_21_r12.apply(); aes_sbox_22_r12.apply(); aes_sbox_23_r12.apply();;aes_sbox_lut_exp_10_r12.apply(); aes_sbox_lut_exp_11_r12.apply(); aes_sbox_lut_exp_12_r12.apply(); aes_sbox_lut_exp_13_r12.apply();;expand_inv_01_r12();
                    get_exp_word_02_r12();aes_sbox_30_r12.apply(); aes_sbox_31_r12.apply(); aes_sbox_32_r12.apply(); aes_sbox_33_r12.apply();;aes_sbox_lut_exp_20_r12.apply(); aes_sbox_lut_exp_21_r12.apply(); aes_sbox_lut_exp_22_r12.apply(); aes_sbox_lut_exp_23_r12.apply();;expand_inv_02_r12();
                    get_exp_word_03_r12();aes_sbox_40_r12.apply(); aes_sbox_41_r12.apply(); aes_sbox_42_r12.apply(); aes_sbox_43_r12.apply();;aes_sbox_lut_exp_30_r12.apply(); aes_sbox_lut_exp_31_r12.apply(); aes_sbox_lut_exp_32_r12.apply(); aes_sbox_lut_exp_33_r12.apply();;expand_inv_03_r12();
                }
                // Key decrypt R14
                if (keysize == 0x2){meta.aes.inv_expandkey_r14 = meta.aes.expandkey_r14;}

                if (flag == 0x3){
                    read_payload();
                    mask_key(secretKey128);
                    new_round(); aes_sbox_lut_00_r1.apply(); aes_sbox_lut_01_r1.apply(); aes_sbox_lut_02_r1.apply(); aes_sbox_lut_03_r1.apply(); aes_sbox_lut_10_r1.apply(); aes_sbox_lut_11_r1.apply(); aes_sbox_lut_12_r1.apply(); aes_sbox_lut_13_r1.apply(); aes_sbox_lut_20_r1.apply(); aes_sbox_lut_21_r1.apply(); aes_sbox_lut_22_r1.apply(); aes_sbox_lut_23_r1.apply(); aes_sbox_lut_30_r1.apply(); aes_sbox_lut_31_r1.apply(); aes_sbox_lut_32_r1.apply(); aes_sbox_lut_33_r1.apply();; mask_key(meta.aes.expandkey_r1);
                    new_round(); aes_sbox_lut_00_r2.apply(); aes_sbox_lut_01_r2.apply(); aes_sbox_lut_02_r2.apply(); aes_sbox_lut_03_r2.apply(); aes_sbox_lut_10_r2.apply(); aes_sbox_lut_11_r2.apply(); aes_sbox_lut_12_r2.apply(); aes_sbox_lut_13_r2.apply(); aes_sbox_lut_20_r2.apply(); aes_sbox_lut_21_r2.apply(); aes_sbox_lut_22_r2.apply(); aes_sbox_lut_23_r2.apply(); aes_sbox_lut_30_r2.apply(); aes_sbox_lut_31_r2.apply(); aes_sbox_lut_32_r2.apply(); aes_sbox_lut_33_r2.apply();; mask_key(meta.aes.expandkey_r2);
                    new_round(); aes_sbox_lut_00_r3.apply(); aes_sbox_lut_01_r3.apply(); aes_sbox_lut_02_r3.apply(); aes_sbox_lut_03_r3.apply(); aes_sbox_lut_10_r3.apply(); aes_sbox_lut_11_r3.apply(); aes_sbox_lut_12_r3.apply(); aes_sbox_lut_13_r3.apply(); aes_sbox_lut_20_r3.apply(); aes_sbox_lut_21_r3.apply(); aes_sbox_lut_22_r3.apply(); aes_sbox_lut_23_r3.apply(); aes_sbox_lut_30_r3.apply(); aes_sbox_lut_31_r3.apply(); aes_sbox_lut_32_r3.apply(); aes_sbox_lut_33_r3.apply();; mask_key(meta.aes.expandkey_r3);
                    new_round(); aes_sbox_lut_00_r4.apply(); aes_sbox_lut_01_r4.apply(); aes_sbox_lut_02_r4.apply(); aes_sbox_lut_03_r4.apply(); aes_sbox_lut_10_r4.apply(); aes_sbox_lut_11_r4.apply(); aes_sbox_lut_12_r4.apply(); aes_sbox_lut_13_r4.apply(); aes_sbox_lut_20_r4.apply(); aes_sbox_lut_21_r4.apply(); aes_sbox_lut_22_r4.apply(); aes_sbox_lut_23_r4.apply(); aes_sbox_lut_30_r4.apply(); aes_sbox_lut_31_r4.apply(); aes_sbox_lut_32_r4.apply(); aes_sbox_lut_33_r4.apply();; mask_key(meta.aes.expandkey_r4);
                    new_round(); aes_sbox_lut_00_r5.apply(); aes_sbox_lut_01_r5.apply(); aes_sbox_lut_02_r5.apply(); aes_sbox_lut_03_r5.apply(); aes_sbox_lut_10_r5.apply(); aes_sbox_lut_11_r5.apply(); aes_sbox_lut_12_r5.apply(); aes_sbox_lut_13_r5.apply(); aes_sbox_lut_20_r5.apply(); aes_sbox_lut_21_r5.apply(); aes_sbox_lut_22_r5.apply(); aes_sbox_lut_23_r5.apply(); aes_sbox_lut_30_r5.apply(); aes_sbox_lut_31_r5.apply(); aes_sbox_lut_32_r5.apply(); aes_sbox_lut_33_r5.apply();; mask_key(meta.aes.expandkey_r5);
                    new_round(); aes_sbox_lut_00_r6.apply(); aes_sbox_lut_01_r6.apply(); aes_sbox_lut_02_r6.apply(); aes_sbox_lut_03_r6.apply(); aes_sbox_lut_10_r6.apply(); aes_sbox_lut_11_r6.apply(); aes_sbox_lut_12_r6.apply(); aes_sbox_lut_13_r6.apply(); aes_sbox_lut_20_r6.apply(); aes_sbox_lut_21_r6.apply(); aes_sbox_lut_22_r6.apply(); aes_sbox_lut_23_r6.apply(); aes_sbox_lut_30_r6.apply(); aes_sbox_lut_31_r6.apply(); aes_sbox_lut_32_r6.apply(); aes_sbox_lut_33_r6.apply();; mask_key(meta.aes.expandkey_r6);
                    new_round(); aes_sbox_lut_00_r7.apply(); aes_sbox_lut_01_r7.apply(); aes_sbox_lut_02_r7.apply(); aes_sbox_lut_03_r7.apply(); aes_sbox_lut_10_r7.apply(); aes_sbox_lut_11_r7.apply(); aes_sbox_lut_12_r7.apply(); aes_sbox_lut_13_r7.apply(); aes_sbox_lut_20_r7.apply(); aes_sbox_lut_21_r7.apply(); aes_sbox_lut_22_r7.apply(); aes_sbox_lut_23_r7.apply(); aes_sbox_lut_30_r7.apply(); aes_sbox_lut_31_r7.apply(); aes_sbox_lut_32_r7.apply(); aes_sbox_lut_33_r7.apply();; mask_key(meta.aes.expandkey_r7);
                    new_round(); aes_sbox_lut_00_r8.apply(); aes_sbox_lut_01_r8.apply(); aes_sbox_lut_02_r8.apply(); aes_sbox_lut_03_r8.apply(); aes_sbox_lut_10_r8.apply(); aes_sbox_lut_11_r8.apply(); aes_sbox_lut_12_r8.apply(); aes_sbox_lut_13_r8.apply(); aes_sbox_lut_20_r8.apply(); aes_sbox_lut_21_r8.apply(); aes_sbox_lut_22_r8.apply(); aes_sbox_lut_23_r8.apply(); aes_sbox_lut_30_r8.apply(); aes_sbox_lut_31_r8.apply(); aes_sbox_lut_32_r8.apply(); aes_sbox_lut_33_r8.apply();; mask_key(meta.aes.expandkey_r8);
                    new_round(); aes_sbox_lut_00_r9.apply(); aes_sbox_lut_01_r9.apply(); aes_sbox_lut_02_r9.apply(); aes_sbox_lut_03_r9.apply(); aes_sbox_lut_10_r9.apply(); aes_sbox_lut_11_r9.apply(); aes_sbox_lut_12_r9.apply(); aes_sbox_lut_13_r9.apply(); aes_sbox_lut_20_r9.apply(); aes_sbox_lut_21_r9.apply(); aes_sbox_lut_22_r9.apply(); aes_sbox_lut_23_r9.apply(); aes_sbox_lut_30_r9.apply(); aes_sbox_lut_31_r9.apply(); aes_sbox_lut_32_r9.apply(); aes_sbox_lut_33_r9.apply();; mask_key(meta.aes.expandkey_r9);

                    if (keysize == 0x1 || keysize == 0x2){
                        new_round(); aes_sbox_lut_00_r10.apply(); aes_sbox_lut_01_r10.apply(); aes_sbox_lut_02_r10.apply(); aes_sbox_lut_03_r10.apply(); aes_sbox_lut_10_r10.apply(); aes_sbox_lut_11_r10.apply(); aes_sbox_lut_12_r10.apply(); aes_sbox_lut_13_r10.apply(); aes_sbox_lut_20_r10.apply(); aes_sbox_lut_21_r10.apply(); aes_sbox_lut_22_r10.apply(); aes_sbox_lut_23_r10.apply(); aes_sbox_lut_30_r10.apply(); aes_sbox_lut_31_r10.apply(); aes_sbox_lut_32_r10.apply(); aes_sbox_lut_33_r10.apply();; mask_key(meta.aes.expandkey_r10);
                        new_round(); aes_sbox_lut_00_r11.apply(); aes_sbox_lut_01_r11.apply(); aes_sbox_lut_02_r11.apply(); aes_sbox_lut_03_r11.apply(); aes_sbox_lut_10_r11.apply(); aes_sbox_lut_11_r11.apply(); aes_sbox_lut_12_r11.apply(); aes_sbox_lut_13_r11.apply(); aes_sbox_lut_20_r11.apply(); aes_sbox_lut_21_r11.apply(); aes_sbox_lut_22_r11.apply(); aes_sbox_lut_23_r11.apply(); aes_sbox_lut_30_r11.apply(); aes_sbox_lut_31_r11.apply(); aes_sbox_lut_32_r11.apply(); aes_sbox_lut_33_r11.apply();; mask_key(meta.aes.expandkey_r11);
                    }
                    if (keysize == 0x2){
                        new_round(); aes_sbox_lut_00_r12.apply(); aes_sbox_lut_01_r12.apply(); aes_sbox_lut_02_r12.apply(); aes_sbox_lut_03_r12.apply(); aes_sbox_lut_10_r12.apply(); aes_sbox_lut_11_r12.apply(); aes_sbox_lut_12_r12.apply(); aes_sbox_lut_13_r12.apply(); aes_sbox_lut_20_r12.apply(); aes_sbox_lut_21_r12.apply(); aes_sbox_lut_22_r12.apply(); aes_sbox_lut_23_r12.apply(); aes_sbox_lut_30_r12.apply(); aes_sbox_lut_31_r12.apply(); aes_sbox_lut_32_r12.apply(); aes_sbox_lut_33_r12.apply();; mask_key(meta.aes.expandkey_r12);
                        new_round(); aes_sbox_lut_00_r13.apply(); aes_sbox_lut_01_r13.apply(); aes_sbox_lut_02_r13.apply(); aes_sbox_lut_03_r13.apply(); aes_sbox_lut_10_r13.apply(); aes_sbox_lut_11_r13.apply(); aes_sbox_lut_12_r13.apply(); aes_sbox_lut_13_r13.apply(); aes_sbox_lut_20_r13.apply(); aes_sbox_lut_21_r13.apply(); aes_sbox_lut_22_r13.apply(); aes_sbox_lut_23_r13.apply(); aes_sbox_lut_30_r13.apply(); aes_sbox_lut_31_r13.apply(); aes_sbox_lut_32_r13.apply(); aes_sbox_lut_33_r13.apply();; mask_key(meta.aes.expandkey_r13);
                    }

                    new_round(); aes_sbox_lut_00_rLAST.apply(); aes_sbox_lut_01_rLAST.apply(); aes_sbox_lut_02_rLAST.apply(); aes_sbox_lut_03_rLAST.apply(); aes_sbox_lut_10_rLAST.apply(); aes_sbox_lut_11_rLAST.apply(); aes_sbox_lut_12_rLAST.apply(); aes_sbox_lut_13_rLAST.apply(); aes_sbox_lut_20_rLAST.apply(); aes_sbox_lut_21_rLAST.apply(); aes_sbox_lut_22_rLAST.apply(); aes_sbox_lut_23_rLAST.apply(); aes_sbox_lut_30_rLAST.apply(); aes_sbox_lut_31_rLAST.apply(); aes_sbox_lut_32_rLAST.apply(); aes_sbox_lut_33_rLAST.apply();;

                    if (keysize == 0x0){mask_key(meta.aes.expandkey_r10);}
                    if (keysize == 0x1){mask_key(meta.aes.expandkey_r12);}
                    if (keysize == 0x2){mask_key(meta.aes.expandkey_r14);}

                    write_payload();
                    aes_l2_fwd();
                }
                else if (flag == 0x0){
                    read_payload();
                    if (keysize == 0x2){
                        mask_key(meta.aes.expandkey_r14);
                        new_round(); aes_invsbox_lut_00_r13.apply(); aes_invsbox_lut_01_r13.apply(); aes_invsbox_lut_02_r13.apply(); aes_invsbox_lut_03_r13.apply(); aes_invsbox_lut_10_r13.apply(); aes_invsbox_lut_11_r13.apply(); aes_invsbox_lut_12_r13.apply(); aes_invsbox_lut_13_r13.apply(); aes_invsbox_lut_20_r13.apply(); aes_invsbox_lut_21_r13.apply(); aes_invsbox_lut_22_r13.apply(); aes_invsbox_lut_23_r13.apply(); aes_invsbox_lut_30_r13.apply(); aes_invsbox_lut_31_r13.apply(); aes_invsbox_lut_32_r13.apply(); aes_invsbox_lut_33_r13.apply();; mask_key(meta.aes.inv_expandkey_r13);
                        new_round(); aes_invsbox_lut_00_r12.apply(); aes_invsbox_lut_01_r12.apply(); aes_invsbox_lut_02_r12.apply(); aes_invsbox_lut_03_r12.apply(); aes_invsbox_lut_10_r12.apply(); aes_invsbox_lut_11_r12.apply(); aes_invsbox_lut_12_r12.apply(); aes_invsbox_lut_13_r12.apply(); aes_invsbox_lut_20_r12.apply(); aes_invsbox_lut_21_r12.apply(); aes_invsbox_lut_22_r12.apply(); aes_invsbox_lut_23_r12.apply(); aes_invsbox_lut_30_r12.apply(); aes_invsbox_lut_31_r12.apply(); aes_invsbox_lut_32_r12.apply(); aes_invsbox_lut_33_r12.apply();; mask_key(meta.aes.inv_expandkey_r12);
                    }
                    if (keysize == 0x1 || keysize == 0x2){
                        if (keysize == 0x1){
                            mask_key(meta.aes.expandkey_r12);
                        }
                        new_round(); aes_invsbox_lut_00_r11.apply(); aes_invsbox_lut_01_r11.apply(); aes_invsbox_lut_02_r11.apply(); aes_invsbox_lut_03_r11.apply(); aes_invsbox_lut_10_r11.apply(); aes_invsbox_lut_11_r11.apply(); aes_invsbox_lut_12_r11.apply(); aes_invsbox_lut_13_r11.apply(); aes_invsbox_lut_20_r11.apply(); aes_invsbox_lut_21_r11.apply(); aes_invsbox_lut_22_r11.apply(); aes_invsbox_lut_23_r11.apply(); aes_invsbox_lut_30_r11.apply(); aes_invsbox_lut_31_r11.apply(); aes_invsbox_lut_32_r11.apply(); aes_invsbox_lut_33_r11.apply();; mask_key(meta.aes.inv_expandkey_r11);
                        new_round(); aes_invsbox_lut_00_r10.apply(); aes_invsbox_lut_01_r10.apply(); aes_invsbox_lut_02_r10.apply(); aes_invsbox_lut_03_r10.apply(); aes_invsbox_lut_10_r10.apply(); aes_invsbox_lut_11_r10.apply(); aes_invsbox_lut_12_r10.apply(); aes_invsbox_lut_13_r10.apply(); aes_invsbox_lut_20_r10.apply(); aes_invsbox_lut_21_r10.apply(); aes_invsbox_lut_22_r10.apply(); aes_invsbox_lut_23_r10.apply(); aes_invsbox_lut_30_r10.apply(); aes_invsbox_lut_31_r10.apply(); aes_invsbox_lut_32_r10.apply(); aes_invsbox_lut_33_r10.apply();; mask_key(meta.aes.inv_expandkey_r10);
                    }
                    if (keysize == 0x0){
                        mask_key(meta.aes.expandkey_r10);
                    }
                    new_round(); aes_invsbox_lut_00_r9.apply(); aes_invsbox_lut_01_r9.apply(); aes_invsbox_lut_02_r9.apply(); aes_invsbox_lut_03_r9.apply(); aes_invsbox_lut_10_r9.apply(); aes_invsbox_lut_11_r9.apply(); aes_invsbox_lut_12_r9.apply(); aes_invsbox_lut_13_r9.apply(); aes_invsbox_lut_20_r9.apply(); aes_invsbox_lut_21_r9.apply(); aes_invsbox_lut_22_r9.apply(); aes_invsbox_lut_23_r9.apply(); aes_invsbox_lut_30_r9.apply(); aes_invsbox_lut_31_r9.apply(); aes_invsbox_lut_32_r9.apply(); aes_invsbox_lut_33_r9.apply();; mask_key(meta.aes.inv_expandkey_r9);
                    new_round(); aes_invsbox_lut_00_r8.apply(); aes_invsbox_lut_01_r8.apply(); aes_invsbox_lut_02_r8.apply(); aes_invsbox_lut_03_r8.apply(); aes_invsbox_lut_10_r8.apply(); aes_invsbox_lut_11_r8.apply(); aes_invsbox_lut_12_r8.apply(); aes_invsbox_lut_13_r8.apply(); aes_invsbox_lut_20_r8.apply(); aes_invsbox_lut_21_r8.apply(); aes_invsbox_lut_22_r8.apply(); aes_invsbox_lut_23_r8.apply(); aes_invsbox_lut_30_r8.apply(); aes_invsbox_lut_31_r8.apply(); aes_invsbox_lut_32_r8.apply(); aes_invsbox_lut_33_r8.apply();; mask_key(meta.aes.inv_expandkey_r8);
                    new_round(); aes_invsbox_lut_00_r7.apply(); aes_invsbox_lut_01_r7.apply(); aes_invsbox_lut_02_r7.apply(); aes_invsbox_lut_03_r7.apply(); aes_invsbox_lut_10_r7.apply(); aes_invsbox_lut_11_r7.apply(); aes_invsbox_lut_12_r7.apply(); aes_invsbox_lut_13_r7.apply(); aes_invsbox_lut_20_r7.apply(); aes_invsbox_lut_21_r7.apply(); aes_invsbox_lut_22_r7.apply(); aes_invsbox_lut_23_r7.apply(); aes_invsbox_lut_30_r7.apply(); aes_invsbox_lut_31_r7.apply(); aes_invsbox_lut_32_r7.apply(); aes_invsbox_lut_33_r7.apply();; mask_key(meta.aes.inv_expandkey_r7);
                    new_round(); aes_invsbox_lut_00_r6.apply(); aes_invsbox_lut_01_r6.apply(); aes_invsbox_lut_02_r6.apply(); aes_invsbox_lut_03_r6.apply(); aes_invsbox_lut_10_r6.apply(); aes_invsbox_lut_11_r6.apply(); aes_invsbox_lut_12_r6.apply(); aes_invsbox_lut_13_r6.apply(); aes_invsbox_lut_20_r6.apply(); aes_invsbox_lut_21_r6.apply(); aes_invsbox_lut_22_r6.apply(); aes_invsbox_lut_23_r6.apply(); aes_invsbox_lut_30_r6.apply(); aes_invsbox_lut_31_r6.apply(); aes_invsbox_lut_32_r6.apply(); aes_invsbox_lut_33_r6.apply();; mask_key(meta.aes.inv_expandkey_r6);
                    new_round(); aes_invsbox_lut_00_r5.apply(); aes_invsbox_lut_01_r5.apply(); aes_invsbox_lut_02_r5.apply(); aes_invsbox_lut_03_r5.apply(); aes_invsbox_lut_10_r5.apply(); aes_invsbox_lut_11_r5.apply(); aes_invsbox_lut_12_r5.apply(); aes_invsbox_lut_13_r5.apply(); aes_invsbox_lut_20_r5.apply(); aes_invsbox_lut_21_r5.apply(); aes_invsbox_lut_22_r5.apply(); aes_invsbox_lut_23_r5.apply(); aes_invsbox_lut_30_r5.apply(); aes_invsbox_lut_31_r5.apply(); aes_invsbox_lut_32_r5.apply(); aes_invsbox_lut_33_r5.apply();; mask_key(meta.aes.inv_expandkey_r5);
                    new_round(); aes_invsbox_lut_00_r4.apply(); aes_invsbox_lut_01_r4.apply(); aes_invsbox_lut_02_r4.apply(); aes_invsbox_lut_03_r4.apply(); aes_invsbox_lut_10_r4.apply(); aes_invsbox_lut_11_r4.apply(); aes_invsbox_lut_12_r4.apply(); aes_invsbox_lut_13_r4.apply(); aes_invsbox_lut_20_r4.apply(); aes_invsbox_lut_21_r4.apply(); aes_invsbox_lut_22_r4.apply(); aes_invsbox_lut_23_r4.apply(); aes_invsbox_lut_30_r4.apply(); aes_invsbox_lut_31_r4.apply(); aes_invsbox_lut_32_r4.apply(); aes_invsbox_lut_33_r4.apply();; mask_key(meta.aes.inv_expandkey_r4);
                    new_round(); aes_invsbox_lut_00_r3.apply(); aes_invsbox_lut_01_r3.apply(); aes_invsbox_lut_02_r3.apply(); aes_invsbox_lut_03_r3.apply(); aes_invsbox_lut_10_r3.apply(); aes_invsbox_lut_11_r3.apply(); aes_invsbox_lut_12_r3.apply(); aes_invsbox_lut_13_r3.apply(); aes_invsbox_lut_20_r3.apply(); aes_invsbox_lut_21_r3.apply(); aes_invsbox_lut_22_r3.apply(); aes_invsbox_lut_23_r3.apply(); aes_invsbox_lut_30_r3.apply(); aes_invsbox_lut_31_r3.apply(); aes_invsbox_lut_32_r3.apply(); aes_invsbox_lut_33_r3.apply();; mask_key(meta.aes.inv_expandkey_r3);
                    new_round(); aes_invsbox_lut_00_r2.apply(); aes_invsbox_lut_01_r2.apply(); aes_invsbox_lut_02_r2.apply(); aes_invsbox_lut_03_r2.apply(); aes_invsbox_lut_10_r2.apply(); aes_invsbox_lut_11_r2.apply(); aes_invsbox_lut_12_r2.apply(); aes_invsbox_lut_13_r2.apply(); aes_invsbox_lut_20_r2.apply(); aes_invsbox_lut_21_r2.apply(); aes_invsbox_lut_22_r2.apply(); aes_invsbox_lut_23_r2.apply(); aes_invsbox_lut_30_r2.apply(); aes_invsbox_lut_31_r2.apply(); aes_invsbox_lut_32_r2.apply(); aes_invsbox_lut_33_r2.apply();; mask_key(meta.aes.inv_expandkey_r2);
                    new_round(); aes_invsbox_lut_00_r1.apply(); aes_invsbox_lut_01_r1.apply(); aes_invsbox_lut_02_r1.apply(); aes_invsbox_lut_03_r1.apply(); aes_invsbox_lut_10_r1.apply(); aes_invsbox_lut_11_r1.apply(); aes_invsbox_lut_12_r1.apply(); aes_invsbox_lut_13_r1.apply(); aes_invsbox_lut_20_r1.apply(); aes_invsbox_lut_21_r1.apply(); aes_invsbox_lut_22_r1.apply(); aes_invsbox_lut_23_r1.apply(); aes_invsbox_lut_30_r1.apply(); aes_invsbox_lut_31_r1.apply(); aes_invsbox_lut_32_r1.apply(); aes_invsbox_lut_33_r1.apply();; mask_key(meta.aes.inv_expandkey_r1);
                    // one last round, INV S-box only
                    new_round(); aes_invsbox_lut_00_rLAST.apply(); aes_invsbox_lut_01_rLAST.apply(); aes_invsbox_lut_02_rLAST.apply(); aes_invsbox_lut_03_rLAST.apply(); aes_invsbox_lut_10_rLAST.apply(); aes_invsbox_lut_11_rLAST.apply(); aes_invsbox_lut_12_rLAST.apply(); aes_invsbox_lut_13_rLAST.apply(); aes_invsbox_lut_20_rLAST.apply(); aes_invsbox_lut_21_rLAST.apply(); aes_invsbox_lut_22_rLAST.apply(); aes_invsbox_lut_23_rLAST.apply(); aes_invsbox_lut_30_rLAST.apply(); aes_invsbox_lut_31_rLAST.apply(); aes_invsbox_lut_32_rLAST.apply(); aes_invsbox_lut_33_rLAST.apply();; mask_key(secretKey128);
                    // End AES
                    write_payload();
                    aes_l2_fwd();
                }
                else {
                    _drop();
                }
            }
        }
    }
}

control MyEgress(
    inout my_headers_t hdr,
    inout my_metadata_t meta,
    inout standard_metadata_t standard_metadata) {

    apply {

    }
}

control MyComputeChecksum(
    inout my_headers_t hdr,
    inout my_metadata_t meta)
{
    apply { }
}

control MyDeparser(
    packet_out packet,
    in my_headers_t hdr)
{

    apply {
        packet.emit(hdr.ethernet);
        packet.emit(hdr.dh_probe);
        packet.emit(hdr.aes_inout);
    }
}

V1Switch(
    MyParser(),
    MyVerifyChecksum(),
    MyIngress(),
    MyEgress(),
    MyComputeChecksum(),
    MyDeparser()
) main;
